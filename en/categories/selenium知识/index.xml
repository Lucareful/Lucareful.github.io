<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Selenium知识 on Luenci</title>
    <link>https://luenci.com/en/categories/selenium%E7%9F%A5%E8%AF%86/</link>
    <description>Recent content in Selenium知识 on Luenci</description>
    <generator>Hugo -- 0.145.0</generator>
    <language>en</language>
    <atom:link href="https://luenci.com/en/categories/selenium%E7%9F%A5%E8%AF%86/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>12306自动化抢票实现</title>
      <link>https://luenci.com/en/posts/12306%E8%87%AA%E5%8A%A8%E6%8A%A2%E7%A5%A8/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://luenci.com/en/posts/12306%E8%87%AA%E5%8A%A8%E6%8A%A2%E7%A5%A8/</guid>
      <description>&lt;h1 id=&#34;selenium常用api&#34;&gt;selenium常用API&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;find_element_by_xxx&lt;/code&gt;  返回第一个符合条件&lt;code&gt;WebElement&lt;/code&gt;元素&lt;/li&gt;
&lt;li&gt;&lt;code&gt;find_elements_by_xxx&lt;/code&gt;  返回符合条件所有元素包含了 &lt;code&gt;WebEelemnt &lt;/code&gt;列表&lt;/li&gt;
&lt;/ul&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;函数&lt;/th&gt;
          &lt;th&gt;作用&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;find_element_by_class_name&lt;/td&gt;
          &lt;td&gt;通过class查询元素&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;find_element_by_id&lt;/td&gt;
          &lt;td&gt;通过ID查询元素&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;find_element_by_name&lt;/td&gt;
          &lt;td&gt;通过name查询元素&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;find_element_by_tag_name&lt;/td&gt;
          &lt;td&gt;通过标签名称&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;find_element_by_css_selector&lt;/td&gt;
          &lt;td&gt;css样式选择&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;find_element_by_link_text&lt;/td&gt;
          &lt;td&gt;通过链接内容查找&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;find_element_by_partial_link_text&lt;/td&gt;
          &lt;td&gt;通过链接内容包含的内容查找，模糊查询&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;find_element_by_xpath&lt;/td&gt;
          &lt;td&gt;通过xpath查找数据&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;获取元素属性和文本内容&#34;&gt;获取元素属性和文本内容&lt;/h1&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt;2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt;3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt;4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt;5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt;6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt;7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;#获取属性&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;element&lt;span style=&#34;color:#ff7b72;font-weight:bold&#34;&gt;.&lt;/span&gt;get_attribute&lt;span style=&#34;color:#f85149&#34;&gt;（&lt;/span&gt;&lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#39;属性名”）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;#获取文本内容&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;element&lt;span style=&#34;color:#ff7b72;font-weight:bold&#34;&gt;.&lt;/span&gt;text
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;# 输入框输入内容&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;input_element&lt;span style=&#34;color:#ff7b72;font-weight:bold&#34;&gt;.&lt;/span&gt;send_keys&lt;span style=&#34;color:#f85149&#34;&gt;（&lt;/span&gt;&lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#39;Luenci&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f85149&#34;&gt;）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;# 元素点击&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;element&lt;span style=&#34;color:#ff7b72;font-weight:bold&#34;&gt;.&lt;/span&gt;click()
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;三种等待方式&#34;&gt;三种等待方式&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;当控制浏览器时，浏览器正在加载页面同时又去获取数据导致浏览器寻找不到需要操作的元素引发异常。&lt;/li&gt;
&lt;li&gt;方式一：强制等待，浪费时间
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;time.sleep（秒数）&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;方式二：隐性等待，无法控制Ajax请求
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;browser.implicit1y_wait（等待时间）&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;方式三：显性等待，每个元素都可以自己定义检查条件。手动编写方式&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt; 1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt; 2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt; 3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt; 4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt; 5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt; 6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt; 7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt; 8
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt; 9
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt;10
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt;11
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt;12
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt;13
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt;14
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;#显性等待-手动编写&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;t &lt;span style=&#34;color:#ff7b72;font-weight:bold&#34;&gt;=&lt;/span&gt; time&lt;span style=&#34;color:#ff7b72;font-weight:bold&#34;&gt;.&lt;/span&gt;time&lt;span style=&#34;color:#f85149&#34;&gt;（）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;#定义超时时间&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;timeout &lt;span style=&#34;color:#ff7b72;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a5d6ff&#34;&gt;60&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;while&lt;/span&gt; &lt;span style=&#34;color:#79c0ff&#34;&gt;True&lt;/span&gt;&lt;span style=&#34;color:#f85149&#34;&gt;：&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#ff7b72&#34;&gt;try&lt;/span&gt;&lt;span style=&#34;color:#f85149&#34;&gt;：&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;#超时时间间隔&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        time&lt;span style=&#34;color:#ff7b72;font-weight:bold&#34;&gt;.&lt;/span&gt;sleep&lt;span style=&#34;color:#f85149&#34;&gt;（&lt;/span&gt;&lt;span style=&#34;color:#a5d6ff&#34;&gt;0.1&lt;/span&gt;&lt;span style=&#34;color:#f85149&#34;&gt;）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        ur1_element &lt;span style=&#34;color:#ff7b72;font-weight:bold&#34;&gt;=&lt;/span&gt; browser&lt;span style=&#34;color:#ff7b72;font-weight:bold&#34;&gt;.&lt;/span&gt;find_element_by_class_name&lt;span style=&#34;color:#f85149&#34;&gt;（&lt;/span&gt;&lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;fav ur1&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f85149&#34;&gt;）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#ff7b72&#34;&gt;break&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#ff7b72&#34;&gt;except&lt;/span&gt;&lt;span style=&#34;color:#f85149&#34;&gt;：&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;#超时处理&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;if&lt;/span&gt; time&lt;span style=&#34;color:#ff7b72;font-weight:bold&#34;&gt;.&lt;/span&gt;time&lt;span style=&#34;color:#f85149&#34;&gt;（）&lt;/span&gt;&lt;span style=&#34;color:#ff7b72;font-weight:bold&#34;&gt;-&lt;/span&gt; t &lt;span style=&#34;color:#ff7b72;font-weight:bold&#34;&gt;&amp;gt;&lt;/span&gt; timeout&lt;span style=&#34;color:#f85149&#34;&gt;：&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        	&lt;span style=&#34;color:#ff7b72&#34;&gt;break&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#ff7b72&#34;&gt;pass&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;系统提供显性等待api&#34;&gt;系统提供显性等待API&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt; 1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt; 2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt; 3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt; 4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt; 5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt; 6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt; 7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt; 8
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt; 9
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt;10
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt;11
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt;12
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt;13
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt;14
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt;15
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt;16
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt;17
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;# 导入显性等待的API需要的模块&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;# 1等待对象模块&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;from&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;selenium.webdriver.support.wait&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;import&lt;/span&gt; WebDriverwait
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;# 2导入等待条件模块&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;from&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;selenium.webdriver.support&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;import&lt;/span&gt; expected_conditions &lt;span style=&#34;color:#ff7b72&#34;&gt;as&lt;/span&gt; EC
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;# 3导入查询元素模块&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;from&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;selenium.webdriver.common.by&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;import&lt;/span&gt; By
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;# 1.创建等待对象&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;# 参数一浏览器对象&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;# 参数二超时时间&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;# 参数三检查元素时间间隔&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;wait &lt;span style=&#34;color:#ff7b72;font-weight:bold&#34;&gt;=&lt;/span&gt; WebDriverwait&lt;span style=&#34;color:#f85149&#34;&gt;（&lt;/span&gt;browser&lt;span style=&#34;color:#f85149&#34;&gt;，&lt;/span&gt;&lt;span style=&#34;color:#a5d6ff&#34;&gt;5.0&lt;/span&gt;&lt;span style=&#34;color:#f85149&#34;&gt;，&lt;/span&gt;&lt;span style=&#34;color:#a5d6ff&#34;&gt;0.5&lt;/span&gt;&lt;span style=&#34;color:#f85149&#34;&gt;）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;# 2.通过等待对象获取元素&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;# presence_of_element_located 检查元素是否存在，如果存在就返回如果不存在就继续检查&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;# visibility_of_element_located 检查元素是否可见&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;linkelement &lt;span style=&#34;color:#ff7b72;font-weight:bold&#34;&gt;=&lt;/span&gt; s wait&lt;span style=&#34;color:#ff7b72;font-weight:bold&#34;&gt;.&lt;/span&gt;until&lt;span style=&#34;color:#f85149&#34;&gt;（&lt;/span&gt;EC&lt;span style=&#34;color:#ff7b72;font-weight:bold&#34;&gt;.&lt;/span&gt;presence_of_element_located&lt;span style=&#34;color:#f85149&#34;&gt;（（&lt;/span&gt;By&lt;span style=&#34;color:#ff7b72;font-weight:bold&#34;&gt;.&lt;/span&gt;CLASS_NAME&lt;span style=&#34;color:#f85149&#34;&gt;，&lt;/span&gt;&lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;favurl&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f85149&#34;&gt;）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;link_element&lt;span style=&#34;color:#ff7b72;font-weight:bold&#34;&gt;.&lt;/span&gt;click&lt;span style=&#34;color:#f85149&#34;&gt;（）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;12306爬虫实现&#34;&gt;12306爬虫实现&lt;/h1&gt;
&lt;p&gt;完成代码见：https://github.com/Lucareful/12306_Tickets&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;实现步骤
&lt;ul&gt;
&lt;li&gt;1.访问列表页&lt;/li&gt;
&lt;li&gt;2.通过时间判定选择点击预订&lt;/li&gt;
&lt;li&gt;3.点击账号登录&lt;/li&gt;
&lt;li&gt;4.输入用户名和密码（15523750230）&lt;/li&gt;
&lt;li&gt;5.截图获取验证码图片&lt;/li&gt;
&lt;li&gt;6.发送打码平台获取识别数字&lt;/li&gt;
&lt;li&gt;7.定义8个点击坐标&lt;/li&gt;
&lt;li&gt;8.模拟点击坐标&lt;/li&gt;
&lt;li&gt;9.点击登录&lt;/li&gt;
&lt;li&gt;10.点击选择人物&lt;/li&gt;
&lt;li&gt;11.点击提交订单&lt;/li&gt;
&lt;li&gt;12.点击确认订单&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</description>
      <content:encoded><![CDATA[<h1 id="selenium常用api">selenium常用API</h1>
<ul>
<li><code>find_element_by_xxx</code>  返回第一个符合条件<code>WebElement</code>元素</li>
<li><code>find_elements_by_xxx</code>  返回符合条件所有元素包含了 <code>WebEelemnt </code>列表</li>
</ul>
<table>
  <thead>
      <tr>
          <th>函数</th>
          <th>作用</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>find_element_by_class_name</td>
          <td>通过class查询元素</td>
      </tr>
      <tr>
          <td>find_element_by_id</td>
          <td>通过ID查询元素</td>
      </tr>
      <tr>
          <td>find_element_by_name</td>
          <td>通过name查询元素</td>
      </tr>
      <tr>
          <td>find_element_by_tag_name</td>
          <td>通过标签名称</td>
      </tr>
      <tr>
          <td>find_element_by_css_selector</td>
          <td>css样式选择</td>
      </tr>
      <tr>
          <td>find_element_by_link_text</td>
          <td>通过链接内容查找</td>
      </tr>
      <tr>
          <td>find_element_by_partial_link_text</td>
          <td>通过链接内容包含的内容查找，模糊查询</td>
      </tr>
      <tr>
          <td>find_element_by_xpath</td>
          <td>通过xpath查找数据</td>
      </tr>
  </tbody>
</table>
<h1 id="获取元素属性和文本内容">获取元素属性和文本内容</h1>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">#获取属性</span>
</span></span><span style="display:flex;"><span>element<span style="color:#ff7b72;font-weight:bold">.</span>get_attribute<span style="color:#f85149">（</span><span style="color:#a5d6ff">&#39;属性名”）</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">#获取文本内容</span>
</span></span><span style="display:flex;"><span>element<span style="color:#ff7b72;font-weight:bold">.</span>text
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 输入框输入内容</span>
</span></span><span style="display:flex;"><span>input_element<span style="color:#ff7b72;font-weight:bold">.</span>send_keys<span style="color:#f85149">（</span><span style="color:#a5d6ff">&#39;Luenci&#39;</span><span style="color:#f85149">）</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 元素点击</span>
</span></span><span style="display:flex;"><span>element<span style="color:#ff7b72;font-weight:bold">.</span>click()
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="三种等待方式">三种等待方式</h2>
<ul>
<li>当控制浏览器时，浏览器正在加载页面同时又去获取数据导致浏览器寻找不到需要操作的元素引发异常。</li>
<li>方式一：强制等待，浪费时间
<ul>
<li><code>time.sleep（秒数）</code></li>
</ul>
</li>
<li>方式二：隐性等待，无法控制Ajax请求
<ul>
<li><code>browser.implicit1y_wait（等待时间）</code></li>
</ul>
</li>
<li>方式三：显性等待，每个元素都可以自己定义检查条件。手动编写方式</li>
</ul>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">#显性等待-手动编写</span>
</span></span><span style="display:flex;"><span>t <span style="color:#ff7b72;font-weight:bold">=</span> time<span style="color:#ff7b72;font-weight:bold">.</span>time<span style="color:#f85149">（）</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">#定义超时时间</span>
</span></span><span style="display:flex;"><span>timeout <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">60</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">while</span> <span style="color:#79c0ff">True</span><span style="color:#f85149">：</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ff7b72">try</span><span style="color:#f85149">：</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b949e;font-style:italic">#超时时间间隔</span>
</span></span><span style="display:flex;"><span>        time<span style="color:#ff7b72;font-weight:bold">.</span>sleep<span style="color:#f85149">（</span><span style="color:#a5d6ff">0.1</span><span style="color:#f85149">）</span>
</span></span><span style="display:flex;"><span>        ur1_element <span style="color:#ff7b72;font-weight:bold">=</span> browser<span style="color:#ff7b72;font-weight:bold">.</span>find_element_by_class_name<span style="color:#f85149">（</span><span style="color:#a5d6ff">&#34;fav ur1&#34;</span><span style="color:#f85149">）</span>
</span></span><span style="display:flex;"><span>		<span style="color:#ff7b72">break</span> 
</span></span><span style="display:flex;"><span>	<span style="color:#ff7b72">except</span><span style="color:#f85149">：</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b949e;font-style:italic">#超时处理</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">if</span> time<span style="color:#ff7b72;font-weight:bold">.</span>time<span style="color:#f85149">（）</span><span style="color:#ff7b72;font-weight:bold">-</span> t <span style="color:#ff7b72;font-weight:bold">&gt;</span> timeout<span style="color:#f85149">：</span>
</span></span><span style="display:flex;"><span>        	<span style="color:#ff7b72">break</span> 
</span></span><span style="display:flex;"><span>		<span style="color:#ff7b72">pass</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="系统提供显性等待api">系统提供显性等待API</h2>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 导入显性等待的API需要的模块</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 1等待对象模块</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">selenium.webdriver.support.wait</span> <span style="color:#ff7b72">import</span> WebDriverwait
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 2导入等待条件模块</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">selenium.webdriver.support</span> <span style="color:#ff7b72">import</span> expected_conditions <span style="color:#ff7b72">as</span> EC
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 3导入查询元素模块</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">selenium.webdriver.common.by</span> <span style="color:#ff7b72">import</span> By
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 1.创建等待对象</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 参数一浏览器对象</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 参数二超时时间</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 参数三检查元素时间间隔</span>
</span></span><span style="display:flex;"><span>wait <span style="color:#ff7b72;font-weight:bold">=</span> WebDriverwait<span style="color:#f85149">（</span>browser<span style="color:#f85149">，</span><span style="color:#a5d6ff">5.0</span><span style="color:#f85149">，</span><span style="color:#a5d6ff">0.5</span><span style="color:#f85149">）</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 2.通过等待对象获取元素</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># presence_of_element_located 检查元素是否存在，如果存在就返回如果不存在就继续检查</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># visibility_of_element_located 检查元素是否可见</span>
</span></span><span style="display:flex;"><span>linkelement <span style="color:#ff7b72;font-weight:bold">=</span> s wait<span style="color:#ff7b72;font-weight:bold">.</span>until<span style="color:#f85149">（</span>EC<span style="color:#ff7b72;font-weight:bold">.</span>presence_of_element_located<span style="color:#f85149">（（</span>By<span style="color:#ff7b72;font-weight:bold">.</span>CLASS_NAME<span style="color:#f85149">，</span><span style="color:#a5d6ff">&#34;favurl&#34;</span><span style="color:#f85149">）</span>
</span></span><span style="display:flex;"><span>link_element<span style="color:#ff7b72;font-weight:bold">.</span>click<span style="color:#f85149">（）</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="12306爬虫实现">12306爬虫实现</h1>
<p>完成代码见：https://github.com/Lucareful/12306_Tickets</p>
<ul>
<li>实现步骤
<ul>
<li>1.访问列表页</li>
<li>2.通过时间判定选择点击预订</li>
<li>3.点击账号登录</li>
<li>4.输入用户名和密码（15523750230）</li>
<li>5.截图获取验证码图片</li>
<li>6.发送打码平台获取识别数字</li>
<li>7.定义8个点击坐标</li>
<li>8.模拟点击坐标</li>
<li>9.点击登录</li>
<li>10.点击选择人物</li>
<li>11.点击提交订单</li>
<li>12.点击确认订单</li>
</ul>
</li>
</ul>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">110
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># -*- coding: utf-8 -*-</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">import</span> <span style="color:#ff7b72">json</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">import</span> <span style="color:#ff7b72">time</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">selenium</span> <span style="color:#ff7b72">import</span> webdriver
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">selenium.webdriver</span> <span style="color:#ff7b72">import</span> ActionChains
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">selenium.webdriver.support.wait</span> <span style="color:#ff7b72">import</span> WebDriverWait
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">selenium.webdriver.support</span> <span style="color:#ff7b72">import</span> expected_conditions <span style="color:#ff7b72">as</span> EC
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">selenium.webdriver.common.by</span> <span style="color:#ff7b72">import</span> By
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">PIL</span> <span style="color:#ff7b72">import</span> Image
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">io</span> <span style="color:#ff7b72">import</span> BytesIO
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 判断YDMHTTP模块是否在python环境中（我的是不在，所以加上去）</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">import</span> <span style="color:#ff7b72">sys</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sys<span style="color:#ff7b72;font-weight:bold">.</span>path<span style="color:#ff7b72;font-weight:bold">.</span>insert(<span style="color:#a5d6ff">1</span>, <span style="color:#79c0ff">r</span><span style="color:#a5d6ff">&#34;YDMHTTP.py&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">YDMHTTP</span> <span style="color:#ff7b72">import</span> decode
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>browser <span style="color:#ff7b72;font-weight:bold">=</span> webdriver<span style="color:#ff7b72;font-weight:bold">.</span>Chrome()
</span></span><span style="display:flex;"><span>browser<span style="color:#ff7b72;font-weight:bold">.</span>maximize_window()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>linktypeid <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;dc&#34;</span>
</span></span><span style="display:flex;"><span>fs <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;北京&#34;</span>
</span></span><span style="display:flex;"><span>ts <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;武汉&#34;</span>
</span></span><span style="display:flex;"><span>date <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;2020-01-13&#34;</span>
</span></span><span style="display:flex;"><span>flag <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;N,N,Y&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>base_url <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#39;https://kyfw.12306.cn/otn/leftTicket/init?linktypeid=</span><span style="color:#a5d6ff">{}</span><span style="color:#a5d6ff">&amp;fs=</span><span style="color:#a5d6ff">{}</span><span style="color:#a5d6ff">,BJP&amp;ts=</span><span style="color:#a5d6ff">{}</span><span style="color:#a5d6ff">,WHN&amp;date=</span><span style="color:#a5d6ff">{}</span><span style="color:#a5d6ff">&amp;flag=</span><span style="color:#a5d6ff">{}</span><span style="color:#a5d6ff">&#39;</span>
</span></span><span style="display:flex;"><span>url <span style="color:#ff7b72;font-weight:bold">=</span> base_url<span style="color:#ff7b72;font-weight:bold">.</span>format(linktypeid, fs, ts, date, flag)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>browser<span style="color:#ff7b72;font-weight:bold">.</span>get(url)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>wait <span style="color:#ff7b72;font-weight:bold">=</span> WebDriverWait(browser, <span style="color:#a5d6ff">10</span>, <span style="color:#a5d6ff">0.5</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 通过时间判定选择预定车次</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 寻找tr标签中的 属性id 已 ’ticket_‘ 开头的数据</span>
</span></span><span style="display:flex;"><span>tr_list <span style="color:#ff7b72;font-weight:bold">=</span> wait<span style="color:#ff7b72;font-weight:bold">.</span>until(EC<span style="color:#ff7b72;font-weight:bold">.</span>visibility_of_all_elements_located((By<span style="color:#ff7b72;font-weight:bold">.</span>XPATH, <span style="color:#a5d6ff">&#39;//tr[starts-with(@id, &#34;ticket_&#34;)]&#39;</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">for</span> tr <span style="color:#ff7b72;font-weight:bold">in</span> tr_list:
</span></span><span style="display:flex;"><span>    date_string <span style="color:#ff7b72;font-weight:bold">=</span> tr<span style="color:#ff7b72;font-weight:bold">.</span>find_element_by_class_name(<span style="color:#a5d6ff">&#34;start-t&#34;</span>)<span style="color:#ff7b72;font-weight:bold">.</span>text
</span></span><span style="display:flex;"><span>    <span style="color:#8b949e;font-style:italic"># 判断时间是否在符合你想要的时间范围中</span>
</span></span><span style="display:flex;"><span>    tr<span style="color:#ff7b72;font-weight:bold">.</span>find_element_by_class_name(<span style="color:#a5d6ff">&#39;no-br&#39;</span>)<span style="color:#ff7b72;font-weight:bold">.</span>click()
</span></span><span style="display:flex;"><span>    <span style="color:#8b949e;font-style:italic"># print(date_string)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">break</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 点击账号 异步加载需要显性等待</span>
</span></span><span style="display:flex;"><span>wait<span style="color:#ff7b72;font-weight:bold">.</span>until(EC<span style="color:#ff7b72;font-weight:bold">.</span>visibility_of_element_located((By<span style="color:#ff7b72;font-weight:bold">.</span>LINK_TEXT, <span style="color:#a5d6ff">&#34;账号登录&#34;</span>)))<span style="color:#ff7b72;font-weight:bold">.</span>click()
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># browser.find_element_by_link_text(&#34;账号登录&#34;).click()</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 输入用户名和密码（我将我的用户名和密码保存在了json文件中，若别人使用需要更改）</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">with</span> open(<span style="color:#a5d6ff">&#34;account.json&#34;</span>, <span style="color:#a5d6ff">&#34;r&#34;</span>, encoding<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;utf-8&#34;</span>) <span style="color:#ff7b72">as</span> f:
</span></span><span style="display:flex;"><span>    account <span style="color:#ff7b72;font-weight:bold">=</span> json<span style="color:#ff7b72;font-weight:bold">.</span>load(f)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>browser<span style="color:#ff7b72;font-weight:bold">.</span>find_element_by_id(<span style="color:#a5d6ff">&#34;J-userName&#34;</span>)<span style="color:#ff7b72;font-weight:bold">.</span>send_keys(account[<span style="color:#a5d6ff">&#34;username&#34;</span>])
</span></span><span style="display:flex;"><span>browser<span style="color:#ff7b72;font-weight:bold">.</span>find_element_by_id(<span style="color:#a5d6ff">&#34;J-password&#34;</span>)<span style="color:#ff7b72;font-weight:bold">.</span>send_keys(account[<span style="color:#a5d6ff">&#34;password&#34;</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 获取全屏截图</span>
</span></span><span style="display:flex;"><span>full_img_data <span style="color:#ff7b72;font-weight:bold">=</span> browser<span style="color:#ff7b72;font-weight:bold">.</span>get_screenshot_as_png()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 截取验证图片</span>
</span></span><span style="display:flex;"><span>login_img_element <span style="color:#ff7b72;font-weight:bold">=</span> wait<span style="color:#ff7b72;font-weight:bold">.</span>until((EC<span style="color:#ff7b72;font-weight:bold">.</span>visibility_of_element_located((By<span style="color:#ff7b72;font-weight:bold">.</span>ID, <span style="color:#a5d6ff">&#34;J-loginImg&#34;</span>))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 计算截图位置</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 截取验证码的位置</span>
</span></span><span style="display:flex;"><span>scale <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">2.0</span>
</span></span><span style="display:flex;"><span>x1 <span style="color:#ff7b72;font-weight:bold">=</span> login_img_element<span style="color:#ff7b72;font-weight:bold">.</span>location[<span style="color:#a5d6ff">&#34;x&#34;</span>]
</span></span><span style="display:flex;"><span>y1 <span style="color:#ff7b72;font-weight:bold">=</span> login_img_element<span style="color:#ff7b72;font-weight:bold">.</span>location[<span style="color:#a5d6ff">&#34;y&#34;</span>]
</span></span><span style="display:flex;"><span>x2 <span style="color:#ff7b72;font-weight:bold">=</span> x1 <span style="color:#ff7b72;font-weight:bold">+</span> login_img_element<span style="color:#ff7b72;font-weight:bold">.</span>size[<span style="color:#a5d6ff">&#34;width&#34;</span>] <span style="color:#ff7b72;font-weight:bold">*</span> scale
</span></span><span style="display:flex;"><span>y2 <span style="color:#ff7b72;font-weight:bold">=</span> y1 <span style="color:#ff7b72;font-weight:bold">+</span> login_img_element<span style="color:#ff7b72;font-weight:bold">.</span>size[<span style="color:#a5d6ff">&#34;height&#34;</span>] <span style="color:#ff7b72;font-weight:bold">*</span> scale
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cut_info <span style="color:#ff7b72;font-weight:bold">=</span> (x1, y1, x2, y2)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 把全屏图片构建成全屏图片操作对象</span>
</span></span><span style="display:flex;"><span>full_img <span style="color:#ff7b72;font-weight:bold">=</span> Image<span style="color:#ff7b72;font-weight:bold">.</span>open(BytesIO(full_img_data))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 通过截图信息对象截取图片</span>
</span></span><span style="display:flex;"><span>cut_img <span style="color:#ff7b72;font-weight:bold">=</span> full_img<span style="color:#ff7b72;font-weight:bold">.</span>crop(cut_info)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 把图片保存到本地</span>
</span></span><span style="display:flex;"><span>cut_img<span style="color:#ff7b72;font-weight:bold">.</span>save(<span style="color:#a5d6ff">&#39;demo.png&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 将验证图片发送到打码平台</span>
</span></span><span style="display:flex;"><span>result <span style="color:#ff7b72;font-weight:bold">=</span> decode(<span style="color:#a5d6ff">&#39;demo.png&#39;</span>, codetype<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">6701</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 定义八个点击坐标点</span>
</span></span><span style="display:flex;"><span>positions <span style="color:#ff7b72;font-weight:bold">=</span> [
</span></span><span style="display:flex;"><span>    (<span style="color:#a5d6ff">7.30</span><span style="color:#ff7b72;font-weight:bold">*</span><span style="color:#a5d6ff">25</span>, <span style="color:#a5d6ff">140</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#a5d6ff">10.58</span><span style="color:#ff7b72;font-weight:bold">*</span><span style="color:#a5d6ff">25</span>, <span style="color:#a5d6ff">140</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#a5d6ff">13.83</span><span style="color:#ff7b72;font-weight:bold">*</span><span style="color:#a5d6ff">25</span>, <span style="color:#a5d6ff">140</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#a5d6ff">17.11</span><span style="color:#ff7b72;font-weight:bold">*</span><span style="color:#a5d6ff">25</span>, <span style="color:#a5d6ff">140</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#a5d6ff">7.30</span><span style="color:#ff7b72;font-weight:bold">*</span><span style="color:#a5d6ff">25</span>, <span style="color:#a5d6ff">250</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#a5d6ff">10.58</span><span style="color:#ff7b72;font-weight:bold">*</span><span style="color:#a5d6ff">25</span>, <span style="color:#a5d6ff">250</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#a5d6ff">13.83</span><span style="color:#ff7b72;font-weight:bold">*</span><span style="color:#a5d6ff">25</span>, <span style="color:#a5d6ff">250</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#a5d6ff">17.05</span><span style="color:#ff7b72;font-weight:bold">*</span><span style="color:#a5d6ff">25</span>, <span style="color:#a5d6ff">250</span>)
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 模拟点击坐标</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">for</span> num <span style="color:#ff7b72;font-weight:bold">in</span> result:
</span></span><span style="display:flex;"><span>    position <span style="color:#ff7b72;font-weight:bold">=</span> positions[int(num) <span style="color:#ff7b72;font-weight:bold">-</span> <span style="color:#a5d6ff">1</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#8b949e;font-style:italic"># 动作对象</span>
</span></span><span style="display:flex;"><span>    ActionChains(browser)<span style="color:#ff7b72;font-weight:bold">.</span>move_to_element_with_offset(login_img_element, position[<span style="color:#a5d6ff">0</span>]<span style="color:#ff7b72;font-weight:bold">/</span><span style="color:#a5d6ff">2</span>, position[<span style="color:#a5d6ff">1</span>]<span style="color:#ff7b72;font-weight:bold">/</span><span style="color:#a5d6ff">2</span>)<span style="color:#ff7b72;font-weight:bold">.</span>click()<span style="color:#ff7b72;font-weight:bold">.</span>perform()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 点击登录</span>
</span></span><span style="display:flex;"><span>browser<span style="color:#ff7b72;font-weight:bold">.</span>find_element_by_id(<span style="color:#a5d6ff">&#34;J-login&#34;</span>)<span style="color:#ff7b72;font-weight:bold">.</span>click()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 点击选择乘车人</span>
</span></span><span style="display:flex;"><span>wait<span style="color:#ff7b72;font-weight:bold">.</span>until(EC<span style="color:#ff7b72;font-weight:bold">.</span>visibility_of_element_located((By<span style="color:#ff7b72;font-weight:bold">.</span>ID, <span style="color:#a5d6ff">&#34;normalPassenger_0&#34;</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 点击提交订单</span>
</span></span><span style="display:flex;"><span>browser<span style="color:#ff7b72;font-weight:bold">.</span>find_element_by_id(<span style="color:#a5d6ff">&#34;submitOrder_id&#34;</span>)<span style="color:#ff7b72;font-weight:bold">.</span>click()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>time<span style="color:#ff7b72;font-weight:bold">.</span>sleep(<span style="color:#a5d6ff">5</span>)
</span></span></code></pre></td></tr></table>
</div>
</div>]]></content:encoded>
    </item>
  </channel>
</rss>
