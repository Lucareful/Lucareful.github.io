<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Python的web框架 on Luenci</title>
    <link>https://Lucareful.github.io/en/categories/python%E7%9A%84web%E6%A1%86%E6%9E%B6/</link>
    <description>Recent content in Python的web框架 on Luenci</description>
    <generator>Hugo -- 0.131.0</generator>
    <language>en</language>
    <atom:link href="https://Lucareful.github.io/en/categories/python%E7%9A%84web%E6%A1%86%E6%9E%B6/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>django&#43;nginx&#43;uwsgi部署漫谈</title>
      <link>https://Lucareful.github.io/en/posts/django&#43;nginx&#43;uwsgi%E9%83%A8%E7%BD%B2%E6%BC%AB%E8%B0%88/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://Lucareful.github.io/en/posts/django&#43;nginx&#43;uwsgi%E9%83%A8%E7%BD%B2%E6%BC%AB%E8%B0%88/</guid>
      <description>写在前面：关于Django的部署问题网上有很多教程，但是每个人的配置环境和遇到的情况都一样，所以在此记录下我部署过程中遇到的问题 **看官方文</description>
      <content:encoded><![CDATA[<blockquote>
<p>写在前面：关于Django的部署问题网上有很多教程，但是每个人的配置环境和遇到的情况都一样，所以在此记录下我部署过程中遇到的问题</p>
</blockquote>
<p>**看官方文档：**<a href="https://uwsgi-docs.readthedocs.io/en/latest/tutorials/Django_and_nginx.html">https://uwsgi-docs.readthedocs.io/en/latest/tutorials/Django_and_nginx.html</a>（特别重要！！！）</p>
<h2 id="环境介绍">环境介绍</h2>
<ul>
<li>阿里云主机（<code>Ubuntu</code>系统）</li>
<li><code>virtualenv</code>虚拟环境
<ul>
<li>python3版本</li>
<li>Django 2.0.3 版本</li>
<li>uwsgi 2.0.19版本</li>
</ul>
</li>
<li>Nginx/1.10.3 (<code>Ubuntu</code>)</li>
</ul>
<h2 id="nginx目录介绍">nginx目录介绍</h2>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmd" data-lang="cmd"><span style="display:flex;"><span>.
</span></span><span style="display:flex;"><span>├── [drwxr-xr-x]  conf.d
</span></span><span style="display:flex;"><span>├── [-rw-r--r--]  fastcgi.conf
</span></span><span style="display:flex;"><span>├── [-rw-r--r--]  fastcgi_params
</span></span><span style="display:flex;"><span>├── [-rw-r--r--]  koi-utf
</span></span><span style="display:flex;"><span>├── [-rw-r--r--]  koi-win
</span></span><span style="display:flex;"><span>├── [-rw-r--r--]  mime.types
</span></span><span style="display:flex;"><span>├── [-rw-r--r--]  nginx.conf
</span></span><span style="display:flex;"><span>├── [-rw-r--r--]  proxy_params
</span></span><span style="display:flex;"><span>├── [-rw-r--r--]  scgi_params
</span></span><span style="display:flex;"><span>├── [drwxr-xr-x]  sites-available
</span></span><span style="display:flex;"><span>│   └── [-rw-r--r--]  default
</span></span><span style="display:flex;"><span>├── [drwxr-xr-x]  sites-enabled
</span></span><span style="display:flex;"><span>│   └── [lrwxrwxrwx]  default -&gt; /etc/nginx/sites-available/default
</span></span><span style="display:flex;"><span>├── [drwxr-xr-x]  snippets
</span></span><span style="display:flex;"><span>│   ├── [-rw-r--r--]  fastcgi-php.conf
</span></span><span style="display:flex;"><span>│   └── [-rw-r--r--]  snakeoil.conf
</span></span><span style="display:flex;"><span>├── [-rw-r--r--]  uwsgi_params
</span></span><span style="display:flex;"><span>└── [-rw-r--r--]  win-utf
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">39
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmd" data-lang="cmd"><span style="display:flex;"><span>相关目录和文件作用
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>client_body_temp  # Nginx所有配置文件的目录
</span></span><span style="display:flex;"><span>conf   	#配置文件目录（.default 文件为对应的默认文件）
</span></span><span style="display:flex;"><span>fastcgi.conf    # fastcgi相关参数的配置文件
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>fastcgi_params  # fastcgi的参数文件
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>koi-utf    		# 媒体类型
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>koi-win   		# 媒体类型
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>mime.types #当 Web 服务器收到静态的资源文件请求时，依据请求文件的后缀名在服务器的 MIME 配置文件中找到对应的 MIME Type，再根据 MIME Type 设置 HTTP Response 的Content-Type，然后浏览器根据 Content-Type 的值处理文件
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>nginx.conf   #Nginx主配置文件
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>scgi_params  # scgi的配置文件
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>uwsgi_params  # uwsgi 和 nginx的通信文件
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>win-utf   #
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>html 		#默认解析的静态文件目录
</span></span><span style="display:flex;"><span>50x.html   	#错误页面优雅替代文件 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>index.html  #网站首页配置文件 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>logs 		#日志目录
</span></span><span style="display:flex;"><span>access.log  #访问日志，包含所有访问记录
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>error.log   #错误日志，包含访问出错的记录
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>nginx.pid     Nginx运行的进程号，同ps -ef | grep nginx 第一行的进程号
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sbin #Nginx可执行文件目录
</span></span><span style="display:flex;"><span>nginx #Nginx 启动文件
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>koi-utf、koi-win、win-utf 是与编码转换有关的配置文件
</span></span><span style="display:flex;"><span>其他带 temp 的为临时目录
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>ASGI 是为了支持异步网络服务器和应用而新出现的Python 标准。</p>
</blockquote>
<!-- more --->
<h2 id="注意问题">注意问题</h2>
<ul>
<li>在阿里云上面部署的时候，需要注意nginx的配置</li>
</ul>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmd" data-lang="cmd"><span style="display:flex;"><span># nginx的配置
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>server_name 你的主机ip;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        location / {
</span></span><span style="display:flex;"><span>                # First attempt to serve request as file, then
</span></span><span style="display:flex;"><span>                # as directory, then fall back to displaying a 404.
</span></span><span style="display:flex;"><span>                #try_files $uri $uri/ =404;
</span></span><span style="display:flex;"><span>                include  uwsgi_params;
</span></span><span style="display:flex;"><span>                        uwsgi_pass  你的主机ip:端口;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        location /static {
</span></span><span style="display:flex;"><span>                 alias /home/myblog/static;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>        location /media {
</span></span><span style="display:flex;"><span>                alias /home/myblog/media;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>虚拟环境的问题：</p>
<ul>
<li>
<p>在阿里云主机上如果直接用<code>virtualenv</code>创建虚拟环境会出现一些问题，因为系统默认的是<code>python2</code>的版本，需要指定版本</p>
<ul>
<li>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>virtualenv <span style="color:#ff7b72;font-weight:bold">-</span>p <span style="color:#ff7b72;font-weight:bold">/</span>usr<span style="color:#ff7b72;font-weight:bold">/</span>bin<span style="color:#ff7b72;font-weight:bold">/</span>python3 venv<span style="color:#ff7b72;font-weight:bold">/</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
</ul>
<h2 id="后记">后记</h2>
<ul>
<li>安装配置的过程是漫长痛苦的，尤其是找不到思路的时候。所以要静下心来，多读官方文档！！！多读官方文档！！！多读官方文档！！！仔细的检查配置，项目跑起来的那一刻是很激动开心的。</li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>Django之编写URL</title>
      <link>https://Lucareful.github.io/en/posts/django%E4%B9%8Burl%E8%A7%84%E5%88%99/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://Lucareful.github.io/en/posts/django%E4%B9%8Burl%E8%A7%84%E5%88%99/</guid>
      <description>&lt;h1 id=&#34;编写url&#34;&gt;编写URL&lt;/h1&gt;
&lt;h2 id=&#34;编写规则&#34;&gt;编写规则&lt;/h2&gt;
&lt;p&gt;​	为了使其规范性，在每个新创建的App中设置独立的静态资源和模板文件夹并添加一个空白的&lt;code&gt;.py&lt;/code&gt;文件，命为&lt;code&gt;urls.py&lt;/code&gt;。如下是创建app中的文件结构：&lt;/p&gt;</description>
      <content:encoded><![CDATA[<h1 id="编写url">编写URL</h1>
<h2 id="编写规则">编写规则</h2>
<p>​	为了使其规范性，在每个新创建的App中设置独立的静态资源和模板文件夹并添加一个空白的<code>.py</code>文件，命为<code>urls.py</code>。如下是创建app中的文件结构：</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>frist<span style="color:#ff7b72;font-weight:bold">/</span>
</span></span><span style="display:flex;"><span>	migrations<span style="color:#ff7b72;font-weight:bold">/</span>		<span style="color:#8b949e;font-style:italic"># 数据库前后是否有变化，生成出迁移文件</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>	static<span style="color:#ff7b72;font-weight:bold">/</span>			<span style="color:#8b949e;font-style:italic"># 创建App后存放App中的静态资源文件，自己手动添加</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>	templates<span style="color:#ff7b72;font-weight:bold">/</span>		<span style="color:#8b949e;font-style:italic"># 创建App后存放App中的模板文件，自己手动添加</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>	__init__<span style="color:#ff7b72;font-weight:bold">.</span>py
</span></span><span style="display:flex;"><span>	admin<span style="color:#ff7b72;font-weight:bold">.</span>py
</span></span><span style="display:flex;"><span>	apps<span style="color:#ff7b72;font-weight:bold">.</span>py
</span></span><span style="display:flex;"><span>	models<span style="color:#ff7b72;font-weight:bold">.</span>py
</span></span><span style="display:flex;"><span>	tests<span style="color:#ff7b72;font-weight:bold">.</span>py
</span></span><span style="display:flex;"><span>	urls<span style="color:#ff7b72;font-weight:bold">.</span>py			<span style="color:#8b949e;font-style:italic"># 创建App后由系统总路由映射到App的路由文件，自己手动添加</span>
</span></span><span style="display:flex;"><span>	view<span style="color:#ff7b72;font-weight:bold">.</span>py
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="系统总路由和app的路由分发配置">系统总路由和app的路由分发配置</h3>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 根目录的urls.py</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">django.contrib</span> <span style="color:#ff7b72">import</span> admin
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">django.urls</span> <span style="color:#ff7b72">import</span> path,admin
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>urlpatterns <span style="color:#ff7b72;font-weight:bold">=</span> [
</span></span><span style="display:flex;"><span>    path(<span style="color:#a5d6ff">&#39;admin/&#39;</span>, admin<span style="color:#ff7b72;font-weight:bold">.</span>site<span style="color:#ff7b72;font-weight:bold">.</span>urls),
</span></span><span style="display:flex;"><span>    path(<span style="color:#a5d6ff">&#39;&#39;</span>,include(<span style="color:#a5d6ff">&#39;frist.urls&#39;</span>))			<span style="color:#8b949e;font-style:italic"># 引入app中的urls.py</span>
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></td></tr></table>
</div>
</div><p>代码详解:</p>
<ul>
<li><code>from django.contrib import admin</code>:导入Admin功能模块.</li>
<li><code>from django.urls import path,admin</code>:导入URL编写模块.</li>
<li><code>urlpatterns</code>:整个项目的URL集合,每个元素代表一条URL信息.</li>
<li><code>path('admin/', admin.site.urls)</code>:设定Admin的URL.<code>'admin/'</code>代表<code>127.0.0.1/admin</code>地址信息,<code>admin</code>后面的斜杠是路径分隔符;admin.site.urls是URL的处理函数,也称为视图函数.</li>
<li><code> path('',include('frist.urls'))	</code>:URL为空,代表网站的域名,即127.0.0.1,通常是网站的首页;include将该URL分发给app的urls.py处理.</li>
</ul>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># app下的urls.py</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">django.urls</span> <span style="color:#ff7b72">import</span> path
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">.</span> <span style="color:#ff7b72">import</span> views
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>urlpatterns <span style="color:#ff7b72;font-weight:bold">=</span> [
</span></span><span style="display:flex;"><span>    path(<span style="color:#a5d6ff">&#39;&#39;</span>,views<span style="color:#ff7b72;font-weight:bold">.</span>index)	<span style="color:#8b949e;font-style:italic"># 调用和url匹配的视图函数</span>
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></td></tr></table>
</div>
</div><p>当根目录的URL分发给app中的URL处理后,下一步就是根据所匹配的URL进行视图的调用.</p>
<p>在Views中编写相应的视图函数。如下：</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># index的views.py</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">django.http</span> <span style="color:#ff7b72">import</span> HttpResponse
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># creat you views here.</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">index</span>(request):
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">return</span> HttpResponse(<span style="color:#a5d6ff">&#34;hello world&#34;</span>)   
</span></span></code></pre></td></tr></table>
</div>
</div><p>视图函数的参数必须设置为<code>request</code>，该参数代表当前用户的请求对象，该对象包含用户名，请求内容和请求方式等信息，执行完成后必须使用<code>return</code>将处理结果返回。</p>
<h2 id="带变量的url">带变量的URL</h2>
<p>​	在日常开发中，有时候一个URL可以代表多个不同的页面，如编写带有日期的URL，若根据前面的编写方式，按一年计算，则需要开发者编写365个不同的URL才能实现。这种做法是不可取的，因此，Django在编写URL时，可以对URL设置变量值，使URL具有多样性。</p>
<p>​	URL的变量类型有字符类型，整型，<code>slug</code>和<code>uuid</code>，常用的是字符类型和整型。说明如下：</p>
<ul>
<li>字符类型：匹配任何非空字符串，但不含斜杠。如果没有指定类型，默认使用该类型。</li>
<li>整形：匹配0和正整数</li>
<li>slug：可理解为注释，后缀或附属等概念，常作为URL的解释性字符。可匹配任何ASCII字符以及连接符和下画线，能使URL更加清晰易懂。比如网页的标题是“13岁的孩子”，其URL地址可以设置为“13-sui-de-hai-zi“。</li>
<li>uuid：匹配一个uuid格式的对象。为了防止冲突，规定必须使用破折号并且所有字母必须小写，例如0201203-3213-31e-321c34d435</li>
</ul>
<p>（未待完续）</p>]]></content:encoded>
    </item>
    <item>
      <title>Django参数和模板</title>
      <link>https://Lucareful.github.io/en/posts/django%E5%8F%82%E6%95%B0%E5%92%8C%E6%A8%A1%E6%9D%BF/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://Lucareful.github.io/en/posts/django%E5%8F%82%E6%95%B0%E5%92%8C%E6%A8%A1%E6%9D%BF/</guid>
      <description>render方法参数 request: 是一个固定参数。 template_name: templates 中定义的文件, 要注意路径名. 比如’templates\polls\index.html’, 参数就要</description>
      <content:encoded><![CDATA[<h2 id="render方法参数"><code>render</code>方法参数</h2>
<ul>
<li><code>request</code>: 是一个固定参数。</li>
<li><code>template_name</code>: <code>templates</code> 中定义的文件, 要注意路径名. 比如<code>’templates\polls\index.html’</code>, 参数就要写<code>‘polls\index.html’</code></li>
<li><code>context</code>: 要传入文件中用于渲染呈现的数据, 默认是字典格式</li>
<li><code>content_type</code>: 生成的文档要使用的MIME 类型。默认为DEFAULT_CONTENT_TYPE 设置的值。</li>
<li><code>status</code>: http的响应代码,默认是200.</li>
<li><code>using</code>: 用于加载模板使用的模板引擎的名称。</li>
</ul>
<h2 id="request对象方法和属性"><code>request</code>对象方法和属性</h2>
<ul>
<li><code>request.scheme</code>   # 代表请求的方案,http或者https</li>
<li><code>request.body</code># 原始HTTP请求主体为字节串。这对于以不同于常规HTML格式的方式处理数据很有用：二进制图像，XML有效负载等。对于处理常规格式的数据，请使用 <code>HttpRequest.POST</code>。</li>
<li><code>request.path</code>   # 请求的路径,比如请求<code>127.0.0.1/org/list</code>,那这个值就是<code>/org/list</code></li>
<li><code>request.get_full_path()</code> # 获取完整的请求路径</li>
<li><code>request.method</code>  # 表示请求使用的http方法,GET或者POST请求</li>
<li><code>request.encoding</code> # 表示提交数据的编码方式</li>
<li><code>request.GET</code>     # 获取GET请求</li>
<li><code>request.POST</code>    # 获取post的请求,比如前端提交的用户密码,可以通过<code>request.POST.get()</code>来获取</li>
</ul>
<blockquote>
<p><strong>NOTICED：如果使用 POST 上传文件的话，文件信息将包含在 FILES 属性中</strong></p>
</blockquote>
<p><code>request.COOKIES</code> #包含所有的cookie</p>
<p><code>request.META</code>   #一个标准的Python 字典，包含所有的HTTP 首部。具体的头部信息取决于客户端和服务器，下面是一些示例：</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmd" data-lang="cmd"><span style="display:flex;"><span>CONTENT_LENGTH 	—— 请求的正文的长度（是一个字符串）。
</span></span><span style="display:flex;"><span>CONTENT_TYPE 	—— 请求的正文的MIME 类型。
</span></span><span style="display:flex;"><span>HTTP_ACCEPT 	—— 响应可接收的Content-Type。
</span></span><span style="display:flex;"><span>HTTP_ACCEPT_ENCODING —— 响应可接收的编码。
</span></span><span style="display:flex;"><span>HTTP_ACCEPT_LANGUAGE —— 响应可接收的语言。
</span></span><span style="display:flex;"><span>HTTP_HOST 		—— 客服端发送的HTTP Host 头部。
</span></span><span style="display:flex;"><span>HTTP_REFERER 	—— Referring 页面。
</span></span><span style="display:flex;"><span>HTTP_USER_AGENT —— 客户端的user-agent 字符串。
</span></span><span style="display:flex;"><span>QUERY_STRING 	—— 单个字符串形式的查询字符串（未解析过的形式）。
</span></span><span style="display:flex;"><span>REMOTE_ADDR 	—— 客户端的IP 地址。
</span></span><span style="display:flex;"><span>REMOTE_HOST 	—— 客户端的主机名。
</span></span><span style="display:flex;"><span>REMOTE_USER 	—— 服务器认证后的用户。
</span></span><span style="display:flex;"><span>REQUEST_METHOD  —— 一个字符串，例如<span style="color:#a5d6ff">&#34;GET&#34;</span> 或<span style="color:#a5d6ff">&#34;POST&#34;</span>。
</span></span><span style="display:flex;"><span>SERVER_NAME 	—— 服务器的主机名。
</span></span><span style="display:flex;"><span>SERVER_PORT 	—— 服务器的端口（是一个字符串）
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><code>request.user</code>   #一个 <code>AUTH_USER_MODEL</code> 类型的对象，表示当前登录的用户。
<ul>
<li>如果用户当前没有登录，user 将设置为 <code>django.contrib.auth.models.AnonymousUser</code> 的一个实例。你可以通过 <code>s_authenticated() </code>区分它们</li>
<li>把<code>request</code>传给前端的时候,前端可以通过 <code> if request.user.is_authenticated</code>判断用户时候登录</li>
</ul>
</li>
<li><code>request.session</code> #一个既可读又可写的类似于字典的对象，表示当前的会话</li>
</ul>
<!-- more -->
<h2 id="response对象"><code>response</code>对象</h2>
<ul>
<li><code>Httpresponse</code>对象对于 <code>Httpreques</code>对象来说，是由<code> django</code>自动创建的，但是， <code>Httpresponse</code>对象就必须我们自己创建。每个<code>view</code>请求处理方法必须返回一个 <code>Httpresponse</code>对象。</li>
</ul>
<blockquote>
<p><code>Httpresponse</code>类在<code>djangohttpHttprespons</code></p>
</blockquote>
<blockquote>
<p>在 <code>Httpresponse</code>对象上扩展的常用方法：</p>
</blockquote>
<ul>
<li>
<p>页面渲染</p>
<ul>
<li><code>render() </code></li>
<li><code>render to response()</code></li>
</ul>
</li>
<li>
<p>页面跳转：</p>
<ul>
<li><code>redirect(&quot;路径&quot;)</code></li>
</ul>
</li>
<li>
<p><code>locals()</code>：可以直接将函数中所有的变里传给模板</p>
</li>
</ul>
<h2 id="内置变量过滤器filter">内置变量过滤器<code>filter</code></h2>
<p>​    可以理解为python中的内置函数，过滤器是模板的特有语法，通过前端来过滤部分数据。注意filter只能传递一个参数(也可以说是两个参数，因为第一个个参数已经固定，就是被处理的那个)。
格式：</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jinja" data-lang="jinja"><span style="display:flex;"><span>`<span style="color:#8b949e;font-weight:bold;font-style:italic">{{</span><span style="color:#f85149">`</span> <span style="color:#79c0ff">var</span><span style="color:#ff7b72;font-weight:bold">|</span><span style="color:#d2a8ff;font-weight:bold">method</span><span style="color:#ff7b72;font-weight:bold">:</span><span style="color:#79c0ff">parameter</span><span style="color:#f85149">`</span><span style="color:#8b949e;font-weight:bold;font-style:italic">}}</span>`
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>method表示过滤器部分过滤器如下</li>
</ul>
<table>
<thead>
<tr>
<th>过滤器</th>
<th>说明</th>
<th>举例</th>
</tr>
</thead>
<tbody>
<tr>
<td>first</td>
<td>取列表第一个元素</td>
<td></td>
</tr>
<tr>
<td>last</td>
<td>取列表最后元素</td>
<td></td>
</tr>
<tr>
<td>capfirst</td>
<td>首字母大写</td>
<td></td>
</tr>
</tbody>
</table>
<p><img loading="lazy" src="https://raw.githubusercontent.com/Lucareful/ImgRepo/master/img/hexo_img/image-20200614210257960.png" alt="filter"  />
</p>
<h2 id="logging配置"><code>logging</code>配置</h2>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">59
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">#下面就是logging的配置</span>
</span></span><span style="display:flex;"><span>LOGGING <span style="color:#ff7b72;font-weight:bold">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#39;version&#39;</span>: <span style="color:#a5d6ff">1</span>,  <span style="color:#8b949e;font-style:italic"># 指明dictConnfig的版本，目前就只有一个版本</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#39;disable_existing_loggers&#39;</span>: <span style="color:#79c0ff">False</span>,  <span style="color:#8b949e;font-style:italic"># 表示是否禁用所有的已经存在的日志配置</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#39;formatters&#39;</span>: {  <span style="color:#8b949e;font-style:italic"># 格式器</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#39;verbose&#39;</span>: {  <span style="color:#8b949e;font-style:italic"># 详细</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a5d6ff">&#39;format&#39;</span>: <span style="color:#a5d6ff">&#39;</span><span style="color:#a5d6ff">%(levelname)s</span><span style="color:#a5d6ff"> </span><span style="color:#a5d6ff">%(asctime)s</span><span style="color:#a5d6ff"> </span><span style="color:#a5d6ff">%(module)s</span><span style="color:#a5d6ff"> </span><span style="color:#a5d6ff">%(process)d</span><span style="color:#a5d6ff"> </span><span style="color:#a5d6ff">%(thread)d</span><span style="color:#a5d6ff"> </span><span style="color:#a5d6ff">%(message)s</span><span style="color:#a5d6ff">&#39;</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#39;standard&#39;</span>: {  <span style="color:#8b949e;font-style:italic"># 标准</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a5d6ff">&#39;format&#39;</span>: <span style="color:#a5d6ff">&#39;[</span><span style="color:#a5d6ff">%(asctime)s</span><span style="color:#a5d6ff">] [</span><span style="color:#a5d6ff">%(levelname)s</span><span style="color:#a5d6ff">] </span><span style="color:#a5d6ff">%(message)s</span><span style="color:#a5d6ff">&#39;</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#8b949e;font-style:italic"># handlers：用来定义具体处理日志的方式，可以定义多种，&#34;default&#34;就是默认方式，&#34;console&#34;就是打印到控制台方式。file是写入到文件的方式，注意使用的class不同</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#39;handlers&#39;</span>: { <span style="color:#8b949e;font-style:italic"># 处理器，在这里定义了两个个处理器</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#39;console&#39;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#a5d6ff">&#39;level&#39;</span>: <span style="color:#a5d6ff">&#39;DEBUG&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a5d6ff">&#39;class&#39;</span>: <span style="color:#a5d6ff">&#39;logging.StreamHandler&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a5d6ff">&#39;stream&#39;</span>: <span style="color:#a5d6ff">&#39;ext://sys.stdout&#39;</span>,   <span style="color:#8b949e;font-style:italic"># 文件重定向的配置，将打印到控制台的信息都重定向出去 python manage.py runserver &gt;&gt; /home/aea/log/test.log</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b949e;font-style:italic"># &#39;stream&#39;: open(&#39;/home/aea/log/test.log&#39;,&#39;a&#39;),  #虽然成功了，但是并没有将所有内容全部写入文件，目前还不清楚为什么</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a5d6ff">&#39;formatter&#39;</span>: <span style="color:#a5d6ff">&#39;standard&#39;</span>   <span style="color:#8b949e;font-style:italic"># 制定输出的格式，注意 在上面的formatters配置里面选择一个，否则会报错</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#39;file&#39;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#a5d6ff">&#39;level&#39;</span>: <span style="color:#a5d6ff">&#39;DEBUG&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a5d6ff">&#39;class&#39;</span>: <span style="color:#a5d6ff">&#39;logging.FileHandler&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a5d6ff">&#39;filename&#39;</span>: os<span style="color:#ff7b72;font-weight:bold">.</span>path<span style="color:#ff7b72;font-weight:bold">.</span>join(BASE_DIR,<span style="color:#a5d6ff">&#39;debug.log&#39;</span>),  <span style="color:#8b949e;font-style:italic">#这是将普通日志写入到日志文件中的方法，</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a5d6ff">&#39;formatter&#39;</span>: <span style="color:#a5d6ff">&#39;standard&#39;</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#39;default&#39;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#a5d6ff">&#39;level&#39;</span>:<span style="color:#a5d6ff">&#39;DEBUG&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a5d6ff">&#39;class&#39;</span>:<span style="color:#a5d6ff">&#39;logging.handlers.RotatingFileHandler&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a5d6ff">&#39;filename&#39;</span>: os<span style="color:#ff7b72;font-weight:bold">.</span>path<span style="color:#ff7b72;font-weight:bold">.</span>join(BASE_DIR,<span style="color:#a5d6ff">&#39;All.log&#39;</span>),     <span style="color:#8b949e;font-style:italic">#日志输出文件</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a5d6ff">&#39;maxBytes&#39;</span>: <span style="color:#a5d6ff">1024</span><span style="color:#ff7b72;font-weight:bold">*</span><span style="color:#a5d6ff">1024</span><span style="color:#ff7b72;font-weight:bold">*</span><span style="color:#a5d6ff">5</span>,                  <span style="color:#8b949e;font-style:italic">#文件大小</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a5d6ff">&#39;backupCount&#39;</span>: <span style="color:#a5d6ff">5</span>,                         <span style="color:#8b949e;font-style:italic">#备份份数</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a5d6ff">&#39;formatter&#39;</span>:<span style="color:#a5d6ff">&#39;standard&#39;</span>,                   <span style="color:#8b949e;font-style:italic">#使用哪种formatters日志格式</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#8b949e;font-style:italic"># 上面两种写入日志的方法是有区别的，前者是将控制台下输出的内容全部写入到文件中，这样做的好处就是我们在views代码中的所有print也会写在对应的位置</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b949e;font-style:italic"># 第二种方法就是将系统内定的内容写入到文件，具体就是请求的地址、错误信息等，小伙伴也可以都使用一下然后查看两个文件的异同。</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#39;loggers&#39;</span>: {  <span style="color:#8b949e;font-style:italic"># log记录器，配置之后就会对应的输出日志</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b949e;font-style:italic"># django 表示就是django本身默认的控制台输出，就是原本在控制台里面输出的内容，在这里的handlers里的file表示写入到上面配置的file-/home/aea/log/jwt_test.log文件里面</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b949e;font-style:italic"># 在这里的handlers里的console表示写入到上面配置的console-/home/aea/log/test.log文件里面</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#39;django&#39;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#a5d6ff">&#39;handlers&#39;</span>: [<span style="color:#a5d6ff">&#39;console&#39;</span>,<span style="color:#a5d6ff">&#39;file&#39;</span>],
</span></span><span style="display:flex;"><span>            <span style="color:#8b949e;font-style:italic"># 这里直接输出到控制台只是请求的路由等系统console，当使用重定向之后会把所有内容输出到log日志</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a5d6ff">&#39;level&#39;</span>: <span style="color:#a5d6ff">&#39;DEBUG&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a5d6ff">&#39;propagate&#39;</span>: <span style="color:#79c0ff">True</span>,
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#39;django.request &#39;</span>:{
</span></span><span style="display:flex;"><span>            <span style="color:#a5d6ff">&#39;handlers&#39;</span>: [<span style="color:#a5d6ff">&#39;console&#39;</span>,<span style="color:#a5d6ff">&#39;file&#39;</span>],
</span></span><span style="display:flex;"><span>            <span style="color:#a5d6ff">&#39;level&#39;</span>: <span style="color:#a5d6ff">&#39;WARNING&#39;</span>,  <span style="color:#8b949e;font-style:italic"># 配合上面的将警告log写入到另外一个文件</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a5d6ff">&#39;propagate&#39;</span>: <span style="color:#79c0ff">True</span>,
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#39;django.db.backends&#39;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#a5d6ff">&#39;handlers&#39;</span>: [<span style="color:#a5d6ff">&#39;file&#39;</span>], <span style="color:#8b949e;font-style:italic"># 指定file handler处理器，表示只写入到文件</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a5d6ff">&#39;level&#39;</span>:<span style="color:#a5d6ff">&#39;DEBUG&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a5d6ff">&#39;propagate&#39;</span>: <span style="color:#79c0ff">True</span>,
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="orm的增删改查"><code>ORM</code>的增删改查</h2>
<ul>
<li>增加数据</li>
</ul>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">#方式一创建记录</span>
</span></span><span style="display:flex;"><span>b <span style="color:#ff7b72;font-weight:bold">=</span> Book(name<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;python基础&#34;</span>, price<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">99</span>, author<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;luenci&#34;</span>, pub_date<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;2020-06-14&#34;</span>)
</span></span><span style="display:flex;"><span>b<span style="color:#ff7b72;font-weight:bold">.</span>save()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">#方法二创建数据</span>
</span></span><span style="display:flex;"><span>Book<span style="color:#ff7b72;font-weight:bold">.</span>objects<span style="color:#ff7b72;font-weight:bold">.</span>create(name<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;python基础&#34;</span>, price<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">99</span>, author<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;luenci&#34;</span>, pub_date<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;2020-06-14&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 便捷方法</span>
</span></span><span style="display:flex;"><span>dic <span style="color:#ff7b72;font-weight:bold">=</span> {
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">&#39;name&#39;</span>: <span style="color:#a5d6ff">&#39;go基础&#39;</span>,
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">&#39;price&#39;</span>: <span style="color:#a5d6ff">99</span>,
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">&#39;author&#39;</span>: <span style="color:#a5d6ff">&#39;luenci&#39;</span>,
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">&#39;pub_date&#39;</span>: <span style="color:#a5d6ff">&#39;2020-06-13&#39;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>Book<span style="color:#ff7b72;font-weight:bold">.</span>objects<span style="color:#ff7b72;font-weight:bold">.</span>create(<span style="color:#ff7b72;font-weight:bold">**</span>dic)
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>更新数据</li>
</ul>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 方法一：(推荐用)</span>
</span></span><span style="display:flex;"><span>Book<span style="color:#ff7b72;font-weight:bold">.</span>objects<span style="color:#ff7b72;font-weight:bold">.</span>filter(author<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#39;luenci&#39;</span>)<span style="color:#ff7b72;font-weight:bold">.</span>update(price<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">100</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 方法二</span>
</span></span><span style="display:flex;"><span>b <span style="color:#ff7b72;font-weight:bold">=</span> Book<span style="color:#ff7b72;font-weight:bold">.</span>objects<span style="color:#ff7b72;font-weight:bold">.</span>get(name<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#39;go基础&#39;</span>)
</span></span><span style="display:flex;"><span>print(b) <span style="color:#8b949e;font-style:italic"># &lt;QuerySet [&lt;Book: Book object (3)&gt;]</span>
</span></span><span style="display:flex;"><span>b<span style="color:#ff7b72;font-weight:bold">.</span>price <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">8.9</span>
</span></span><span style="display:flex;"><span>b<span style="color:#ff7b72;font-weight:bold">.</span>save()
</span></span><span style="display:flex;"><span>print(type(b)) <span style="color:#8b949e;font-style:italic"># &lt;class &#39;app01.models.Book&#39;&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">return</span> HttpResponse(<span style="color:#a5d6ff">&#34;修改成功&#34;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>删除数据</li>
</ul>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>Book<span style="color:#ff7b72;font-weight:bold">.</span>objects<span style="color:#ff7b72;font-weight:bold">.</span>filter(name<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;go基础&#34;</span>)<span style="color:#ff7b72;font-weight:bold">.</span>delete()
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>查找数据</li>
</ul>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">29
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 获取所有对象</span>
</span></span><span style="display:flex;"><span>book_list <span style="color:#ff7b72;font-weight:bold">=</span> Book<span style="color:#ff7b72;font-weight:bold">.</span>objects<span style="color:#ff7b72;font-weight:bold">.</span>all()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 对name去重</span>
</span></span><span style="display:flex;"><span>book_list <span style="color:#ff7b72;font-weight:bold">=</span> Book<span style="color:#ff7b72;font-weight:bold">.</span>objects<span style="color:#ff7b72;font-weight:bold">.</span>all()<span style="color:#ff7b72;font-weight:bold">.</span>values(<span style="color:#a5d6ff">&#34;name&#34;</span>)<span style="color:#ff7b72;font-weight:bold">.</span>distinct()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 统计</span>
</span></span><span style="display:flex;"><span>book_list <span style="color:#ff7b72;font-weight:bold">=</span> Book<span style="color:#ff7b72;font-weight:bold">.</span>objects<span style="color:#ff7b72;font-weight:bold">.</span>all()<span style="color:#ff7b72;font-weight:bold">.</span>values(<span style="color:#a5d6ff">&#34;name&#34;</span>)<span style="color:#ff7b72;font-weight:bold">.</span>distinct()<span style="color:#ff7b72;font-weight:bold">.</span>count()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 查询的是对象的集合，即使只有一个对象也是集合的形式</span>
</span></span><span style="display:flex;"><span>book_list <span style="color:#ff7b72;font-weight:bold">=</span> Book<span style="color:#ff7b72;font-weight:bold">.</span>objects<span style="color:#ff7b72;font-weight:bold">.</span>filter(author<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#39;luenci&#39;</span>) 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>book_list <span style="color:#ff7b72;font-weight:bold">=</span> Book<span style="color:#ff7b72;font-weight:bold">.</span>objects<span style="color:#ff7b72;font-weight:bold">.</span>first()
</span></span><span style="display:flex;"><span>book_list <span style="color:#ff7b72;font-weight:bold">=</span> Book<span style="color:#ff7b72;font-weight:bold">.</span>objects<span style="color:#ff7b72;font-weight:bold">.</span>last()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 指定查询到一个对象</span>
</span></span><span style="display:flex;"><span>book_list <span style="color:#ff7b72;font-weight:bold">=</span> Book<span style="color:#ff7b72;font-weight:bold">.</span>objects<span style="color:#ff7b72;font-weight:bold">.</span>get(id<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">7</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 查询作者为luenci出版的书名.（字典的集合）</span>
</span></span><span style="display:flex;"><span>book_list1 <span style="color:#ff7b72;font-weight:bold">=</span> Book<span style="color:#ff7b72;font-weight:bold">.</span>objects<span style="color:#ff7b72;font-weight:bold">.</span>filter(author<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#39;luenci&#39;</span>)<span style="color:#ff7b72;font-weight:bold">.</span>values(<span style="color:#a5d6ff">&#39;name&#39;</span>, <span style="color:#a5d6ff">&#39;price&#39;</span>) 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 查询作者为luenci出版的书名.（列表的集合）</span>
</span></span><span style="display:flex;"><span>book_list2 <span style="color:#ff7b72;font-weight:bold">=</span> Book<span style="color:#ff7b72;font-weight:bold">.</span>objects<span style="color:#ff7b72;font-weight:bold">.</span>filter(author<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#39;luenci&#39;</span>)<span style="color:#ff7b72;font-weight:bold">.</span>values_list(<span style="color:#a5d6ff">&#39;name&#39;</span>, <span style="color:#a5d6ff">&#39;price&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># &lt;QuerySet [{&#39;name&#39;: &#39;go基础&#39;, &#39;price&#39;: 99.0}, {&#39;name&#39;: &#39;python基础&#39;, &#39;price&#39;: 99.0}, {&#39;name&#39;: &#39;python基础&#39;, &#39;price&#39;: 66.0}&gt;</span>
</span></span><span style="display:flex;"><span>print(book_list1) 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">#&lt;QuerySet [(&#39;go基础&#39;, 99.0), (&#39;python基础&#39;, 99.0), (&#39;python基础&#39;, 66.0), (&#39;docker基础&#39;, 8.9)]&gt;</span>
</span></span><span style="display:flex;"><span>print(book_list2)
</span></span></code></pre></td></tr></table>
</div>
</div>]]></content:encoded>
    </item>
    <item>
      <title>Django的ORM多表操作</title>
      <link>https://Lucareful.github.io/en/posts/django%E7%9A%84orm%E5%A4%9A%E8%A1%A8%E6%93%8D%E4%BD%9C/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://Lucareful.github.io/en/posts/django%E7%9A%84orm%E5%A4%9A%E8%A1%A8%E6%93%8D%E4%BD%9C/</guid>
      <description>ORM多表操作 API 函数 说明 all() 查询所有结果 filter(**kwargs) 包含了与所给筛选条件相匹配的对象 get(**kwargs) 返回与所给筛选条件相匹配的对象，返回结果有且只有一个， 如果符合筛选</description>
      <content:encoded><![CDATA[<h1 id="orm多表操作">ORM多表操作</h1>
<h2 id="api">API</h2>
<table>
<thead>
<tr>
<th>函数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>all()</td>
<td>查询所有结果</td>
</tr>
<tr>
<td>filter(**kwargs)</td>
<td>包含了与所给筛选条件相匹配的对象</td>
</tr>
<tr>
<td>get(**kwargs)</td>
<td>返回与所给筛选条件相匹配的对象，返回结果有且只有一个， 如果符合筛选条件的对象超过一个或者没有都会抛出错误。</td>
</tr>
<tr>
<td>exclude(**kwargs)</td>
<td>它包含了与所给筛选条件不匹配的对象</td>
</tr>
<tr>
<td>order_by(*field)</td>
<td>对查询结果排序 用法:order_by (&ldquo;price&rdquo;)  <code>DESC</code> 降序</td>
</tr>
<tr>
<td>reverse():</td>
<td>对查询结果反向排序</td>
</tr>
<tr>
<td>count()</td>
<td>返回数据库中匹配查询(<code>QuerySet</code>)的对象数量</td>
</tr>
<tr>
<td>first()</td>
<td>返回第一条记录</td>
</tr>
<tr>
<td>last()</td>
<td>返回最后一条记录</td>
</tr>
<tr>
<td>exists()</td>
<td>如果<code>QuerySet</code>包含数据，就返回<code>True</code>，否则返回<code>False</code> 相当于<code>limit 1</code>(用途查询这个表中是否有值)</td>
</tr>
<tr>
<td>values(*field)</td>
<td>用法:<code>Book.objects.all.values(‘title’,‘price’)</code> 返回值是<code>&lt;queryset[{‘title’:‘aa’,‘pirce’:12},{}]</code></td>
</tr>
<tr>
<td>values_list(*field):</td>
<td>用法:<code>Book.objects.all.values_list(‘title’,‘price’)</code> 返回值是<code>&lt;queryset[(‘aa’,12),(‘bb’,33)]</code></td>
</tr>
<tr>
<td>distinct()</td>
<td>从返回结果中剔除重复纪录 用法:<code>Book.objects.all.values(‘title’,‘price’).distinct()</code> 错误用法 <code>Book.objects.all.distinct()</code> 因为id不相同,其他相同,无法去重</td>
</tr>
</tbody>
</table>
<h2 id="模糊查询">模糊查询</h2>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmd" data-lang="cmd"><span style="display:flex;"><span>__exact 	精确等于 like ‘aaa’
</span></span><span style="display:flex;"><span>__iexact 	精确等于 忽略大小写 ilike ‘aaa’
</span></span><span style="display:flex;"><span>__contains  是否包含 like ‘<span style="color:#79c0ff">%aaa%</span>’
</span></span><span style="display:flex;"><span>__icontains 包含 忽略大小写 ilike ‘<span style="color:#79c0ff">%aaa%</span>’，但是对于sqlite来说，contains的作用效果等同于icontains。
</span></span><span style="display:flex;"><span>__gt 		大于
</span></span><span style="display:flex;"><span>__gte 		大于等于
</span></span><span style="display:flex;"><span>__lt 		小于
</span></span><span style="display:flex;"><span>__lte 		小于等于
</span></span><span style="display:flex;"><span>__in 		存在于一个list范围内
</span></span><span style="display:flex;"><span>__startswith 以…开头
</span></span><span style="display:flex;"><span>__istartswith 以…开头 忽略大小写
</span></span><span style="display:flex;"><span>__endswith  以…结尾
</span></span><span style="display:flex;"><span>__iendswith 以…结尾，忽略大小写
</span></span><span style="display:flex;"><span>__range 	在…范围内
</span></span><span style="display:flex;"><span>__year 		日期字段的年份
</span></span><span style="display:flex;"><span>__month 	日期字段的月份
</span></span><span style="display:flex;"><span>__day 		日期字段的日
</span></span><span style="display:flex;"><span>__isnull=True/False
</span></span><span style="display:flex;"><span>__isnull=True 与 __exact=None的区别
</span></span></code></pre></td></tr></table>
</div>
</div><!-- more -->
<h2 id="外键的定义">外键的定义</h2>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># modeld.py</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">class</span> <span style="color:#f0883e;font-weight:bold">Book</span>(models<span style="color:#ff7b72;font-weight:bold">.</span>Model):
</span></span><span style="display:flex;"><span>    name <span style="color:#ff7b72;font-weight:bold">=</span> models<span style="color:#ff7b72;font-weight:bold">.</span>CharField(max_length<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">20</span>)
</span></span><span style="display:flex;"><span>    price <span style="color:#ff7b72;font-weight:bold">=</span> models<span style="color:#ff7b72;font-weight:bold">.</span>FloatField()
</span></span><span style="display:flex;"><span>    pub_date <span style="color:#ff7b72;font-weight:bold">=</span> models<span style="color:#ff7b72;font-weight:bold">.</span>DateField()
</span></span><span style="display:flex;"><span>    publish <span style="color:#ff7b72;font-weight:bold">=</span> models<span style="color:#ff7b72;font-weight:bold">.</span>ForeignKey(<span style="color:#a5d6ff">&#34;Publish&#34;</span>,on_delete<span style="color:#ff7b72;font-weight:bold">=</span>models<span style="color:#ff7b72;font-weight:bold">.</span>CASCADE)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">class</span> <span style="color:#f0883e;font-weight:bold">Publish</span>(models<span style="color:#ff7b72;font-weight:bold">.</span>Model):
</span></span><span style="display:flex;"><span>    name <span style="color:#ff7b72;font-weight:bold">=</span> models<span style="color:#ff7b72;font-weight:bold">.</span>CharField(max_length<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">32</span>)
</span></span><span style="display:flex;"><span>    city <span style="color:#ff7b72;font-weight:bold">=</span> models<span style="color:#ff7b72;font-weight:bold">.</span>CharField(max_length<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">32</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="on_delete的参数"><code>on_delete</code>的参数</h3>
<ul>
<li><code>CASCADE</code>:这就是默认的选项，级联删除，你无需显性指定它。</li>
<li><code>PROTECT</code>: 保护模式，如果采用该选项，删除的时候，会抛出<code>ProtectedError</code>错误。</li>
<li><code>SET_NULL</code>: 置空模式，删除的时候，外键字段被设置为空，前提就是<code>blank=True</code>, <code>null=True</code>,定义该字段的时候，允许为空。</li>
<li><code>SET_DEFAULT</code>: 置默认值，删除的时候，外键字段设置为默认值，所以定义外键的时候注意加上一个默认值。</li>
<li><code>SET()</code>: 自定义一个值，该值只能是对应的实体了</li>
<li><code>DO_NOTHING</code>:不采取行动。如果您的数据库后端强制执行参照完整性，会造成<code>IntegrityError</code>，除非您手动将SQL 约束<code>ON DELETE</code>添加到数据库字段。</li>
</ul>
<h2 id="一对多之对象查询">一对多之对象查询</h2>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">21
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 通过外键实现关联查询</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 一对多： book_obj ————————————》一定是一个对象</span>
</span></span><span style="display:flex;"><span>book_obj <span style="color:#ff7b72;font-weight:bold">=</span> Book<span style="color:#ff7b72;font-weight:bold">.</span>objects<span style="color:#ff7b72;font-weight:bold">.</span>get(name<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;python进阶&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(book_obj<span style="color:#ff7b72;font-weight:bold">.</span>publish)
</span></span><span style="display:flex;"><span>print(book_obj<span style="color:#ff7b72;font-weight:bold">.</span>publish<span style="color:#ff7b72;font-weight:bold">.</span>name)
</span></span><span style="display:flex;"><span>print(book_obj<span style="color:#ff7b72;font-weight:bold">.</span>publish<span style="color:#ff7b72;font-weight:bold">.</span>city)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 查询出版社出版的所有书籍和价格</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 方法一</span>
</span></span><span style="display:flex;"><span>pub_obj <span style="color:#ff7b72;font-weight:bold">=</span> Publish<span style="color:#ff7b72;font-weight:bold">.</span>objects<span style="color:#ff7b72;font-weight:bold">.</span>filter(name<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;人民出版社&#34;</span>)[<span style="color:#a5d6ff">0</span>]
</span></span><span style="display:flex;"><span>ret <span style="color:#ff7b72;font-weight:bold">=</span> Book<span style="color:#ff7b72;font-weight:bold">.</span>objects<span style="color:#ff7b72;font-weight:bold">.</span>filter(publish<span style="color:#ff7b72;font-weight:bold">=</span>pub_obj)<span style="color:#ff7b72;font-weight:bold">.</span>values(<span style="color:#a5d6ff">&#34;name&#34;</span>,<span style="color:#a5d6ff">&#34;price&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(ret) <span style="color:#8b949e;font-style:italic"># &lt;QuerySet [{&#39;name&#39;: &#39;linux运维&#39;, &#39;price&#39;: 77.0}]&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 方法二</span>
</span></span><span style="display:flex;"><span>pub_obj <span style="color:#ff7b72;font-weight:bold">=</span> Publish<span style="color:#ff7b72;font-weight:bold">.</span>objects<span style="color:#ff7b72;font-weight:bold">.</span>filter(name<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;机械出版社&#34;</span>)[<span style="color:#a5d6ff">0</span>]
</span></span><span style="display:flex;"><span>print(pub_obj<span style="color:#ff7b72;font-weight:bold">.</span>book_set<span style="color:#ff7b72;font-weight:bold">.</span>all())  <span style="color:#8b949e;font-style:italic"># &lt;QuerySet [&lt;Book: python进阶&gt;]&gt;</span>
</span></span><span style="display:flex;"><span>print(type(pub_obj<span style="color:#ff7b72;font-weight:bold">.</span>book_set<span style="color:#ff7b72;font-weight:bold">.</span>all()))  <span style="color:#8b949e;font-style:italic"># &lt;class &#39;django.db.models.query.QuerySet&#39;&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(pub_obj<span style="color:#ff7b72;font-weight:bold">.</span>book_set<span style="color:#ff7b72;font-weight:bold">.</span>all()<span style="color:#ff7b72;font-weight:bold">.</span>values(<span style="color:#a5d6ff">&#34;name&#34;</span>, <span style="color:#a5d6ff">&#34;price&#34;</span>))
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="多对多对象添加">多对多对象添加</h2>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 多对多添加信息</span>
</span></span><span style="display:flex;"><span>book_obj <span style="color:#ff7b72;font-weight:bold">=</span> Book<span style="color:#ff7b72;font-weight:bold">.</span>objects<span style="color:#ff7b72;font-weight:bold">.</span>get(id<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">2</span>)
</span></span><span style="display:flex;"><span>author_obj <span style="color:#ff7b72;font-weight:bold">=</span> Author<span style="color:#ff7b72;font-weight:bold">.</span>objects<span style="color:#ff7b72;font-weight:bold">.</span>get(id<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">1</span>)
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 添加关系</span>
</span></span><span style="display:flex;"><span>book_obj<span style="color:#ff7b72;font-weight:bold">.</span>author<span style="color:#ff7b72;font-weight:bold">.</span>add(author_obj)
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 删除关系</span>
</span></span><span style="display:flex;"><span>book_obj<span style="color:#ff7b72;font-weight:bold">.</span>author<span style="color:#ff7b72;font-weight:bold">.</span>remove(author_obj)
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="聚合查询与分组查询">聚合查询与分组查询</h2>
<h3 id="聚合查询">聚合查询:</h3>
<h4 id="aggregateargs-kwargs"><code>aggregate</code>(*args, **kwargs)</h4>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">#1.聚合  aggregate:返回值是一个字典</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">django.db.models</span> <span style="color:#ff7b72">import</span> Avg,Max,Min,Count
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">#问题:查询所有书籍的平均价格,最高价格,最低价格</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ret <span style="color:#ff7b72;font-weight:bold">=</span> Book<span style="color:#ff7b72;font-weight:bold">.</span>objects<span style="color:#ff7b72;font-weight:bold">.</span>all()<span style="color:#ff7b72;font-weight:bold">.</span>aggregate(avg_price<span style="color:#ff7b72;font-weight:bold">=</span>Avg(<span style="color:#a5d6ff">&#39;price&#39;</span>),max_price <span style="color:#ff7b72;font-weight:bold">=</span> Max(<span style="color:#a5d6ff">&#39;price&#39;</span>),min_price<span style="color:#ff7b72;font-weight:bold">=</span>Min(<span style="color:#a5d6ff">&#39;price&#39;</span>))
</span></span><span style="display:flex;"><span>print(ret)
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><code>aggregate()</code>是<code>QuerySet</code> 的一个终止子句，意思是说，它返回一个包含一些键值对的字典。键的名称是聚合值的标识符，值是计算出来的聚合值。键的名称是按照字段和聚合函数的名称自动生成出来的。如果你想要为聚合值指定一个名称，可以向聚合子句提供它。</li>
</ul>
<h2 id="分组查询">分组查询</h2>
<h3 id="annotateargs-kwargs">annotate(*args, **kwargs)</h3>
<ul>
<li>表单模型.objects.values(&ldquo;group by 分组字段&rdquo;).annotate(聚合函数(&lsquo;聚合字段&rsquo;))</li>
</ul>
<h2 id="f查询">F查询</h2>
<ul>
<li>Django 支持 F() 对象之间以及 F() 对象和常数之间的加减乘除和取模的操作。</li>
</ul>
<h2 id="q查询">Q查询</h2>
<ul>
<li>filter() 等方法中的关键字参数查询都是一起进行“AND” 的。 如果你需要执行更复杂的查询（例如OR语句），你可以使用Q对象</li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>Django的ORM字段介绍</title>
      <link>https://Lucareful.github.io/en/posts/django%E7%9A%84field%E8%AF%A6%E8%A7%A3/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://Lucareful.github.io/en/posts/django%E7%9A%84field%E8%AF%A6%E8%A7%A3/</guid>
      <description>Django的Field详解（转载） 本文转载于：https://www.cnblogs.com/ellisonzhang/p/1067905</description>
      <content:encoded><![CDATA[<h1 id="django的field详解转载">Django的Field详解（转载）</h1>
<blockquote>
<p>本文转载于：https://www.cnblogs.com/ellisonzhang/p/10679054.html</p>
</blockquote>
<h2 id="字段">字段</h2>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">42
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#a5d6ff">1</span><span style="color:#f85149">、</span>models<span style="color:#ff7b72;font-weight:bold">.</span>AutoField　　自增列 <span style="color:#ff7b72;font-weight:bold">=</span> int(<span style="color:#a5d6ff">11</span>)
</span></span><span style="display:flex;"><span>　　如果没有的话<span style="color:#f85149">，</span>默认会生成一个名称为 id 的列<span style="color:#f85149">，</span>如果要显示的自定义一个自增列<span style="color:#f85149">，</span>必须将给列设置为主键 primary_key<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#79c0ff">True</span><span style="color:#f85149">。</span>
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">2</span><span style="color:#f85149">、</span>models<span style="color:#ff7b72;font-weight:bold">.</span>CharField　　字符串字段
</span></span><span style="display:flex;"><span>　　必须 max_length 参数
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">3</span><span style="color:#f85149">、</span>models<span style="color:#ff7b72;font-weight:bold">.</span>BooleanField　　布尔类型<span style="color:#ff7b72;font-weight:bold">=</span>tinyint(<span style="color:#a5d6ff">1</span>)
</span></span><span style="display:flex;"><span>　　不能为空<span style="color:#f85149">，</span>Blank<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#79c0ff">True</span>
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">4</span><span style="color:#f85149">、</span>models<span style="color:#ff7b72;font-weight:bold">.</span>ComaSeparatedIntegerField　　用逗号分割的数字<span style="color:#ff7b72;font-weight:bold">=</span>varchar
</span></span><span style="display:flex;"><span>　　继承CharField<span style="color:#f85149">，</span>所以必须 max_lenght 参数
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">5</span><span style="color:#f85149">、</span>models<span style="color:#ff7b72;font-weight:bold">.</span>DateField　　日期类型 date
</span></span><span style="display:flex;"><span>　　对于参数<span style="color:#f85149">，</span>auto_now <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#79c0ff">True</span> 则每次更新都会更新这个时间<span style="color:#f85149">；</span>auto_now_add 则只是第一次创建添加<span style="color:#f85149">，</span>之后的更新不再改变<span style="color:#f85149">。</span>
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">6</span><span style="color:#f85149">、</span>models<span style="color:#ff7b72;font-weight:bold">.</span>DateTimeField　　日期类型 datetime
</span></span><span style="display:flex;"><span>　　同DateField的参数
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">7</span><span style="color:#f85149">、</span>models<span style="color:#ff7b72;font-weight:bold">.</span>Decimal　　十进制小数类型 <span style="color:#ff7b72;font-weight:bold">=</span> decimal
</span></span><span style="display:flex;"><span>　　必须指定整数位max_digits和小数位decimal_places
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">8</span><span style="color:#f85149">、</span>models<span style="color:#ff7b72;font-weight:bold">.</span>EmailField　　字符串类型<span style="color:#f85149">（</span>正则表达式邮箱<span style="color:#f85149">）</span> <span style="color:#ff7b72;font-weight:bold">=</span>varchar
</span></span><span style="display:flex;"><span>　　对字符串进行正则表达式
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">9</span><span style="color:#f85149">、</span>models<span style="color:#ff7b72;font-weight:bold">.</span>FloatField　　浮点类型 <span style="color:#ff7b72;font-weight:bold">=</span> double
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">10</span><span style="color:#f85149">、</span>models<span style="color:#ff7b72;font-weight:bold">.</span>IntegerField　　整形
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">11</span><span style="color:#f85149">、</span>models<span style="color:#ff7b72;font-weight:bold">.</span>BigIntegerField　　长整形
</span></span><span style="display:flex;"><span>　　integer_field_ranges <span style="color:#ff7b72;font-weight:bold">=</span> {
</span></span><span style="display:flex;"><span>　　　　<span style="color:#a5d6ff">&#39;SmallIntegerField&#39;</span>: (<span style="color:#ff7b72;font-weight:bold">-</span><span style="color:#a5d6ff">32768</span>, <span style="color:#a5d6ff">32767</span>),
</span></span><span style="display:flex;"><span>　　　　<span style="color:#a5d6ff">&#39;IntegerField&#39;</span>: (<span style="color:#ff7b72;font-weight:bold">-</span><span style="color:#a5d6ff">2147483648</span>, <span style="color:#a5d6ff">2147483647</span>),
</span></span><span style="display:flex;"><span>　　　　<span style="color:#a5d6ff">&#39;BigIntegerField&#39;</span>: (<span style="color:#ff7b72;font-weight:bold">-</span><span style="color:#a5d6ff">9223372036854775808</span>, <span style="color:#a5d6ff">9223372036854775807</span>),
</span></span><span style="display:flex;"><span>　　　　<span style="color:#a5d6ff">&#39;PositiveSmallIntegerField&#39;</span>: (<span style="color:#a5d6ff">0</span>, <span style="color:#a5d6ff">32767</span>),
</span></span><span style="display:flex;"><span>　　　　<span style="color:#a5d6ff">&#39;PositiveIntegerField&#39;</span>: (<span style="color:#a5d6ff">0</span>, <span style="color:#a5d6ff">2147483647</span>),
</span></span><span style="display:flex;"><span>　　}
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">12</span><span style="color:#f85149">、</span>models<span style="color:#ff7b72;font-weight:bold">.</span>IPAddressField　　字符串类型<span style="color:#f85149">（</span>ip4正则表达式<span style="color:#f85149">）</span>
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">13</span><span style="color:#f85149">、</span>models<span style="color:#ff7b72;font-weight:bold">.</span>GenericIPAddressField　　字符串类型<span style="color:#f85149">（</span>ip4和ip6是可选的<span style="color:#f85149">）</span>
</span></span><span style="display:flex;"><span>　　参数protocol可以是<span style="color:#f85149">：</span>both<span style="color:#f85149">、</span>ipv4<span style="color:#f85149">、</span>ipv6
</span></span><span style="display:flex;"><span>　　验证时<span style="color:#f85149">，</span>会根据设置报错
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">14</span><span style="color:#f85149">、</span>models<span style="color:#ff7b72;font-weight:bold">.</span>NullBooleanField　　允许为空的布尔类型
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">15</span><span style="color:#f85149">、</span>models<span style="color:#ff7b72;font-weight:bold">.</span>PositiveIntegerFiel　　正Integer
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">16</span><span style="color:#f85149">、</span>models<span style="color:#ff7b72;font-weight:bold">.</span>PositiveSmallIntegerField　　正smallInteger
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">17</span><span style="color:#f85149">、</span>models<span style="color:#ff7b72;font-weight:bold">.</span>SlugField　　减号<span style="color:#f85149">、</span>下划线<span style="color:#f85149">、</span>字母<span style="color:#f85149">、</span>数字
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">18</span><span style="color:#f85149">、</span>models<span style="color:#ff7b72;font-weight:bold">.</span>SmallIntegerField　　数字
</span></span><span style="display:flex;"><span>　　数据库中的字段有<span style="color:#f85149">：</span>tinyint<span style="color:#f85149">、</span>smallint<span style="color:#f85149">、</span>int<span style="color:#f85149">、</span>bigint
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">19</span><span style="color:#f85149">、</span>models<span style="color:#ff7b72;font-weight:bold">.</span>TextField　　字符串<span style="color:#ff7b72;font-weight:bold">=</span>longtext
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">20</span><span style="color:#f85149">、</span>models<span style="color:#ff7b72;font-weight:bold">.</span>TimeField　　时间 HH:MM[:ss[<span style="color:#ff7b72;font-weight:bold">.</span>uuuuuu]]
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">21</span><span style="color:#f85149">、</span>models<span style="color:#ff7b72;font-weight:bold">.</span>URLField　　字符串<span style="color:#f85149">，</span>地址正则表达式
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">22</span><span style="color:#f85149">、</span>models<span style="color:#ff7b72;font-weight:bold">.</span>BinaryField　　二进制
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">23</span><span style="color:#f85149">、</span>models<span style="color:#ff7b72;font-weight:bold">.</span>ImageField   图片
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">24</span><span style="color:#f85149">、</span>models<span style="color:#ff7b72;font-weight:bold">.</span>FilePathField 文件
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="参数">参数</h2>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">24
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmd" data-lang="cmd"><span style="display:flex;"><span>1、null=True
</span></span><span style="display:flex;"><span>　　数据库中字段是否可以为空
</span></span><span style="display:flex;"><span>2、blank=True
</span></span><span style="display:flex;"><span>　　django的 Admin 中添加数据时是否可允许空值
</span></span><span style="display:flex;"><span>3、primary_key = False
</span></span><span style="display:flex;"><span>　　主键，对AutoField设置主键后，就会代替原来的自增 id 列
</span></span><span style="display:flex;"><span>4、auto_now 和 auto_now_add
</span></span><span style="display:flex;"><span>　　auto_now   自动创建---无论添加或修改，都是当前操作的时间
</span></span><span style="display:flex;"><span>　　auto_now_add  自动创建---永远是创建时的时间
</span></span><span style="display:flex;"><span>5、choices
</span></span><span style="display:flex;"><span>    sex_choice=((“F”,“FEMAL”),(“M”,’Male’),)　　　　#admin专用下拉选项    
</span></span><span style="display:flex;"><span>    gender=models.CharFiled(max_length=2,choice=sex_choice)
</span></span><span style="display:flex;"><span>6、max_length
</span></span><span style="display:flex;"><span>7、default　　默认值
</span></span><span style="display:flex;"><span>8、verbose_name　　Admin中字段的显示名称
</span></span><span style="display:flex;"><span>9、name|db_column　　数据库中的字段名称
</span></span><span style="display:flex;"><span>10、unique=True　　不允许重复
</span></span><span style="display:flex;"><span>11、db_index = True　　数据库索引
</span></span><span style="display:flex;"><span>12、editable=True　　在Admin里是否可编辑
</span></span><span style="display:flex;"><span>13、error_messages=None　　错误提示
</span></span><span style="display:flex;"><span>14、auto_created=False　　自动创建
</span></span><span style="display:flex;"><span>15、help_text　　在Admin中提示帮助信息
</span></span><span style="display:flex;"><span>16、validators=[]
</span></span><span style="display:flex;"><span>17、upload-to
</span></span></code></pre></td></tr></table>
</div>
</div>]]></content:encoded>
    </item>
    <item>
      <title>Django简介</title>
      <link>https://Lucareful.github.io/en/posts/django%E9%85%8D%E7%BD%AE%E5%88%9D%E5%90%AF/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://Lucareful.github.io/en/posts/django%E9%85%8D%E7%BD%AE%E5%88%9D%E5%90%AF/</guid>
      <description>&lt;h1 id=&#34;django简介&#34;&gt;Django简介&lt;/h1&gt;
&lt;h2 id=&#34;背景&#34;&gt;背景&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;2003诞生 它最初是被开发来用于管理劳伦斯出版集团旗下的一些以新闻内容为主的网站的&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;mvt框架&#34;&gt;MVT（框架）&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Models 模型 数据库&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Views 视图 放和拿&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Template 模板 前端&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;From 表单 &lt;code&gt;django&lt;/code&gt; 会根据你后台数据库字段及表单层的设计对应的给你创建HTML关于表单的代码&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;django优点&#34;&gt;Django优点&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;对象关系映射（Object Relational Mapping ORM）：通过定义映射类来构建数据模型，将模型与关系型数据库连接起来，使用ORM框架内置的数据库接口可实现复杂的数据操作。（简单来说就是把数据库的语句换成了python可识别的语言）&lt;/li&gt;
&lt;li&gt;URL设计：开发者可以设计任意的URL（网站地址）， 而且支持使用正则表达式设计。&lt;/li&gt;
&lt;li&gt;模板系统：提供可扩展的模板语言，模板之间具有可继承性。&lt;/li&gt;
&lt;li&gt;表单处理：可以生成各种表单模型，而且表单具有有效性检验功能。&lt;/li&gt;
&lt;li&gt;Cache系统：完善的缓存系统，可支持多种缓存方式&lt;/li&gt;
&lt;li&gt;用户管理系统：提供用户认证，权限设置和用户组功能，功能扩展性强。&lt;/li&gt;
&lt;li&gt;国际化：内置国际化系统，方便开发出多语言的网站。&lt;/li&gt;
&lt;li&gt;admin管理系统：内置admin管理系统，系统的扩展性强。&lt;/li&gt;
&lt;/ul&gt;</description>
      <content:encoded><![CDATA[<h1 id="django简介">Django简介</h1>
<h2 id="背景">背景</h2>
<ul>
<li>2003诞生 它最初是被开发来用于管理劳伦斯出版集团旗下的一些以新闻内容为主的网站的</li>
</ul>
<h2 id="mvt框架">MVT（框架）</h2>
<ul>
<li>
<p>Models 模型 数据库</p>
</li>
<li>
<p>Views 视图 放和拿</p>
</li>
<li>
<p>Template 模板 前端</p>
<ul>
<li>From 表单 <code>django</code> 会根据你后台数据库字段及表单层的设计对应的给你创建HTML关于表单的代码</li>
</ul>
</li>
</ul>
<h2 id="django优点">Django优点</h2>
<ul>
<li>对象关系映射（Object Relational Mapping ORM）：通过定义映射类来构建数据模型，将模型与关系型数据库连接起来，使用ORM框架内置的数据库接口可实现复杂的数据操作。（简单来说就是把数据库的语句换成了python可识别的语言）</li>
<li>URL设计：开发者可以设计任意的URL（网站地址）， 而且支持使用正则表达式设计。</li>
<li>模板系统：提供可扩展的模板语言，模板之间具有可继承性。</li>
<li>表单处理：可以生成各种表单模型，而且表单具有有效性检验功能。</li>
<li>Cache系统：完善的缓存系统，可支持多种缓存方式</li>
<li>用户管理系统：提供用户认证，权限设置和用户组功能，功能扩展性强。</li>
<li>国际化：内置国际化系统，方便开发出多语言的网站。</li>
<li>admin管理系统：内置admin管理系统，系统的扩展性强。</li>
</ul>
<h2 id="django项目目录">Django项目目录</h2>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>用django<span style="color:#ff7b72;font-weight:bold">-</span>admin startproject demo 创建一个demo项目
</span></span><span style="display:flex;"><span>文件结构如下<span style="color:#f85149">：</span>
</span></span><span style="display:flex;"><span>demo<span style="color:#ff7b72;font-weight:bold">/</span>				<span style="color:#8b949e;font-style:italic"># 最外层 这个是整个项目的容器文件夹，可以随意改名字</span>
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>    demo<span style="color:#ff7b72;font-weight:bold">/</span>			<span style="color:#8b949e;font-style:italic"># 内层的demo 是这个项目中关于配置文件的一个管理文件夹，这个不允许改名字</span>
</span></span><span style="display:flex;"><span>		
</span></span><span style="display:flex;"><span>        __init__<span style="color:#ff7b72;font-weight:bold">.</span>py	<span style="color:#8b949e;font-style:italic">#初始化文件，代表这个文件夹是一个包，一个模块，demo文件夹就是一个模块了</span>
</span></span><span style="display:flex;"><span>		
</span></span><span style="display:flex;"><span>        settings<span style="color:#ff7b72;font-weight:bold">.</span>py <span style="color:#8b949e;font-style:italic"># 这个是整个项目的配置文件，配置中间，配置邮件等</span>
</span></span><span style="display:flex;"><span>		
</span></span><span style="display:flex;"><span>        urls<span style="color:#ff7b72;font-weight:bold">.</span>py		<span style="color:#8b949e;font-style:italic"># django项目的总路由配置文件。网站的地址信息</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>		wsgi<span style="color:#ff7b72;font-weight:bold">.</span>py		<span style="color:#8b949e;font-style:italic"># 全称为Python Web Server Gateway Interface，即为python服务器网关接口，					   是python应用与Web服务器之间的接口，用于Django项目在服务器上的部署和上线，一 					   般不需要修改</span>
</span></span><span style="display:flex;"><span>	manage<span style="color:#ff7b72;font-weight:bold">.</span>py		<span style="color:#8b949e;font-style:italic"># 命令行工具，允许以多种方式与项目交互。 可输入 python manage.py help 查看					    该工具的具体用法 </span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="django的创建的app目录">Django的创建的App目录</h2>
<ul>
<li>
<p>使用命令创建app： python manage.py startapp frist</p>
<ul>
<li>
<p><strong>创建了App必须把App名称添加到<kbd>INSTALL_APPS</kbd>里面。</strong></p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>frist<span style="color:#ff7b72;font-weight:bold">/</span>
</span></span><span style="display:flex;"><span>	migrations<span style="color:#ff7b72;font-weight:bold">/</span>		<span style="color:#8b949e;font-style:italic"># 数据库前后是否有变化，生成出迁移文件</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	static<span style="color:#ff7b72;font-weight:bold">/</span>			<span style="color:#8b949e;font-style:italic"># 创建App后存放App中的静态资源文件，自己手动添加</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	templates<span style="color:#ff7b72;font-weight:bold">/</span>		<span style="color:#8b949e;font-style:italic"># 创建App后存放App中的模板文件，自己手动添加</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	__init__<span style="color:#ff7b72;font-weight:bold">.</span>py
</span></span><span style="display:flex;"><span>	admin<span style="color:#ff7b72;font-weight:bold">.</span>py
</span></span><span style="display:flex;"><span>	apps<span style="color:#ff7b72;font-weight:bold">.</span>py
</span></span><span style="display:flex;"><span>	models<span style="color:#ff7b72;font-weight:bold">.</span>py
</span></span><span style="display:flex;"><span>	tests<span style="color:#ff7b72;font-weight:bold">.</span>py
</span></span><span style="display:flex;"><span>	urls<span style="color:#ff7b72;font-weight:bold">.</span>py			<span style="color:#8b949e;font-style:italic"># 创建App后由系统总路由映射到App的路由文件，自己手动添加</span>
</span></span><span style="display:flex;"><span>	view<span style="color:#ff7b72;font-weight:bold">.</span>py
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
</ul>
<h2 id="djangosettings配置全览">Django（settings）配置全览</h2>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">122
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#a5d6ff">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">Django settings for mysite project.
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">Generated by &#39;django-admin startproject&#39; using Django 2.1.2.
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">For more information on this file, see
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">https://docs.djangoproject.com/en/2.1/weightics/settings/
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">For the full list of settings and their values, see
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">https://docs.djangoproject.com/en/2.1/ref/settings/
</span></span></span><span style="display:flex;"><span><span style="color:#a5d6ff">&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">import</span> <span style="color:#ff7b72">os</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 项目路径</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Build paths inside the project like this: os.path.join(BASE_DIR, ...)</span>
</span></span><span style="display:flex;"><span>BASE_DIR <span style="color:#ff7b72;font-weight:bold">=</span> os<span style="color:#ff7b72;font-weight:bold">.</span>path<span style="color:#ff7b72;font-weight:bold">.</span>dirname(os<span style="color:#ff7b72;font-weight:bold">.</span>path<span style="color:#ff7b72;font-weight:bold">.</span>dirname(os<span style="color:#ff7b72;font-weight:bold">.</span>path<span style="color:#ff7b72;font-weight:bold">.</span>abspath(__file__)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Quick-start development settings - unsuitable for production</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># See https://docs.djangoproject.com/en/2.1/howto/deployment/checklist/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 密匙配置</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># SECURITY WARNING: keep the secret key used in production secret!</span>
</span></span><span style="display:flex;"><span>SECRET_KEY <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#39;#g$qgqkee8csvp67l$(8ugkx</span><span style="color:#a5d6ff">%+i</span><span style="color:#a5d6ff">_9k%mbykw-%9zpbnyn!bb!=&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 调试模式</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># SECURITY WARNING: don&#39;t run with debug turned on in production!</span>
</span></span><span style="display:flex;"><span>DEBUG <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#79c0ff">True</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 域名访问权限</span>
</span></span><span style="display:flex;"><span>ALLOWED_HOSTS <span style="color:#ff7b72;font-weight:bold">=</span> [<span style="color:#a5d6ff">&#39;*&#39;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># App列表</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Application definition</span>
</span></span><span style="display:flex;"><span>INSTALLED_APPS <span style="color:#ff7b72;font-weight:bold">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#39;django.contrib.admin&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#39;django.contrib.auth&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#39;django.contrib.contenttypes&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#39;django.contrib.sessions&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#39;django.contrib.messages&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#39;django.contrib.staticfiles&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#39;myblog&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#39;article&#39;</span>,
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MIDDLEWARE <span style="color:#ff7b72;font-weight:bold">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#39;django.middleware.security.SecurityMiddleware&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#39;django.contrib.sessions.middleware.SessionMiddleware&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#39;django.middleware.common.CommonMiddleware&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#39;django.middleware.csrf.CsrfViewMiddleware&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#39;django.contrib.auth.middleware.AuthenticationMiddleware&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#39;django.contrib.messages.middleware.MessageMiddleware&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#39;django.middleware.clickjacking.XFrameOptionsMiddleware&#39;</span>,
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ROOT_URLCONF <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#39;mysite.urls&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>TEMPLATES <span style="color:#ff7b72;font-weight:bold">=</span> [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#39;BACKEND&#39;</span>: <span style="color:#a5d6ff">&#39;django.template.backends.django.DjangoTemplates&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#39;DIRS&#39;</span>: [BASE_DIR, <span style="color:#a5d6ff">&#39;templates&#39;</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#39;APP_DIRS&#39;</span>: <span style="color:#79c0ff">True</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#39;OPTIONS&#39;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#a5d6ff">&#39;context_processors&#39;</span>: [
</span></span><span style="display:flex;"><span>                <span style="color:#a5d6ff">&#39;django.template.context_processors.debug&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a5d6ff">&#39;django.template.context_processors.request&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a5d6ff">&#39;django.contrib.auth.context_processors.auth&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a5d6ff">&#39;django.contrib.messages.context_processors.messages&#39;</span>,
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#8b949e;font-style:italic"># 自定义模版全局变量(默认变量)</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a5d6ff">&#39;article.views.global_settings&#39;</span>,
</span></span><span style="display:flex;"><span>            ],
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>WSGI_APPLICATION <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#39;mysite.wsgi.application&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Database</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># https://docs.djangoproject.com/en/2.1/ref/settings/#databases</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>DATABASES <span style="color:#ff7b72;font-weight:bold">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#39;default&#39;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#39;ENGINE&#39;</span>: <span style="color:#a5d6ff">&#39;django.db.backends.sqlite3&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#39;NAME&#39;</span>: os<span style="color:#ff7b72;font-weight:bold">.</span>path<span style="color:#ff7b72;font-weight:bold">.</span>join(BASE_DIR, <span style="color:#a5d6ff">&#39;db.sqlite3&#39;</span>),
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Password validation</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># https://docs.djangoproject.com/en/2.1/ref/settings/#auth-password-validators</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>AUTH_PASSWORD_VALIDATORS <span style="color:#ff7b72;font-weight:bold">=</span> [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>     <span style="color:#a5d6ff">&#39;NAME&#39;</span>:<span style="color:#a5d6ff">&#39;django.contrib.auth.password_validation.UserAttributeSimilarityValidator&#39;</span>,
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#39;NAME&#39;</span>: <span style="color:#a5d6ff">&#39;django.contrib.auth.password_validation.MinimumLengthValidator&#39;</span>,
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#39;NAME&#39;</span>: <span style="color:#a5d6ff">&#39;django.contrib.auth.password_validation.CommonPasswordValidator&#39;</span>,
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#39;NAME&#39;</span>: <span style="color:#a5d6ff">&#39;django.contrib.auth.password_validation.NumericPasswordValidator&#39;</span>,
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Internationalization</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># https://docs.djangoproject.com/en/2.1/weightics/i18n/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>LANGUAGE_CODE <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#39;zh-Hans&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>TIME_ZONE <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#39;Asia/Shanghai&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>USE_I18N <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#79c0ff">True</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>USE_L10N <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#79c0ff">True</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>USE_TZ <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#79c0ff">True</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Static files (CSS, JavaScript, Images)</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># https://docs.djangoproject.com/en/2.1/howto/static-files/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>STATIC_URL <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#39;/static/&#39;</span>
</span></span><span style="display:flex;"><span>STATIC_ROOT <span style="color:#ff7b72;font-weight:bold">=</span> os<span style="color:#ff7b72;font-weight:bold">.</span>path<span style="color:#ff7b72;font-weight:bold">.</span>join(BASE_DIR, <span style="color:#a5d6ff">&#34;static/&#34;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>项目路径 BASE_DIR：主要通过<code>os</code>模块读取当前项目在系统的具体路径，该代码在创建项目时自动生成，一般情况无需修改</p>
<p>密匙配置SECRET_KEY：是一个随机值，在项目创建的时候自动生成，一般情况下无需修改。主要用于重要的数据		 加密处理，提高系统的安全性，避免遭到攻击者的恶意破坏。密匙主要用于用户密码，<code>CSRF</code>机制和会话<code>Session</code>等数据加密。</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">*</span> 用户密码<span style="color:#f85149">：</span>Django内置一套用户管理系统<span style="color:#f85149">，</span>该系统具有用户认证和存储用户信息等功能<span style="color:#f85149">，</span>在创建用户的时候<span style="color:#f85149">，</span>将用户的密码通过密匙进行加密处理<span style="color:#f85149">，</span>保证用户的安全性<span style="color:#f85149">。</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">*</span> CSRF机制<span style="color:#f85149">：</span>该机制主要用于表单提交<span style="color:#f85149">，</span>防止窃取网站的用户信息来制造恶意请求
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">*</span> 会话Session<span style="color:#f85149">：</span>Session的信息存放在Cookies<span style="color:#f85149">，</span>以一串随机的字符串表示<span style="color:#f85149">，</span>用于标识当前访问网站的用户身份<span style="color:#f85149">，</span>记录相关用户信息<span style="color:#f85149">。</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>调试模式DEBUG：该值为布尔类型。如果在开发调试阶段应设置为True，在开发调试过程中会自动检测代码是否 发生更改，根据检测结果执行是否刷新重启系统。如果项目部署上线，将其改为False，否则会泄露系统的相关信息。</p>
<p>域名访问权限ALLOWED_HOSTS:设置可访问的域名，默认值为空。当DEBUG为True并且ALLOWED_HOSTS为空时，项目只允许以<code>localhost</code>或<kbd>127.0.0.1</kbd>在浏览器上访问启动。当DEBUG为False时，ALLOWED_HOSTS为必填项，否则程序无法启动，如果想允许所有域名访问，可设置ALLOW_HOSTS=[&rsquo;*&rsquo;]。</p>
<p>App列表INSTALLED_APPS：告诉Django有哪些App。在创建项目时已有admin，auth，和session等配置等信息，这些都是Django内置的应用功能，各个功能说明如下。</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">*</span> admin:内置的后台管理系统<span style="color:#f85149">。</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">*</span> auth<span style="color:#f85149">：</span>内置的用户认证系统<span style="color:#f85149">。</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">*</span> contenttypes<span style="color:#f85149">：</span>记录项目中所有的model元数据<span style="color:#f85149">（</span>Django的ORM框架<span style="color:#f85149">）。</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">*</span> session<span style="color:#f85149">：</span>Session会话功能<span style="color:#f85149">，</span>用于标识当前访问网站的 用户身份<span style="color:#f85149">，</span>记录相关用户信息<span style="color:#f85149">。</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">*</span> message<span style="color:#f85149">：</span>消息提示功能<span style="color:#f85149">。</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">*</span> staticfiles<span style="color:#f85149">：</span>查找静态资源路径<span style="color:#f85149">。</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="静态资源static">静态资源（static）</h3>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Static files (CSS, JavaScript, Images)</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># https://docs.djangoproject.com/en/2.1/howto/static-files/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>STATIC_URL <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#39;/static/&#39;</span>	
</span></span><span style="display:flex;"><span>STATIC_ROOT <span style="color:#ff7b72;font-weight:bold">=</span> os<span style="color:#ff7b72;font-weight:bold">.</span>path<span style="color:#ff7b72;font-weight:bold">.</span>join(BASE_DIR, <span style="color:#a5d6ff">&#34;static/&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 设置根目录的静态资源文件夹static</span>
</span></span><span style="display:flex;"><span>STATICFILES_DIRS <span style="color:#ff7b72;font-weight:bold">=</span> [
</span></span><span style="display:flex;"><span>    				os<span style="color:#ff7b72;font-weight:bold">.</span>path<span style="color:#ff7b72;font-weight:bold">.</span>join(BASE_DIR, <span style="color:#a5d6ff">&#39;static&#39;</span>),
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 设置App的静态资源文件夹</span>
</span></span><span style="display:flex;"><span>    				os<span style="color:#ff7b72;font-weight:bold">.</span>path<span style="color:#ff7b72;font-weight:bold">.</span>join(BASE_DIR, <span style="color:#a5d6ff">&#39;/static&#39;</span>)<span style="color:#f85149">，</span>
</span></span><span style="display:flex;"><span>                   ]
</span></span></code></pre></td></tr></table>
</div>
</div><p>​</p>
<p>​	CSS也称层叠样式表（Cascading Style Sheets），是一种用来表现HTML（标准通用标记语言的一个应用）或XML（标准通用标记语言的一个子集）等文件样式的计算机语言。CSS不仅可以静态地修饰网页，还可以配合各种脚本语言动态地对网页各元素进行格式化。</p>
<p>​	JavaScript是一种直译式脚本语言，也是一种动态类型，弱类型，基于原型的语言，内置支持类型。它的解释器被称为JavaScript引擎，为浏览器的一部分，广泛用于客户端的脚本语言，最早是在HTML（标准通用标记语言下的一个应用）网页上使用，用来给HTML网页增加动态功能。</p>
<ul>
<li>
<p><kbd>STATIC_URL</kbd>是必须配置的属性而且属性值不能为空。如果没有配置<kbd>STATICFILES_DIRS</kbd>，则<kbd>STATIC_URL</kbd>只能识别App里的static静态资源文件夹。</p>
</li>
<li>
<p><kbd>STATICFILES_DIRS</kbd>是可选配置属性，属性值为列表或元组格式，每个列表（元组）元素代表一个静态资源文件夹，这些文件夹可行命名。</p>
</li>
<li>
<p>在浏览器上访问项目的静态资源时，无论项目的静态资源文件夹是如何命名的，在浏览器上，静态资源的上级目录必须为static，而static而<kbd>STATIC_URL</kbd>的属性值,因为<kbd>STATIC_URL</kbd>也是静态资源的起始URL。</p>
</li>
</ul>
<p>​    除此之外，静态资源配置还有<kbd>STATIC_ROOT</kbd>，其作用是方便在服务器上部署项目，实现服务器和项目之间的映射。</p>
<p><strong>STATIC_URL和STATICFILES_DIRS区别</strong></p>
<ul>
<li>STATIC_URL是必须配置的属性而且属性的值不能为空。如果没有配置STATICFILES_DIRS,则STATIC_URL只能识别App里面的static静态资源文件夹。</li>
<li>STATICFILES_DIRS是可选配置属性，属性值为列表或元组格式，每个列表（元组）元素代表一个静态资源文件夹，这些文件夹可自行命名。</li>
<li>在浏览器上访问项目的静态资源时，无论项目的静态资源文件夹是如何命名的，在浏览器上，静态资源的上级目录必须为static，而static是STATIC_URL的属性值，因为STATIC_URL也是静态资源的起始URL。</li>
</ul>
<h3 id="模板路径template">模板路径（template）</h3>
<ul>
<li>在web开发中，模板是一种较为特殊的HTML文档。这个HTML文档嵌入了一些能够让Python识别的变量和指令，然后程序解析这些变量和指令，生成完整的HTML网页并返回给用户浏览。模板是Django里面的MTV框架模式的<code>T</code>部分，配置模板路径是Django在解析模板时，如何找到模板所在的位置。创建项目时，Django以有初始的模板配置信息。如下：</li>
</ul>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>TEMPLATES <span style="color:#ff7b72;font-weight:bold">=</span> [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#39;BACKEND&#39;</span>: <span style="color:#a5d6ff">&#39;django.template.backends.django.DjangoTemplates&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#39;DIRS&#39;</span>: [BASE_DIR, <span style="color:#a5d6ff">&#39;templates&#39;</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#39;APP_DIRS&#39;</span>: <span style="color:#79c0ff">True</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#39;OPTIONS&#39;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#a5d6ff">&#39;context_processors&#39;</span>: [
</span></span><span style="display:flex;"><span>                <span style="color:#a5d6ff">&#39;django.template.context_processors.debug&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a5d6ff">&#39;django.template.context_processors.request&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a5d6ff">&#39;django.contrib.auth.context_processors.auth&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a5d6ff">&#39;django.contrib.messages.context_processors.messages&#39;</span>,
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#8b949e;font-style:italic"># 自定义模版全局变量(默认变量)</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a5d6ff">&#39;article.views.global_settings&#39;</span>,
</span></span><span style="display:flex;"><span>            ],
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>模板信息是以列表格式呈现的，每个元素具有不同的含义，说明如下：</p>
<ul>
<li>
<p>BACKEND：定义模板引擎，用于识别模板里面的变量和指令。内置的模板引擎有<code>DjangoTemplate</code>和<code>jinjia2.Jinjia2</code>，每个模板引擎都有自己的变量和指令语法。</p>
</li>
<li>
<p>DIRS：设置模板所在的路径，告诉Django在那个地方查找模板的位置，默认为空列表</p>
</li>
<li>
<p>APP_DIRS:是否在App里面查找模板文件</p>
</li>
<li>
<p>OPTIONS：用于填充在RequestContext中上下文调用函数，一般情况下不做任何修改。</p>
</li>
</ul>
</li>
</ul>
<h3 id="数据库设置databases">数据库设置（Databases）</h3>
<ul>
<li>
<p>在settings文件下 有一个DATABASES属性</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>DATABASES <span style="color:#ff7b72;font-weight:bold">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#39;default&#39;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#39;ENGINE&#39;</span>: <span style="color:#a5d6ff">&#39;django.db.backends.sqlite3&#39;</span>, 	  <span style="color:#8b949e;font-style:italic"># 数据库引擎</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#39;NAME&#39;</span>: os<span style="color:#ff7b72;font-weight:bold">.</span>path<span style="color:#ff7b72;font-weight:bold">.</span>join(BASE_DIR, <span style="color:#a5d6ff">&#39;db.sqlite3&#39;</span>), <span style="color:#8b949e;font-style:italic"># 本地sqllite3数据库位置</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#39;USER&#39;</span>: 									  <span style="color:#8b949e;font-style:italic"># 用户名</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#39;PASSWORD&#39;</span>: 								  <span style="color:#8b949e;font-style:italic"># 数据库密码</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#39;HOST&#39;</span>:										  <span style="color:#8b949e;font-style:italic"># 数据库主机地址</span>
</span></span><span style="display:flex;"><span>    			}
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">#	默认的django使用sqllite3作为数据库</span>
</span></span><span style="display:flex;"><span>	<span style="color:#8b949e;font-style:italic"># django提供四种 ENGINE 数据库引擎</span>
</span></span><span style="display:flex;"><span>    	<span style="color:#8b949e;font-style:italic">#	django.db.backends.mysql</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b949e;font-style:italic">#	django.db.backends.oracle</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b949e;font-style:italic">#	django.db.backends.splite3</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">#	如果你使用的是 PostgreSQL 或者Mysql的话，已经是先创建了数据库，但是默认的SQLlite不需要</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><code>sqlite3</code> 轻量级数据库（数据存放在文件里面）</p>
</li>
<li>
<p>在Django连接MYSQL数据库时候如果提示django.db.utils.OperationalError的错误信息，这是因为MYSQL8.0版本的密码加密方式发生了变化，8.0版本的用户密码采用的是cha2加密方法。</p>
<ul>
<li>
<p>解决方法，把SQL语句将8.0版本加密方法改回原来的加密方式。</p>
</li>
<li>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">#</span><span style="color:#6e7681"> </span>newpassword<span style="color:#6e7681"> </span><span style="color:#f85149">是我们设置的用户密码</span><span style="color:#6e7681">
</span></span></span><span style="display:flex;"><span><span style="color:#6e7681"></span><span style="color:#ff7b72">ALTER</span><span style="color:#6e7681"> </span><span style="color:#ff7b72">USER</span><span style="color:#6e7681"> </span><span style="color:#a5d6ff">&#39;root&#39;</span><span style="color:#ff7b72;font-weight:bold">@</span><span style="color:#a5d6ff">&#39;localhost&#39;</span><span style="color:#6e7681"> </span>IDENTIFIED<span style="color:#6e7681"> </span><span style="color:#ff7b72">WITH</span><span style="color:#6e7681"> </span>mysql_native_password<span style="color:#6e7681"> </span><span style="color:#ff7b72">BY</span><span style="color:#6e7681"> </span><span style="color:#a5d6ff">&#39;newpassword&#39;</span>;<span style="color:#6e7681">
</span></span></span><span style="display:flex;"><span><span style="color:#6e7681"></span>FLUSH<span style="color:#6e7681"> </span><span style="color:#ff7b72">PRIVILEGES</span>;<span style="color:#6e7681">
</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
</ul>
<h3 id="中间件middlewere">中间件（Middlewere）</h3>
<p>中间件（Middleware）是处理Django的request和response对象的钩子。当用户在网站中进行单击某个按钮等操作时，这个动作是用户向网站发送请求（request）；而网页会根据用户的操作返回相关的网页内容，这个过程称为响应处理（response）。从请求到响应的过程中，当Django接收到用户的请求时，Django首先经过中间件处理请求消息，执行相关的处理，然后将处理结果返回给用户，中间件的执行流程如图：</p>
<p><img loading="lazy" src="C:%5cUsers%5cLuenci%5cDeskweight%5cWeb%e7%ac%94%e8%ae%b0%5cDjango%5ctimg.jpg" alt="Alt"  />
</p>
<p>如上图，中间件的作用主要是处理用户的请求信息。开发者也可以根据自己的开发需求自定义中间件，只要将自定义的中间件添加到配置属性MIDDLEWARE中即可激活。一般情况下，Django默认的中间件配置均可满足大部分的开发需求。</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#39;django.middleware.security.SecurityMiddleware&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#39;django.contrib.sessions.middleware.SessionMiddleware&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#39;django.middleware.common.CommonMiddleware&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#39;django.middleware.csrf.CsrfViewMiddleware&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#39;django.contrib.auth.middleware.AuthenticationMiddleware&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#39;django.contrib.messages.middleware.MessageMiddleware&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a5d6ff">&#39;django.middleware.clickjacking.XFrameOptionsMiddleware&#39;</span>,
</span></span></code></pre></td></tr></table>
</div>
</div><p>配置属性MIDDLEWARE的数据格式为列表类型，每个中间件的设置顺序是固定的，如果随意变更中间件很容易导致程序异常，每个中间件的说明如下：</p>
<ul>
<li>SecurityMiddleware：内置的安全机制，保护用户与网站的通信安全。</li>
<li>SessionMiddleware：会话Session。</li>
<li>LocaleModdleware：支持中文语言。</li>
<li>CommonMiddleware：处理请求信息，规范化请求内容。</li>
<li>CsrViewMiddleware：开启CSRF防护功能。</li>
<li>AuthenticationMiddleware：开启内置的用户认证系统。</li>
<li>MessageMiddleware：开启内置的信息提示功能。</li>
<li>XFrameOptionsMiddleware：防止恶意程序点击劫持。</li>
</ul>
<h2 id="修改时区及语言">修改时区及语言</h2>
<ul>
<li>
<p>LANGUAGE_CODE = &rsquo;en-us&rsquo;  #语言</p>
</li>
<li>
<p>TIME_ZONE = &lsquo;UTC&rsquo; #时区</p>
</li>
</ul>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>LANGUAGE_CODE <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#39;zh-Hans&#39;</span>
</span></span><span style="display:flex;"><span>TIME_ZONE <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#39;Asia/Shanghai&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="开启测试服务器">开启测试服务器</h2>
<ul>
<li>用来展示你创建出来的空项目</li>
<li>/home/Publc_Class/5-17-django框架/</li>
<li>python3 manage.py runserver 0.0.0.0:9090
<ul>
<li>开启了一个测试服务器</li>
<li>runserver 可以让你在浏览器看到效果，但是这个是测试服务器，压力不过百</li>
</ul>
</li>
</ul>
<h2 id="创建默认数据库">创建默认数据库</h2>
<ul>
<li>
<p>因为django自带的admin界面，首先需要数据库来支持</p>
<ul>
<li>我们来先创建出一个数据库</li>
</ul>
</li>
</ul>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>makemigrations 数据库前后是否有变化，生成出迁移文件
</span></span><span style="display:flex;"><span>migrate 根据迁移文件 来对应的执行SQL语句 
</span></span><span style="display:flex;"><span>python3 manage.py makemigrations
</span></span><span style="display:flex;"><span>python3 manage.py migrate 
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>如果数据库创建完成，那么目录结构下和<code>manage.py</code>同级的就会有一个<code>db.splite3</code>文件</p>
</li>
<li>
<p>有了这个数据库，就可以创建超级用户来管理<code>admin</code>界面啦！</p>
</li>
</ul>
<p><strong>为<code>admin</code>界面创建超级用户</strong></p>
<ul>
<li>
<p>数据库有了，要创建超级用户</p>
<ul>
<li>python3 manage.py createsuperuser</li>
</ul>
</li>
</ul>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>Username (leave blank to use <span style="color:#a5d6ff">&#39;root&#39;</span>): root
</span></span><span style="display:flex;"><span>Email address: <span style="color:#a5d6ff">2573799357</span><span style="color:#d2a8ff;font-weight:bold">@qq.com</span>   
</span></span><span style="display:flex;"><span>Password: 
</span></span><span style="display:flex;"><span>Password (again): 
</span></span><span style="display:flex;"><span>Superuser created successfully<span style="color:#ff7b72;font-weight:bold">.</span>
</span></span></code></pre></td></tr></table>
</div>
</div>]]></content:encoded>
    </item>
    <item>
      <title>Django重定向指南（转载）</title>
      <link>https://Lucareful.github.io/en/posts/django-%E9%87%8D%E5%AE%9A%E5%90%91%E7%BB%88%E6%9E%81%E6%8C%87%E5%8D%97/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://Lucareful.github.io/en/posts/django-%E9%87%8D%E5%AE%9A%E5%90%91%E7%BB%88%E6%9E%81%E6%8C%87%E5%8D%97/</guid>
      <description>原文转载自：https://www.jianshu.com/p/5e322fb5b61c（简书：爱吃鱼de大猫） 当你使用 Django 框架构建 Python Web 应用程</description>
      <content:encoded><![CDATA[<blockquote>
<p>原文转载自：https://www.jianshu.com/p/5e322fb5b61c（简书：<a href="https://www.jianshu.com/u/a4b0307eac4d">爱吃鱼de大猫</a>）</p>
</blockquote>
<p>当你使用 Django 框架构建 Python Web 应用程序时，在某些时候需要将用户从一个URL重定向到另一个URL。本指南将提供 HTTP 重定向所需要了解的所有知识，以及在 Django 中该如何处理。</p>
<p>完成本教程，你将学到：</p>
<ul>
<li>能够将用户从一个URL重定向到另一个URL</li>
<li>了解临时重定向和永久重定向之间的区别</li>
<li>使用重定向时避免常见陷阱</li>
</ul>
<p>本教程假设你熟悉Django应用程序的基本构建块，如视图和URL模式。</p>
<h2 id="一个超简单的-django-重定向例子">一个超简单的 Django 重定向例子</h2>
<p>在 Django 中，通过从视图返回<code>HttpResponseRedirect</code>或<code>HttpResponsePermanentRedirect</code>的实例，可以将用户重定向到另一个URL。要做到这一点，最简单的方法是使用模块 <code>django.shortcuts</code> 中的函数 <code>redirect()</code>。比如：</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># views.py</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">django.shortcuts</span> <span style="color:#ff7b72">import</span> redirect
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">redirect_view</span>(request):
</span></span><span style="display:flex;"><span>    response <span style="color:#ff7b72;font-weight:bold">=</span> redirect(<span style="color:#a5d6ff">&#39;/redirect-success/&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">return</span> response
</span></span></code></pre></td></tr></table>
</div>
</div><p>只需在你的视图中将新的 URL 作为参数调用 redirect() 即可搞定。 该视图函数将返回一个 HttpResponseRedirect 类。</p>
<p>注意，如同其他视图一样，返回的重定向URL必须在你的 urls.py 中注册：</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># urls.py</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">django.urls</span> <span style="color:#ff7b72">import</span> path
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">.views</span> <span style="color:#ff7b72">import</span> redirect_view
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>urlpatterns <span style="color:#ff7b72;font-weight:bold">=</span> [
</span></span><span style="display:flex;"><span>    path(<span style="color:#a5d6ff">&#39;/redirect/&#39;</span>, redirect_view)
</span></span><span style="display:flex;"><span>    <span style="color:#8b949e;font-style:italic"># ... more URL patterns here</span>
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></td></tr></table>
</div>
</div><p>假定这个是 Django 项目的主 urls.py 文件，现在 URL<code>/redirect/</code> 将被重定向到 <code>/redirect-success/</code>。此外，为避免硬编码 URL，你可以用视图、URL 模式或者模型的名字来调用 redirect() 。通过传递关键字参数<code>Permanent=True</code>来创建永久重定向。</p>
<p>好了，你需要了解的 Django 重定向就这么多。为让这篇教程配得上“终极指南”这个标题，下面我们将进一步探讨 redirect() 函数、HTTP 状态码以及 <code>HttpRedirectResponse</code> 类型。我们从头开始，从一个基本的问题开始。</p>
<h2 id="为什么要使用重定向">为什么要使用重定向？</h2>
<p>我们为什么要将用户的访问重定向到不同的 URL 地址？我们看看 Django 项目是怎么回答的：</p>
<ul>
<li>当你未登录并请求需要身份验证的URL(如Django管理员)时，Django会将你重定向到登录页面</li>
<li>成功登录后，Django会将你重定向到最初请求的URL</li>
<li>当你使用Django管理员更改密码时，系统会将你重定向到指示更改成功的页面</li>
<li>当你在Django管理员中创建对象时，Django会将你重定向到对象列表。</li>
</ul>
<p>如果不使用重定向来实现会是什么样子？</p>
<p>如果用户必须登录才能查看页面，则可以简单地显示类似“单击此处登录”之类的页面。这样子做也行，但它是对用户不友好的。</p>
<p>另外，像 <a href="http://bit.ly/">http://bit.ly</a> 这样的短网址是重定向派上用场的另一个例子：你在浏览器的地址栏中键入一个短URL，然后被重定向到一个长而笨重的URL的页面。</p>
<p>此外，重定向不仅仅是为了方便。重定向是引导用户正确使用 Web 应用程序的基本工具。在用户进行带有副作用的操作(如创建或删除对象)后，最佳做法是重定向到另一个URL，以防止意外执行该操作两次。</p>
<p>下面的代码示例演示通常是如何处理表单的，一个用户在成功提交表单后会被重定向到另一个URL：</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">33
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">django</span> <span style="color:#ff7b72">import</span> forms
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">django.http</span> <span style="color:#ff7b72">import</span> HttpResponseRedirect
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">django.shortcuts</span> <span style="color:#ff7b72">import</span> redirect, render
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">send_message</span>(name, message):
</span></span><span style="display:flex;"><span>    <span style="color:#8b949e;font-style:italic"># Code for actually sending the message goes here</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">class</span> <span style="color:#f0883e;font-weight:bold">ContactForm</span>(forms<span style="color:#ff7b72;font-weight:bold">.</span>Form):
</span></span><span style="display:flex;"><span>    name <span style="color:#ff7b72;font-weight:bold">=</span> forms<span style="color:#ff7b72;font-weight:bold">.</span>CharField()
</span></span><span style="display:flex;"><span>    message <span style="color:#ff7b72;font-weight:bold">=</span> forms<span style="color:#ff7b72;font-weight:bold">.</span>CharField(widget<span style="color:#ff7b72;font-weight:bold">=</span>forms<span style="color:#ff7b72;font-weight:bold">.</span>Textarea)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">contact_view</span>(request):
</span></span><span style="display:flex;"><span>    <span style="color:#8b949e;font-style:italic"># The request method &#39;POST&#39; indicates</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b949e;font-style:italic"># that the form was submitted</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">if</span> request<span style="color:#ff7b72;font-weight:bold">.</span>method <span style="color:#ff7b72;font-weight:bold">==</span> <span style="color:#a5d6ff">&#39;POST&#39;</span>:  <span style="color:#8b949e;font-style:italic"># 1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b949e;font-style:italic"># Create a form instance with the submitted data</span>
</span></span><span style="display:flex;"><span>        form <span style="color:#ff7b72;font-weight:bold">=</span> ContactForm(request<span style="color:#ff7b72;font-weight:bold">.</span>POST)  <span style="color:#8b949e;font-style:italic"># 2</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b949e;font-style:italic"># Validate the form</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">if</span> form<span style="color:#ff7b72;font-weight:bold">.</span>is_valid():  <span style="color:#8b949e;font-style:italic"># 3</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b949e;font-style:italic"># If the form is valid, perform some kind of</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b949e;font-style:italic"># operation, for example sending a message</span>
</span></span><span style="display:flex;"><span>            send_message(
</span></span><span style="display:flex;"><span>                form<span style="color:#ff7b72;font-weight:bold">.</span>cleaned_data[<span style="color:#a5d6ff">&#39;name&#39;</span>],
</span></span><span style="display:flex;"><span>                form<span style="color:#ff7b72;font-weight:bold">.</span>cleaned_data[<span style="color:#a5d6ff">&#39;message&#39;</span>]
</span></span><span style="display:flex;"><span>            )
</span></span><span style="display:flex;"><span>            <span style="color:#8b949e;font-style:italic"># After the operation was successful,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b949e;font-style:italic"># redirect to some other page</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff7b72">return</span> redirect(<span style="color:#a5d6ff">&#39;/success/&#39;</span>)  <span style="color:#8b949e;font-style:italic"># 4</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">else</span>:  <span style="color:#8b949e;font-style:italic"># 5</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b949e;font-style:italic"># Create an empty form instance</span>
</span></span><span style="display:flex;"><span>        form <span style="color:#ff7b72;font-weight:bold">=</span> ContactForm()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">return</span> render(request, <span style="color:#a5d6ff">&#39;contact_form.html&#39;</span>, {<span style="color:#a5d6ff">&#39;form&#39;</span>: form})
</span></span></code></pre></td></tr></table>
</div>
</div><p>此视图的目的是用来处理和显示用户发送消息时的联系人表单。它有几个步骤：</p>
<ol>
<li>首先，视图查看请求方法。当用户访问连接到此视图的URL时，浏览器执行GET请求</li>
<li>如果使用POST请求调用视图，则POST发送的数据将用于实例化<code>ContactForm</code>对象</li>
<li>如果表单有效，则将表单数据传递给<code>send_message()</code>。此函数与此上下文无关，因此此处未显示</li>
<li>发送消息后，视图返回到URL<code>/SUCCESS/</code>的重定向。这是我们重点关注的一步。为简单起见，这里对URL进行了硬编码（后面讲如何避免这种情况）</li>
<li>如果视图接收到一个GET请求(或者确切地说，任何一种不是POST请求的请求)，它将创建一个<code>ContactForm</code>实例并使用<code>django.lowcuts.ender()</code>来呈现<code>Contact_form.html</code>模板</li>
<li>如果用户现在刷新页面，则只重新加载/SUCCESS/URL。如果没有重定向，重新加载页面将重新提交表单并发送另一条消息</li>
</ol>
<!-- more -->
<h2 id="幕后http重定向的工作原理">幕后：HTTP重定向的工作原理</h2>
<p>现在你知道为什么重定向有意义了，但是它们是如何工作的呢？让我们快速回顾一下，当你在Web浏览器的地址栏中输入URL时会发生什么。</p>
<h3 id="http-快速入门">HTTP 快速入门</h3>
<p>假设你已经创建了一个带“HelloWorld”视图的Django应用程序，该视图处理路径/hello/。如果使用django开发服务器运行应用程序，完整的 url 将是 http://127.0.0.1:8000/hello/ 。</p>
<p>当你在浏览器中输入该 URL 时，它将连接到IP地址为127.0.0.1的服务器的端口8000，并发送对路径 /hello/ 的 HTTP GET 请求。服务器返回 HTTP响应来回应。</p>
<p>HTTP 是基于文本的，因此查看客户端和服务器之间的前后通信比较容易。你可以使用命令行工具 curl 加上选项 -include 查看包括标头的完整HTTP响应，如下所示：</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ curl --include http://127.0.0.1:8000/hello/
</span></span><span style="display:flex;"><span>HTTP/1.1 <span style="color:#a5d6ff">200</span> OK
</span></span><span style="display:flex;"><span>Date: Sun, <span style="color:#a5d6ff">01</span> Jul <span style="color:#a5d6ff">2018</span> 20:32:55 GMT
</span></span><span style="display:flex;"><span>Server: WSGIServer/0.2 CPython/3.6.3
</span></span><span style="display:flex;"><span>Content-Type: text/html; <span style="color:#79c0ff">charset</span><span style="color:#ff7b72;font-weight:bold">=</span>utf-8
</span></span><span style="display:flex;"><span>X-Frame-Options: SAMEORIGIN
</span></span><span style="display:flex;"><span>Content-Length: <span style="color:#a5d6ff">11</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Hello World
</span></span></code></pre></td></tr></table>
</div>
</div><p>HTTP 响应第一行为包含状态代码和状态信息状态行。后面跟着任意数量的 HTTP 标头。空行表示标头的结尾和响应正文的开头，正文为服务器发回的实际数据。</p>
<h3 id="http-重定向状态码">HTTP 重定向状态码</h3>
<p>重定向的响应是怎么样的呢？为简单起见，我们假设路径 /redirect/ 是经由 redirect_view() 处理，如果你访问 http://127.0.0.1:8000/redirect/ ，使用 curl 工具的话，命令行提示信息应该类似这样：</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ curl --include http://127.0.0.1:8000/redirect/
</span></span><span style="display:flex;"><span>HTTP/1.1 <span style="color:#a5d6ff">302</span> Found
</span></span><span style="display:flex;"><span>Date: Sun, <span style="color:#a5d6ff">01</span> Jul <span style="color:#a5d6ff">2018</span> 20:35:34 GMT
</span></span><span style="display:flex;"><span>Server: WSGIServer/0.2 CPython/3.6.3
</span></span><span style="display:flex;"><span>Content-Type: text/html; <span style="color:#79c0ff">charset</span><span style="color:#ff7b72;font-weight:bold">=</span>utf-8
</span></span><span style="display:flex;"><span>Location: /redirect-success/
</span></span><span style="display:flex;"><span>X-Frame-Options: SAMEORIGIN
</span></span><span style="display:flex;"><span>Content-Length: <span style="color:#a5d6ff">0</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>响应跟前面的例子很类似，只有少许的差别，重定向的响应：</p>
<ul>
<li>返回不同的状态代码(302 VS 200)</li>
<li>包含具有相对URL的位置标头（Location: /redirect-success/）</li>
<li>以空行结尾，因为重定向响应的正文为空</li>
</ul>
<p>主要区别在于状态码。HTTP 规范具体规定如下：</p>
<blockquote>
<p>302(Found)状态代码指示目标资源暂时位于不同的URI下。由于有时可能会更改重定向，因此客户端应该继续为将来的请求使用有效的请求URI。服务器应在响应中生成一个位置标头字段，其中包含一个 URI 对不同 URI 的引用。客户端可以使用位置字段值进行自动重定向。<a href="https://tools.ietf.org/html/rfc7231#section-6.4">来源</a></p>
</blockquote>
<p>也就是说，当服务器返回一个 302 状态码，它的意思是告诉客户端：“嘿，此刻，您正在寻找的东西可以在另一个位置找到”。</p>
<p>规范中的一个关键短语是“可以使用位置字段值进行自动重定向”。这意味着您不能强制客户端加载另一个URL。客户端可以选择等待用户确认，也可以决定根本不加载URL。</p>
<p>现在你已经了解了，重定向只是一个带有3xx状态代码和位置标头的HTTP响应。关键点是，HTTP重定向类似于通常的HTTP响应，但具有空主体、3xx状态代码和位置标头。要理解的就这么多，下面我们回到 Django 中，首先了解3xx状态码中的两种重定向，并了解它们在 Web 开发中的重要性。</p>
<h3 id="临时与永久重定向">临时与永久重定向</h3>
<p>HTTP标准指定了多个重定向状态代码，所有代码都在3xx范围内。两个最常见的状态代码是 301（永久重定向）和 302（Found/发现）。</p>
<p>状态码302表示临时重定向。临时重定向是指：“此刻，你正在寻找的东西可以在另一个地址找到”。把它想象成一个商店的标志，上面写着：“我们的商店目前因装修而关闭。请到我们拐角处的另一家店”。由于这只是暂时的，所以下次购物时还是要检查原来的地址。</p>
<blockquote>
<p>注意：在 HTTP1.0 规范中，状态代码302的说明是临时重定向。HTTP 1.1中已更改为 Found 。</p>
</blockquote>
<p>顾名思义，永久重定向应该是永久的。永久重定向会告诉浏览器：“你要查找的内容不再位于此地址。它现在这个新地址上，再也不会在老地址上了”。永久重定向就像商店的标牌，上面写着“我们搬家了，我们的新店就在拐角处”。这个变化是永久性的，所以下次你想去商店的时候，你可以直接去新的地址。</p>
<blockquote>
<p>注意：永久重定向可能会产生一些意想不到的后果。在使用永久重定向之前请完成本指南，或者跳到“永久重定向是永久的”一节了解。</p>
</blockquote>
<p>浏览器在处理重定向时的行为大致差不多：当URL返回永久重定向响应时，此响应将被缓存。下一次浏览器遇到旧URL时，它会记住重定向并直接请求新地址。
缓存重定向可以节省不必要的请求，并提供更好、更快的用户体验。此外，临时重定向和永久重定向之间的区别会与搜索引擎优化相关。</p>
<h2 id="django-中的重定向">Django 中的重定向</h2>
<p>现在你知道了，重定向只是一个带有 3xx 状态代码和位置标头的 HTTP 响应。你完全可以手工从常规<code>HttpResponse</code>对象构建这样的响应：</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">hand_crafted_redirect_view</span>(request):
</span></span><span style="display:flex;"><span>  response <span style="color:#ff7b72;font-weight:bold">=</span> HttpResponse(status<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">302</span>)
</span></span><span style="display:flex;"><span>  response[<span style="color:#a5d6ff">&#39;Location&#39;</span>] <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#39;/redirect/success/&#39;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">return</span> response
</span></span></code></pre></td></tr></table>
</div>
</div><p>这个在技术上是可行的，但它涉及到相当多的输入。</p>
<h3 id="httpresponseredirect-类">HTTPResponseRedirect 类</h3>
<p>使用 HttpResponseRedirect 类可以帮助我们减少输入, 它是 HttpResponse 的一个子类。 你只需要把需要重定向的 URL 作为第一个参数生成实例，初始化时会正确地匹配状态码和报文地址头：</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">redirect_view</span>(request):
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">return</span> HttpResponseRedirect(<span style="color:#a5d6ff">&#39;/redirect/success/&#39;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>在命令行中使用 HttpResponseRedirect 类的演示：</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">&gt;&gt;&gt;</span> <span style="color:#ff7b72">from</span> <span style="color:#ff7b72">django.http</span> <span style="color:#ff7b72">import</span> HttpResponseRedirect
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">&gt;&gt;&gt;</span> redirect <span style="color:#ff7b72;font-weight:bold">=</span> HttpResponseRedirect(<span style="color:#a5d6ff">&#39;/redirect/success/&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">&gt;&gt;&gt;</span> redirect<span style="color:#ff7b72;font-weight:bold">.</span>status_code
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">302</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">&gt;&gt;&gt;</span> redirect[<span style="color:#a5d6ff">&#39;Location&#39;</span>]
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">&#39;/redirect/success/&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>还有一个用于永久重定向的类：HttpResponsePermanentRedirect 名字很直观。它的工作原理与 HttpResponseRedirect 相同，唯一的区别是它的状态代码为301(永久移动)。</p>
<blockquote>
<p>注意：在上面的示例中，重定向URL是硬编码的。对URL进行硬编码是一种不好的做法：如果URL发生了变化，你必须搜索所有的代码并改为正确的URL。下面我们来修复这个缺陷。</p>
</blockquote>
<p>我们可以使用 django.urls.reverse() 来构建URL，但是还有一种更方便的方法。</p>
<h3 id="redirect-函数">redirect() 函数</h3>
<p>为了使你的工作更轻松，Django提供了你在前面简介中已经看到的通用快捷函数: django.shortcuts.redirect()。</p>
<p>可以使用以下命令调用此函数：</p>
<ul>
<li>带有get_absolute_url()方法的模型实例或任何其他对象。</li>
<li>URL或视图名称以及位置和/或关键字参数。</li>
<li>URL</li>
</ul>
<p>它将采取适当的步骤将参数转换为URL并返回<code>HTTPResponseRedirect</code>。如果传递<code>Permanent=True</code>，它将返回<code>HttpResponsePermanentRedirect</code>的实例，从而导致永久重定向。</p>
<p>下面有三个示例来说明不同的用法：</p>
<ol>
<li>传入模型：</li>
</ol>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">django.shortcuts</span> <span style="color:#ff7b72">import</span> redirect
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">model_redirect_view</span>(request):
</span></span><span style="display:flex;"><span>    product <span style="color:#ff7b72;font-weight:bold">=</span> Product<span style="color:#ff7b72;font-weight:bold">.</span>objects<span style="color:#ff7b72;font-weight:bold">.</span>filter(featured<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#79c0ff">True</span>)<span style="color:#ff7b72;font-weight:bold">.</span>first()
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">return</span> redirect(product)
</span></span></code></pre></td></tr></table>
</div>
</div><p>redirect() 将调用 product.get_absolute_url() 并将结果用作重定向目标。如果给定的类(在本例中为Product)没有 get_absolute_url() 方法，则抛出 TypeError 异常。</p>
<ol>
<li>传入URL名称和参数：</li>
</ol>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">django.shortcuts</span> <span style="color:#ff7b72">import</span> redirect
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">fixed_featured_product_view</span>(request):
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span>    product_id <span style="color:#ff7b72;font-weight:bold">=</span> settings<span style="color:#ff7b72;font-weight:bold">.</span>FEATURED_PRODUCT_ID
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">return</span> redirect(<span style="color:#a5d6ff">&#39;product_detail&#39;</span>, product_id<span style="color:#ff7b72;font-weight:bold">=</span>product_id)
</span></span></code></pre></td></tr></table>
</div>
</div><p>redirect() 将尝试使用给定的参数来调换 URL。本例中假设你的 URL 模式中采用以下模式:</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>path(<span style="color:#a5d6ff">&#39;/product/&lt;product_id&gt;/&#39;</span>, <span style="color:#a5d6ff">&#39;product_detail_view&#39;</span>, name<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#39;product_detail&#39;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><ol>
<li>传入 URL:</li>
</ol>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">django.shortcuts</span> <span style="color:#ff7b72">import</span> redirect
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">featured_product_view</span>(request):
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">return</span> redirect(<span style="color:#a5d6ff">&#39;/products/42/&#39;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>redirect() 将处理任何包含<code>/</code>或<code>.</code>的字符串。作为URL并将其用作重定向目标。</p>
<h3 id="基于类的视图-redirectview-重定向">基于类的视图 RedirectView 重定向</h3>
<p>如果你的视图只返回一个重定向，那么可以使用基于类的视图<code>django.views.generic.base.RedirectView</code>。</p>
<p>你可以通过定制 RedirectView 各种属性来满足你的需要。</p>
<p>如果类具有<code>.url</code>属性，则它将用作重定向URL。字符串格式占位符将被替换为URL中的命名参数：</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># urls.py</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">django.urls</span> <span style="color:#ff7b72">import</span> path
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">.views</span> <span style="color:#ff7b72">import</span> SearchRedirectView
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>urlpatterns <span style="color:#ff7b72;font-weight:bold">=</span> [
</span></span><span style="display:flex;"><span>    path(<span style="color:#a5d6ff">&#39;/search/&lt;term&gt;/&#39;</span>, SearchRedirectView<span style="color:#ff7b72;font-weight:bold">.</span>as_view())
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># views.py</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">django.views.generic.base</span> <span style="color:#ff7b72">import</span> RedirectView
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">class</span> <span style="color:#f0883e;font-weight:bold">SearchRedirectView</span>(RedirectView):
</span></span><span style="display:flex;"><span>  url <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#39;https://google.com/?q=</span><span style="color:#a5d6ff">%(term)s</span><span style="color:#a5d6ff">&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>URL模式定义了一个参数，用于在<code>SearchRedirectView</code>中构建重定向URL。应用程序中的路径 <code>/search/kittens/</code> 将被重定向到 <code>https://google.com/?q=kittens</code>。</p>
<p>你还可以将关键字参数url传递给<code>urlPatterns</code>中的<code>as_view()</code>，而不需通过重写 <code>RedirectView</code> 子类的 url 属性来实现：</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">#urls.py</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">django.views.generic.base</span> <span style="color:#ff7b72">import</span> RedirectView
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>urlpatterns <span style="color:#ff7b72;font-weight:bold">=</span> [
</span></span><span style="display:flex;"><span>    path(<span style="color:#a5d6ff">&#39;/search/&lt;term&gt;/&#39;</span>,
</span></span><span style="display:flex;"><span>         RedirectView<span style="color:#ff7b72;font-weight:bold">.</span>as_view(url<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#39;https://google.com/?q=</span><span style="color:#a5d6ff">%(term)s</span><span style="color:#a5d6ff">&#39;</span>)),
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></td></tr></table>
</div>
</div><p>你同样可以通过重写 get_redirect_url() 来获得完全地自定义重定向行为：</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">random</span> <span style="color:#ff7b72">import</span> choice
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">django.views.generic.base</span> <span style="color:#ff7b72">import</span> RedirectView
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">class</span> <span style="color:#f0883e;font-weight:bold">RandomAnimalView</span>(RedirectView):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>     animal_urls <span style="color:#ff7b72;font-weight:bold">=</span> [<span style="color:#a5d6ff">&#39;/dog/&#39;</span>, <span style="color:#a5d6ff">&#39;/cat/&#39;</span>, <span style="color:#a5d6ff">&#39;/parrot/&#39;</span>]
</span></span><span style="display:flex;"><span>     is_permanent <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#79c0ff">True</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>     <span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">get_redirect_url</span>(<span style="color:#ff7b72;font-weight:bold">*</span>args, <span style="color:#ff7b72;font-weight:bold">**</span>kwargs):
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">return</span> choice(self<span style="color:#ff7b72;font-weight:bold">.</span>animal_urls)
</span></span></code></pre></td></tr></table>
</div>
</div><p>这个基于类的视图将重定向到从 .animal_urls 中随机选择的 URL。</p>
<p><code>django.views.generic.base.RedirectView</code> 为定制提供了更多的挂钩。以下是完整的列表：</p>
<ul>
<li>.url</li>
</ul>
<p>如果设置了此属性，则它应该是一个带有要重定向到的URL字符串。如果它包含像<code>%(name)s</code>这样的字符串格式占位符，它们将被传递给视图的关键字参数替代展开。</p>
<ul>
<li>.pattern_name</li>
</ul>
<p>如果设置了此属性，则它应该是要重定向到的URL模式的名称。传递给视图的任何位置参数和关键字参数都用于URL模式互换。</p>
<ul>
<li>.permanent</li>
</ul>
<p>如果此属性为 True，视图将返回永久重定向。默认情况下为 False。</p>
<ul>
<li>.query_string</li>
</ul>
<p>如果此属性为 True，则视图将任何提供的查询字符串附加到重定向URL。如果为false(默认值)，则废弃查询字符串。</p>
<ul>
<li>get_redirect_url(*args, **kwargs)</li>
</ul>
<p>此方法负责构建重定向URL。如果此方法不返回任何值，视图将返回 410 Gone 状态。</p>
<p>默认实现首先检查.url。它将.url视为“旧式”格式字符串，使用传递给视图的任何命名URL参数来展开任何命名格式说明符。如果未设置.url，则检查是否设置了.mode_name。如果是，它将使用它来互换它接收到的任何位置参数和关键字参数的URL。你可以通过覆盖此方法以任何方式更改该行为。只需确保它返回一个包含URL字符串。</p>
<blockquote>
<p>注意：基于类的视图是一个强大的概念，但是比较难理解它。与常规的基于函数的视图不同，在常规的基于函数的视图中，代码流程相对简单，而基于类的视图是由混合和基类组成的复杂层次结构组成的。</p>
</blockquote>
<p>要理解基于类的视图，一个很好的工具是基于类的网站视图。</p>
<p>通过这个简单的基于函数的视图，你可以实现从面的示例中<code>RandomAnimalView</code>的功能：</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">random</span> <span style="color:#ff7b72">import</span> choice
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">django.shortcuts</span> <span style="color:#ff7b72">import</span> redirect
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">random_animal_view</span>(request):
</span></span><span style="display:flex;"><span>    animal_urls <span style="color:#ff7b72;font-weight:bold">=</span> [<span style="color:#a5d6ff">&#39;/dog/&#39;</span>, <span style="color:#a5d6ff">&#39;/cat/&#39;</span>, <span style="color:#a5d6ff">&#39;/parrot/&#39;</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">return</span> redirect(choice(animal_urls))
</span></span></code></pre></td></tr></table>
</div>
</div><p>正如代码，基于类的方法在增加一些隐藏的复杂性的同时并没有提供任何明显的好处。这就提出了一个问题：什么时候应该使用<code>RedirectView</code>？</p>
<p>如果你想在<code>urls.py</code>中直接添加重定向，那么使用<code>RedirectView</code>是有意义的。但是，如果你发现自己正在重写get_redirect_url，那么基于函数的视图可能更容易理解，并且对于未来的功能扩展也更灵活。</p>
<h2 id="高级用法">高级用法</h2>
<p>一旦知道使用 django.shortcuts.redirect()，那么重定向到一个不同的URL就非常简单了。但是有几个高级用例并不那么明显。
通过重定向传递参数。
有时，你希望将一些参数传递给要重定向到的视图。最佳选择是在重定向URL的查询字符串中传递数据，这意味着重定向的URL类似于：<code>http://example.com/redirect-path/?parameter=value</code>
假设你希望从 some_view() 重定向到 product_view()，还要传递一个可选的参数：</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">django.urls</span> <span style="color:#ff7b72">import</span> reverse
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">urllib.parse</span> <span style="color:#ff7b72">import</span> urlencode
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">some_view</span>(request):
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span>    base_url <span style="color:#ff7b72;font-weight:bold">=</span> reverse(<span style="color:#a5d6ff">&#39;product_view&#39;</span>)  <span style="color:#8b949e;font-style:italic"># 1 /products/</span>
</span></span><span style="display:flex;"><span>    query_string <span style="color:#ff7b72;font-weight:bold">=</span>  urlencode({<span style="color:#a5d6ff">&#39;category&#39;</span>: category<span style="color:#ff7b72;font-weight:bold">.</span>id})  <span style="color:#8b949e;font-style:italic"># 2 category=42</span>
</span></span><span style="display:flex;"><span>    url <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#39;</span><span style="color:#a5d6ff">{}</span><span style="color:#a5d6ff">?</span><span style="color:#a5d6ff">{}</span><span style="color:#a5d6ff">&#39;</span><span style="color:#ff7b72;font-weight:bold">.</span>format(base_url, query_string)  <span style="color:#8b949e;font-style:italic"># 3 /products/?category=42</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">return</span> redirect(url)  <span style="color:#8b949e;font-style:italic"># 4</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">product_view</span>(request):
</span></span><span style="display:flex;"><span>    category_id <span style="color:#ff7b72;font-weight:bold">=</span> request<span style="color:#ff7b72;font-weight:bold">.</span>GET<span style="color:#ff7b72;font-weight:bold">.</span>get(<span style="color:#a5d6ff">&#39;category&#39;</span>)  <span style="color:#8b949e;font-style:italic"># 5</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b949e;font-style:italic"># Do something with category_id</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>这段代码有点多，我们分步来探讨：</p>
<ol>
<li>首先，使用 django.urls.verse() 获取到 product_view() 的URL映射。</li>
<li>接下来，你必须构建查询字符串。这是问号之后的部分。建议此时使用 urllib.urlparse.urlcode()，因为它正确处理任何特殊字符的编码。</li>
<li>现在使用问号将 base_ur l和 query_string 连接起来。格式字符串可以很好地实现这一点。</li>
<li>最后，将 url 传递给 django.shortcuts.redirect() 或某个重定向响应类。</li>
</ol>
<p>在重定向目标 product_view() 中，该参数将在<code>request.GET</code>字典中可用。而参数可能会丢失，因此应使用<code>requests.GET.get('category')</code>而不是<code>requests.GET['category']</code>。当参数不存在时，前者不返回任何值，而后者将引发异常。</p>
<blockquote>
<p>注意：请确保验证从查询字符串读取的任何数据。看起来这些数据是在你自己的控制之下，因为是你创建了重定向URL。</p>
</blockquote>
<p>实际上，重定向可以被用户操作，如同任何其他的用户输入那样不能被信任。如果没有正确的验证，攻击者可能会获得未经授权的访问。</p>
<h3 id="特殊重定向码">特殊重定向码</h3>
<p>Django 为状态代码 301 和 302 提供 HTTP 响应类。这些应该涵盖了大多数用例，但是如果你必须返回状态代码303、307或308，那么你可以很容易地创建自己的响应类。只需简单地继承 <code>HttpResponseRedirectBase</code> 并在子类中重写<code>STATUS_CODE</code>属性：</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff7b72">class</span> <span style="color:#f0883e;font-weight:bold">HttpResponseTemporaryRedirect</span>(HttpResponseRedirectBase):
</span></span><span style="display:flex;"><span>    status_code <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">307</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>或者，你可以使用 <code>django.shortcuts.redirect()</code> 方法来创建响应对象并更改返回值。当你有要重定向到的视图、URL或模型的名字时，此方法可行：</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">temporary_redirect_view</span>(request):
</span></span><span style="display:flex;"><span>    response <span style="color:#ff7b72;font-weight:bold">=</span> redirect(<span style="color:#a5d6ff">&#39;success_view&#39;</span>)
</span></span><span style="display:flex;"><span>    response<span style="color:#ff7b72;font-weight:bold">.</span>status_code <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">307</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">return</span> response
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>注意：实际上还有第三个类，它的状态代码在3xx范围内：<code>HttpResponseNotModified</code>，它的状态代码304。它指示URL的内容尚未更改，客户端可以使用缓存版本。</p>
</blockquote>
<blockquote>
<p>有人可能会说，304并未修改响应重定向到一个URL的缓存版本，但这有点牵强。因此，它不再列在 HTTP 标准的 “重定向3xx” 部分中。</p>
</blockquote>
<h2 id="陷阱">陷阱</h2>
<h3 id="重定向到并不会重定向的位置">重定向到并不会重定向的位置</h3>
<p>django.shortcuts.redirect() 的简单性可能具有欺骗性。函数本身不执行重定向：它只返回一个重定向响应对象。你必须从视图(或在中间件中)返回此响应对象。否则，不会产生重定向。</p>
<p>但是，即使你知道仅仅调用 redirect() 是不够的，也很容易进行简单的重构时将此错误引入工作的应用程序中。这里有一个例子来说明这一点。</p>
<p>假设我们正在构建一个商店，并且有一个负责显示产品的视图。如果产品不存在，则重定向到主页：</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">product_view</span>(request, product_id):
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">try</span>:
</span></span><span style="display:flex;"><span>        product <span style="color:#ff7b72;font-weight:bold">=</span> Product<span style="color:#ff7b72;font-weight:bold">.</span>objects<span style="color:#ff7b72;font-weight:bold">.</span>get(pk<span style="color:#ff7b72;font-weight:bold">=</span>product_id)
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">except</span> Product<span style="color:#ff7b72;font-weight:bold">.</span>DoesNotExist:
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">return</span> redirect(<span style="color:#a5d6ff">&#39;/&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">return</span> render(request, <span style="color:#a5d6ff">&#39;product_detail.html&#39;</span>, {<span style="color:#a5d6ff">&#39;product&#39;</span>: product})
</span></span></code></pre></td></tr></table>
</div>
</div><p>现在，你需要添加第二个视图来显示产品的客户评论。如果产品不存在它还应该重定向到主页，因此作为第一步，你可以将此功能从 product_view() 提取到辅助函数 get_product_or_redirect() 中：</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">get_product_or_redirect</span>(product_id):
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">try</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">return</span> Product<span style="color:#ff7b72;font-weight:bold">.</span>objects<span style="color:#ff7b72;font-weight:bold">.</span>get(pk<span style="color:#ff7b72;font-weight:bold">=</span>product_id)
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">except</span> Product<span style="color:#ff7b72;font-weight:bold">.</span>DoesNotExist:
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">return</span> redirect(<span style="color:#a5d6ff">&#39;/&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">product_view</span>(request, product_id):
</span></span><span style="display:flex;"><span>    product <span style="color:#ff7b72;font-weight:bold">=</span> get_product_or_redirect(product_id)
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">return</span> render(request, <span style="color:#a5d6ff">&#39;product_detail.html&#39;</span>, {<span style="color:#a5d6ff">&#39;product&#39;</span>: product})
</span></span></code></pre></td></tr></table>
</div>
</div><p>不幸的是，在重构之后，重定向不再起作用。
redirect() 的结果是从 get_product_or_redirect() 返回的，但 product_view() 不没有返回它。它将被传递给模板。根据在 product_detail.html模板中使用 product 变量的方式，这可能不会导致错误消息，而只是显示空值。</p>
<h3 id="重定向循环">重定向循环</h3>
<p>在处理重定向时，你可能会意外地创建一个重定向循环，方法是让URL A返回指向URL B的重定向，而URL B返回到URL A的重定向，以此类推。大多数HTTP客户端检测到这种重定向循环，并在多次请求后显示错误消息。</p>
<p>不幸的是，这种错误可能很难发现，因为服务器端的一切看起来都很好。除非你的用户抱怨此问题，否则唯一可能出现问题的迹象是，你收到了来自一个客户端的多个请求，这些请求都会导致快速连续的重定向响应，但没有一个状态为200 OK的响应。</p>
<p>以下是重定向循环的一个简单示例：</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">a_view</span>(request):
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">return</span> redirect(<span style="color:#a5d6ff">&#39;another_view&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">another_view</span>(request):
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">return</span> redirect(<span style="color:#a5d6ff">&#39;a_view&#39;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>这个例子说明了原理，但过于简单化了。在现实生活中遇到的重定向循环可能更难发现。让我们来看一个更详细的例子：</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">featured_products_view</span>(request):
</span></span><span style="display:flex;"><span>    featured_products <span style="color:#ff7b72;font-weight:bold">=</span> Product<span style="color:#ff7b72;font-weight:bold">.</span>objects<span style="color:#ff7b72;font-weight:bold">.</span>filter(featured<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#79c0ff">True</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">if</span> len(featured_products <span style="color:#ff7b72;font-weight:bold">==</span> <span style="color:#a5d6ff">1</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">return</span> redirect(<span style="color:#a5d6ff">&#39;product_view&#39;</span>, kwargs<span style="color:#ff7b72;font-weight:bold">=</span>{<span style="color:#a5d6ff">&#39;product_id&#39;</span>: featured_products[<span style="color:#a5d6ff">0</span>]<span style="color:#ff7b72;font-weight:bold">.</span>id})
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">return</span> render(request, <span style="color:#a5d6ff">&#39;featured_products.html&#39;</span>, {<span style="color:#a5d6ff">&#39;product&#39;</span>: featured_products})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">product_view</span>(request, product_id):
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">try</span>:
</span></span><span style="display:flex;"><span>        product <span style="color:#ff7b72;font-weight:bold">=</span> Product<span style="color:#ff7b72;font-weight:bold">.</span>objects<span style="color:#ff7b72;font-weight:bold">.</span>get(pk<span style="color:#ff7b72;font-weight:bold">=</span>product_id, in_stock<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#79c0ff">True</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">except</span> Product<span style="color:#ff7b72;font-weight:bold">.</span>DoesNotExist:
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">return</span> redirect(<span style="color:#a5d6ff">&#39;featured_products_view&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">return</span> render(request, <span style="color:#a5d6ff">&#39;product_detail.html&#39;</span>, {<span style="color:#a5d6ff">&#39;product&#39;</span>: product})
</span></span></code></pre></td></tr></table>
</div>
</div><p>featured_products_view() 获取所有特定的产品，也就是说，Product 实例的 .featured 属性被设置为True。如果只有一个特定产品存在，它将直接重定向到 product_view()。否则，它将用 featured_products 查询集渲染一个模板。</p>
<p>product_view 与上一节看起来很相似，但它有两个微小的区别：</p>
<ul>
<li>该视图试图获取一个库存产品，将<code>.in_stock</code>设置为<code>True</code>来指示该产品。</li>
<li>如果没有产品库存，视图将重定向到 featured_products_view()。</li>
</ul>
<p>这种逻辑工作的不错，直到你的商店成为自己成功的牺牲品，而你目前拥有的某种特色产品脱销为止。如果你将<code>.in_stock</code>设置为 False，但忘记将<code>.featured</code>也设置为False，那么任何访问 feature_product_view() 的访问者都将被困在重定向循环中。</p>
<p>没有防止此类错误的万全方法，一个好的起点是检查要重定向到的视图是否使用了重定向本身。</p>
<h3 id="永久重定向是永久的">永久重定向是永久的</h3>
<p>永久重定向可能类似于糟糕的纹身：在当时，它们可能看起来是个好主意，但一旦你意识到它们是一个错误，就很难摆脱它们。</p>
<p>当浏览器收到URL的永久重定向响应时，它会无限期地缓存此响应。你将来任何时候再请求旧的 URL，浏览器都不会再费事地加载它而是直接加载新URL。</p>
<p>指示浏览器重新加载曾经返回过永久重定向的URL可能会非常困难。Google Chrome在缓存重定向方面尤为激进。</p>
<p><strong>为什么这会成为个问题？</strong></p>
<p>假设你希望使用 Django 构建 Web 应用程序。你可以在 <a href="http://myawesomedjangowebapp.com/">myawesomedjangowebapp.com</a> 注册你的域名。作为第一步，你可以在https://myawesomedjangowebapp.com/blog/ 安装了一个博客应用程序，并构建了邮件列表。</p>
<p>你的站点 <a href="https://myawesomedjangowebapp.com/">https://myawesomedjangowebapp.com/</a> 的主页仍在建设中，因此你将主页重定向到 <a href="https://myawesomedjangowebapp.com/blog/">https://myawesomedjangowebapp.com/blog/</a> 。之所以决定使用永久重定向，是因为听说永久重定向是缓存的，缓存会让访问变得更快，因为速度是 Google 搜索结果排名的一个因素，所以速度越快越好。</p>
<p>结果，你不仅是一位优秀的开发人员，而且还是一位才华横溢的作家。你的博客变得流行起来，你创建的邮件列表也不断增长。几个月后，你的应用程序准备就绪。它现在有了一个闪亮的主页，你决定移除重定向。</p>
<p>你发送一封带有特殊折扣码的通知电子邮件到你已经相当大的运营邮件列表。你靠坐在电脑前，等待注册通知的滚动。</p>
<p>可怕的是，你邮箱里充满了困惑的访问者发来的信息，他们想要访问你的应用程序，但总是被重定向到你的博客。</p>
<p>什么情况？当你的博客读者访问 <a href="https://myawesomedjangowebapp.com/">https://myawesomedjangowebapp.com/</a> 时，重定向仍然处于活动状态，将会跳转到 <a href="https://myawesomedjangowebapp.com/blog/">https://myawesomedjangowebapp.com/blog/</a> 。因为这是一个永久的重定向，所以这个URL会缓存在他们的浏览器中。</p>
<p>当他们点击你发布公告邮件中的链接时，他们的浏览器不会查找你的新主页而会直接访问你的博客。此时你不是在庆祝你的项目成功启动，而是忙于指导你的用户如何通过 <a href="chrome://net-internals/">chrome://net-internals</a> 来重置其浏览器的缓存。</p>
<p>永久重定向的永久性质也会在本地计算机上开发时给你制造麻烦。让我们回到为 myawesomedjangowebapp.com 实现永久重定向的时刻。</p>
<p>你启动开发服务器并打开 http://127.0.0.1:8000/ 。如预期那样，应用程序将你的浏览器访问重定向到 http://127.0.0.1:8000/blog/ 。当你对项目感到满意后，你关闭开发服务器去吃个午饭。</p>
<p>当你吃饱回来，准备处理一些客户端的工作，需要对主页进行一些简单的更改，因此你启动开发服务器，打开客户端，但是异常情况发生了。这是怎么回事？主页被破坏了，它现在返回404！忙碌一下午，你过了一段时间才注意到你正被重定向到项目中已经不存在的 http://127.0.0.1:8000/blog/ 。对于浏览器来说，URL http://127.0.0.1:8000/ 现在是否服务于一个完全不同的应用程序并不重要。最重要的是这个 URL 曾经返回到http://127.0.0.1:8000/blog/ 的永久重定向。</p>
<p>从这个故事的启示是，你计划今后不再打算再次使用的网址才安排永久重定向。永久重定向的地方，你必须意识到它们的后果。即使你确信你确实需要永久重定向，最好还是先实现临时重定向，并且只有在你100%确定一切正常工作后才切换到永久重定向。</p>
<h3 id="未经验证的重定向可能导致安全问题">未经验证的重定向可能导致安全问题</h3>
<p>从安全的角度来看，重定向是一种相对安全的技术。攻击者无法通过重定向攻击网站。毕竟，重定向只是重定向到一个URL，这个URL攻击者只需在浏览器地址栏中键入即可。</p>
<p>但是，如果你使用某种类型的用户输入(如URL参数)，重定向URL时没有将其正确验证，则攻击者可能会利用此输入进行网络钓鱼攻击。这种重定向称为开放重定向或未经验证的重定向。</p>
<p>有一些合法的重定向到的URL用例来自用户的输入。Django的登录视图就是一个很好的例子。它接受一个URL参数Next，该参数包含用户登录后重定向到的页面的URL。要在登录后将用户重定向到其配置文件，URL可能如下所示：</p>
<p><a href="https://myawesomedjangowebapp.com/login/?next=/profile/">https://myawesomedjangowebapp.com/login/?next=/profile/</a></p>
<p>Django确实验证了下一个参数，但是这里我们假设它没有验证下一个参数。在没有验证的情况下，攻击者可以创建URL，将用户重定向到其控制下的网站，例如：</p>
<p><a href="https://myawesomedjangowebapp.com/login/?next=https://myawesomedjangowebapp.co/profile/">https://myawesomedjangowebapp.com/login/?next=https://myawesomedjangowebapp.co/profile/</a></p>
<p>然后，myawesomedjangowebapp.co 网站可能会显示一条错误消息，并诱使用户再次输入他们的凭据。</p>
<p>避免开放重定向的最佳方法是在构建重定向URL时不使用任何用户输入。</p>
<p>如果不能确定重定向URL是否安全，可以使用函数 django.utils.http.is_safe_url() 对其进行验证。文档字符串很好地解释了它的用法：</p>
<blockquote>
<p>is_safe_url(url, host=None, allowed_hosts=None, require_https=False)
如果url是安全重定向(即不会指向其他主机并使用安全方案)，则返回True。空 url 总是返回 False。如果 require_https 为 True（默认为 False），则只有 <code>https</code> 被视为有效方案。</p>
</blockquote>
<p>我们来看一些例子。</p>
<p>相对URL被认为是安全的：</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">&gt;&gt;&gt;</span> <span style="color:#8b949e;font-style:italic"># Import the function first.</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">&gt;&gt;&gt;</span> <span style="color:#ff7b72">from</span> <span style="color:#ff7b72">django.utils.http</span> <span style="color:#ff7b72">import</span> is_safe_url
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">&gt;&gt;&gt;</span> is_safe_url(<span style="color:#a5d6ff">&#39;/profile/&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">True</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>通常认为指向其他主机的URL不安全：</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">&gt;&gt;&gt;</span> is_safe_url(<span style="color:#a5d6ff">&#39;https://myawesomedjangowebapp.com/profile/&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">False</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>如果在 ALLOWED_HOSTS中 提供了指向另一个主机的URL，则该URL被认为是安全的：</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">&gt;&gt;&gt;</span> is_safe_url(<span style="color:#a5d6ff">&#39;https://myawesomedjangowebapp.com/profile/&#39;</span>,
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">...</span>             allowed_hosts<span style="color:#ff7b72;font-weight:bold">=</span>{<span style="color:#a5d6ff">&#39;myawesomedjangowebapp.com&#39;</span>})
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">True</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>如果参数 require_https 为True，则使用 http 方案的URL被视为不安全：</p>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">&gt;&gt;&gt;</span> is_safe_url(<span style="color:#a5d6ff">&#39;http://myawesomedjangowebapp.com/profile/&#39;</span>,
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">...</span>             allowed_hosts<span style="color:#ff7b72;font-weight:bold">=</span>{<span style="color:#a5d6ff">&#39;myawesomedjangowebapp.com&#39;</span>},
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">...</span>             require_https<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#79c0ff">True</span>)
</span></span><span style="display:flex;"><span><span style="color:#79c0ff">False</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="总结">总结</h2>
<p>到此终于结束了关于HTTP重定向的 Django 指南。现在你已经了解了重定向的各个方面，从HTTP协议的低级细节到Django中处理它们的高级方式。</p>
<p>你了解了HTTP重定向在幕后看起来如何，不同的状态代码是什么，以及永久重定向和临时重定向有何不同。这些知识并不是Django所特有的，对于任何语言的Web开发都是有价值的。</p>
<p>现在，你可以使用 Django 执行重定向，可以使用重定向响应类 HttpResponseRedirect 和 HttpResponsePermanentRedirect，也可以使用方便函数django.lowcuts.redirect()。你看到了一些高级用例的解决方案，并知道如何避免常见的陷阱。</p>
<p>如果你有任何关于HTTP重定向的问题和建议，请在下面留言，同时，祝你重定向愉快！</p>
]]></content:encoded>
    </item>
    <item>
      <title>flask框架学习</title>
      <link>https://Lucareful.github.io/en/posts/flask%E6%A1%86%E6%9E%B6/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://Lucareful.github.io/en/posts/flask%E6%A1%86%E6%9E%B6/</guid>
      <description>基本概念 1.静态资源 ​ 一旦准备好资源，不在需要经常变化的资源.由于该资源不需要经常变化，所以可以提前准备.比如png/jpg/css/js等</description>
      <content:encoded><![CDATA[<h1 id="基本概念">基本概念</h1>
<h2 id="1静态资源">1.静态资源</h2>
<p>​	一旦准备好资源，不在需要经常变化的资源.由于该资源不需要经常变化，所以可以提前准备.比如<code>png/jpg/css/js</code>等文件</p>
<h2 id="2动态资源">2.动态资源</h2>
<p>​	和静态资源相反，这种资源会经常变化.比如，我们要编写一个电商网站，我们无法预测用户在浏览商品时选择什么样的条件。
根据用户选择条件不同，我们给用户提供可供选择的商品就不同.这种资源无法提前准备。</p>
<h2 id="3模板文件">3.模板文件</h2>
<p>​	在用户搜索各种商品的时候，大家是否发现虽然大家的条件不同，但是显示商品的网页中除了那些商品信息整个网页的结构/布局几乎是一模一样的.
​	而模板文件就是网页中通用的结构构成的一个页面.这个页面中不含有任何用户需要查看的数据，当用户查询数据的时候会将最终的结果放到模板中形成用户真正需要的页面。
​	这就好比，生活中一个毛坯房可以装饰上不同的风格.我们把模板文件转化为用户真正看到的网页的过程就称为模板替换.</p>
<h1 id="通信规范">通信规范</h1>
<p>服务器和浏览器之间通信使用HTTP协议
同理，框架和web服务器之间进行通信也需要一个协议为了简单明了，一个简单的协议（例子）：</p>
<ul>
<li>1、web服务器在接收到浏览器的动态套源请求的时候会将请求报文请求切割拆分为键值对放到一个字典中</li>
<li>2、web服务器调用框架提供的方法执行框架的功能并且传给框架一个字典</li>
<li>3、框架通过字典取出用户请求根据请求产生处理状态/响应头信息/响应体</li>
<li>4、框架通过返回值将处理状态/响应头信息/响应体给服务器，完成一次动态资源请求的过程</li>
</ul>
<h1 id="flask程序运行过程">Flask程序运行过程</h1>
<ul>
<li>
<p>1.当客户端想要获取资源时，一般会通过浏览器发起HTTP请求。</p>
</li>
<li>
<p>2.此时，<code>Web</code>服务器会把来自客户端的所有请求都交给Flask程序实例</p>
</li>
<li>
<p>3.程序实例使用<code>Werkzeug</code>来做路由分发（<code>URL</code>请求和视图函数之间的对应关系）。</p>
</li>
<li>
<p>4.根据每个<code>URL</code>请求，找到具体的视图函数并进行调用。</p>
<ul>
<li>在<code>Flask</code>程序中，路由的实现一般是通过程序实例的装饰器实现。</li>
</ul>
</li>
<li>
<p>5.<code>Flask</code>调用视图函数后，可以返回两种内容：</p>
<ul>
<li>字符串内容：将视图函数的返回值作为响应的内容，返回给客户端（浏览器）</li>
<li><code>HTML</code>模版内容：获取到数据后，把数据传入<code>HTML</code>模板文件中，板引擎负责渲染<code>HTTP</code>响应数据，然后返回响应数据给客户端（浏览器）</li>
</ul>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">flask</span> <span style="color:#ff7b72">import</span> Flask, render_template
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 创建flask应用实例</span>
</span></span><span style="display:flex;"><span>app <span style="color:#ff7b72;font-weight:bold">=</span> Flask(__name__)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 定义路由及是视图函数（装饰器路由）</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 路由默认只支持GET请求方式，如需要支持别的请求需要添加</span>
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">@app.route</span>(<span style="color:#a5d6ff">&#39;/&#39;</span>, methods<span style="color:#ff7b72;font-weight:bold">=</span>[<span style="color:#a5d6ff">&#39;GET&#39;</span>, <span style="color:#a5d6ff">&#34;POST&#34;</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">index</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#8b949e;font-style:italic"># return &#34;Hello Flask&#34;z</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">return</span> render_template(<span style="color:#a5d6ff">&#34;index.html&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">if</span> __name__ <span style="color:#ff7b72;font-weight:bold">==</span> <span style="color:#a5d6ff">&#39;__main__&#39;</span>
</span></span><span style="display:flex;"><span>    app<span style="color:#ff7b72;font-weight:bold">.</span>run()
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h1 id="路由传参">路由传参</h1>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 使用一个视图函数 来显示不同用户的订单信息</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># &lt;&gt;路由定义的参数，&lt;&gt;内需要起个名字</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># int：限定参数类型为int类型，其他的不解析</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">#   -大致原理是将参数强转为int，如果成功，则可以进行路由匹配</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">#   -如果参数无法转换成功，就无法匹配该路由</span>
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">@app.route</span>(<span style="color:#a5d6ff">&#39;/orders/&lt;int:order_id&gt;&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">get_order_id</span>(order_id):
</span></span><span style="display:flex;"><span>    print(type(order_id))
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">return</span> <span style="color:#a5d6ff">&#39;order_id </span><span style="color:#a5d6ff">%s</span><span style="color:#a5d6ff">&#39;</span> <span style="color:#ff7b72;font-weight:bold">%</span> order_id
</span></span></code></pre></td></tr></table>
</div>
</div>  <!-- more -->
<h1 id="jinja2模板引擎"><code>Jinja2</code>模板引擎</h1>
<h2 id="模板">模板</h2>
<pre><code>在前面的示例中，视图函数的主要作用是生成请求的响应，这是最简单的请求。实际上，视图函数有两个作用：处理业务逻辑和返回响应内容。在大型应用中，把业务逻辑和表现内容放在一起，会增加代码的复杂度和维护成本。本节学到的模板，它的作用即是承担视图函数的另一个作用，即返回响应内容。
</code></pre>
<ul>
<li>
<p>模板其实是一个包含响应文本的文件，其中用占位符（变量）表示动态部分，告诉模板引擎其具体的值需要从使用的数据中获取</p>
</li>
<li>
<p>使用真实值替换变量，再返回最终得到的字符串，这个过程称为“渲染”</p>
</li>
<li>
<p><code>Flask</code>是使用<code>Jinja2</code>这个模板引擎来渲染模板</p>
</li>
</ul>
<p>使用模板的好处：</p>
<ul>
<li>
<p>视图函数只负责业务逻辑和数据处理（业务逻辑方面）</p>
</li>
<li>
<p>而模板则取到视图函数的数据结果进行展示（视图展示方面）</p>
</li>
<li>
<p>代码结构清晰，耦合度低</p>
</li>
</ul>
<h2 id="jinjia2"><code>JinJia2</code></h2>
<p>两个概念：</p>
<ul>
<li>
<p><code>Jinja2</code>：是Python下一个被广泛应用的模板引擎，是由Python实现的模板语言，他的设计思想来源于<code>Django</code>的模板引擎，并扩展了其语法和一系列强大的功能，其是<code>Flask</code>内置的模板语言。</p>
</li>
<li>
<p>模板语言：是一种被设计来自动生成文档的简单文本格式，在模板语言中，一般都会把一些变量传给模板，替换模板的特定位置上预先定义好的占位变量名。</p>
</li>
</ul>
<p>渲染模版函数</p>
<ul>
<li>
<p><code>Flask</code>提供的<code>render_template </code>函数封装了该模板引擎</p>
</li>
<li>
<p><code>render_template</code>函数的第一个参数是模板的文件名，后面的参数都是键值对，表示模板中变量对应的真实值。</p>
</li>
</ul>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">@app.route</span>(<span style="color:#a5d6ff">&#39;/&#39;</span>, methods<span style="color:#ff7b72;font-weight:bold">=</span>[<span style="color:#a5d6ff">&#39;GET&#39;</span>, <span style="color:#a5d6ff">&#34;POST&#34;</span>])
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">index</span>():
</span></span><span style="display:flex;"><span>    name <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#39;Luenci&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">return</span> render_template(<span style="color:#a5d6ff">&#34;index.html&#34;</span>, name<span style="color:#ff7b72;font-weight:bold">=</span>name)
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="使用方法">使用方法</h2>
<h3 id="变量代码块">变量代码块</h3>
<ul>
<li>用<img loading="lazy" src="https://raw.githubusercontent.com/Lucareful/ImgRepo/master/img/hexo_img/image-20200427161314597.png" alt=""  />
来表示变量名， 这种<img loading="lazy" src="https://raw.githubusercontent.com/Lucareful/ImgRepo/master/img/hexo_img/image-20200427161314597.png" alt=""  />
语法叫做变量代码块</li>
</ul>
<p><img loading="lazy" src="https://raw.githubusercontent.com/Lucareful/ImgRepo/master/img/hexo_img/image-20200427160426403.png" alt="image-20200427160426403"  />
)</p>
<ul>
<li>字典和列表的使用</li>
</ul>
<p><img loading="lazy" src="https://raw.githubusercontent.com/Lucareful/ImgRepo/master/img/hexo_img/image-20200427154043162.png" alt="image-20200427154043162"  />
</p>
<h3 id="控制代码块">控制代码块</h3>
<p><img loading="lazy" src="https://raw.githubusercontent.com/Lucareful/ImgRepo/master/img/hexo_img/image-20200427160633257.png" alt="img"  />
</p>
<h2 id="过滤器">过滤器</h2>
<p><img loading="lazy" src="https://raw.githubusercontent.com/Lucareful/ImgRepo/master/img/hexo_img/image-20200427160813513.png" alt="imgs"  />
</p>
<h1 id="web表单">Web表单</h1>
<ul>
<li>web表单是web应用程序的基本功能。</li>
<li>它是HTML页面中负责数据采集的部件。表单有三个部分组成：表单标签、表单域、表单按钮。表单允许用户输入数据，负责HTML页面数据采集，通过表单将用户输入的数据提交给服务器。</li>
<li>在Flask中，为了处理web表单，我们一般使用<code>Flask-WTF</code>扩展，它封装了<code>WTForms</code>，并且它有验证表单数据的功能</li>
</ul>
<div class="htmledit_views" id="content_views">
                                            <div class="table-box"><table><thead><tr><th>字段对象</th>
			<th>说明</th>
		</tr></thead><tbody><tr><td>StringField</td>
			<td>文本字段</td>
		</tr><tr><td>TextAreaField</td>
			<td>多行文本字段</td>
		</tr><tr><td>PasswordField</td>
			<td>密码文本字段</td>
		</tr><tr><td>HiddenField</td>
			<td>隐藏文件字段</td>
		</tr><tr><td>DateField</td>
			<td>文本字段，值为 datetime.date 文本格式</td>
		</tr><tr><td>DateTimeField</td>
			<td>文本字段，值为 datetime.datetime 文本格式</td>
		</tr><tr><td>IntegerField</td>
			<td>文本字段，值为整数</td>
		</tr><tr><td>DecimalField</td>
			<td>文本字段，值为decimal.Decimal</td>
		</tr><tr><td>FloatField</td>
			<td>文本字段，值为浮点数</td>
		</tr><tr><td>BooleanField</td>
			<td>复选框，值为True 和 False</td>
		</tr><tr><td>RadioField</td>
			<td>一组单选框</td>
		</tr><tr><td>SelectField</td>
			<td>下拉列表</td>
		</tr><tr><td>SelectMutipleField</td>
			<td>下拉列表，可选择多个值</td>
		</tr><tr><td>FileField</td>
			<td>文件上传字段</td>
		</tr><tr><td>SubmitField</td>
			<td>表单提交按钮</td>
		</tr><tr><td>FormField</td>
			<td>把表单作为字段嵌入另一个表单</td>
		</tr><tr><td>FieldList</td>
			<td>一组指定类型的字段</td>
		</tr></tbody></table></div><h2 id="wtforms常用验证函数"><a name="t0"></a>WTForms常用验证函数</h2>
<div class="table-box"><table><thead><tr><th>验证函数</th>
			<th>说明</th>
		</tr></thead><tbody><tr><td>DataRequired</td>
			<td>确保字段中有数据</td>
		</tr><tr><td>EqualTo</td>
			<td>比较两个字段的值，常用于比较两次密码输入</td>
		</tr><tr><td>Length</td>
			<td>验证输入的字符串长度</td>
		</tr><tr><td>NumberRange</td>
			<td>验证输入的值在数字范围内</td>
		</tr><tr><td>URL</td>
			<td>验证URL</td>
		</tr><tr><td>AnyOf</td>
			<td>验证输入值在可选列表中</td>
		</tr><tr><td>NoneOf</td>
			<td>验证输入值不在可选列表中</td>
		</tr></tbody></table>
<ul>
<li>
<p>使用 <code>Flask-WTF </code>需要配置参数 <code>SECRET_KEY</code></p>
</li>
<li>
<p>CSRF_ENABLED是为了CSRF（跨站请求伪造）保护。 <code>SECRET_KEY</code>用来生成加密令牌，当<code>CSRF</code>激活的时候，该设置会根据设置的密匙生成加密令牌。</p>
</li>
</ul>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 设置密匙</span>
</span></span><span style="display:flex;"><span>app<span style="color:#ff7b72;font-weight:bold">.</span>secret_key <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#39;luenci&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">@app.route</span>(<span style="color:#a5d6ff">&#39;/login.html&#39;</span>, methods<span style="color:#ff7b72;font-weight:bold">=</span>[<span style="color:#a5d6ff">&#39;GET&#39;</span>, <span style="color:#a5d6ff">&#39;POST&#39;</span>])
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">login</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">if</span> request<span style="color:#ff7b72;font-weight:bold">.</span>method <span style="color:#ff7b72;font-weight:bold">==</span> <span style="color:#a5d6ff">&#34;POST&#34;</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#8b949e;font-style:italic"># 获取表单的数据</span>
</span></span><span style="display:flex;"><span>        username <span style="color:#ff7b72;font-weight:bold">=</span> request<span style="color:#ff7b72;font-weight:bold">.</span>form<span style="color:#ff7b72;font-weight:bold">.</span>get(<span style="color:#a5d6ff">&#39;username&#39;</span>)
</span></span><span style="display:flex;"><span>        password <span style="color:#ff7b72;font-weight:bold">=</span> request<span style="color:#ff7b72;font-weight:bold">.</span>form<span style="color:#ff7b72;font-weight:bold">.</span>get(<span style="color:#a5d6ff">&#39;password&#39;</span>)
</span></span><span style="display:flex;"><span>        print(username, password)
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">if</span> username <span style="color:#ff7b72;font-weight:bold">==</span> <span style="color:#a5d6ff">&#39;&#39;</span>:
</span></span><span style="display:flex;"><span>            flash(<span style="color:#a5d6ff">&#39;请填写邮箱&#39;</span>)	
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">elif</span> password <span style="color:#ff7b72;font-weight:bold">==</span> <span style="color:#a5d6ff">&#39;&#39;</span>:
</span></span><span style="display:flex;"><span>            flash(<span style="color:#a5d6ff">&#39;请设置密码&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">else</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#ff7b72">return</span> <span style="color:#a5d6ff">&#39;sucess&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">return</span> render_template(<span style="color:#a5d6ff">&#34;login_demo.html&#34;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="https://raw.githubusercontent.com/Lucareful/ImgRepo/master/img/hexo_img/image-20200427161032568.png" alt=""  />
</p>
<h2 id="flask-wtf实现表单"><code>Flask-WTF</code>实现表单</h2>
<div class="highlight"><div style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#737679">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">flask_wtf</span> <span style="color:#ff7b72">import</span> FlaskForm
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 导入文本字段，密码字段，和提交按钮</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">wtforms</span> <span style="color:#ff7b72">import</span> StringField, PasswordField, SubmitField
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># 创建表单类</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">class</span> <span style="color:#f0883e;font-weight:bold">LoginFrom</span>(FlaskForm):
</span></span><span style="display:flex;"><span>    username <span style="color:#ff7b72;font-weight:bold">=</span> StringField(<span style="color:#a5d6ff">&#34;用户名&#34;</span>)
</span></span><span style="display:flex;"><span>    password1 <span style="color:#ff7b72;font-weight:bold">=</span> PasswordField(<span style="color:#a5d6ff">&#34;密码&#34;</span>)
</span></span><span style="display:flex;"><span>    password2 <span style="color:#ff7b72;font-weight:bold">=</span> PasswordField(<span style="color:#a5d6ff">&#34;确认密码&#34;</span>)
</span></span><span style="display:flex;"><span>    submit <span style="color:#ff7b72;font-weight:bold">=</span> SubmitField(<span style="color:#a5d6ff">&#34;提交&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">@app.route</span>(<span style="color:#a5d6ff">&#39;/form&#39;</span>, methods<span style="color:#ff7b72;font-weight:bold">=</span>[<span style="color:#a5d6ff">&#34;GET&#34;</span>, <span style="color:#a5d6ff">&#34;POST&#34;</span>])
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">form_demo</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#8b949e;font-style:italic"># 创建表单实例</span>
</span></span><span style="display:flex;"><span>    form_login <span style="color:#ff7b72;font-weight:bold">=</span> LoginFrom()
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">return</span> render_template(<span style="color:#a5d6ff">&#34;login_demo.html&#34;</span>, form<span style="color:#ff7b72;font-weight:bold">=</span>form_login)
</span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="https://raw.githubusercontent.com/Lucareful/ImgRepo/master/img/hexo_img/image-20200427161047472.png" alt=""  />
</p>
]]></content:encoded>
    </item>
  </channel>
</rss>
