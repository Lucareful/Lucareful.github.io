<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Posts | Luenci</title>
<meta name=keywords content><meta name=description content="Posts - Luenci"><meta name=author content="Luenci"><link rel=canonical href=https://luenci.com/en/posts/><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://luenci.com/images/L.png><link rel=icon type=image/png sizes=16x16 href=https://luenci.com/images/L.png><link rel=icon type=image/png sizes=32x32 href=https://luenci.com/images/L.png><link rel=apple-touch-icon href=https://luenci.com/L.png><link rel=mask-icon href=https://luenci.com/L.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://luenci.com/en/posts/index.xml><link rel=alternate hreflang=en href=https://luenci.com/en/posts/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script defer src=https://umami.luenci.com/script.js data-website-id=b0a9e971-b470-43a2-bda9-182c654377f4></script><meta property="og:title" content="Posts"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://luenci.com/en/posts/"><meta property="og:site_name" content="(ã€ƒ'â–½'ã€ƒ)"><meta name=twitter:card content="summary"><meta name=twitter:title content="Posts"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://luenci.com/en/posts/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://luenci.com/en/ accesskey=h title="Luenci (Alt + H)"><img src=https://luenci.com/images/avatar.jpg alt aria-label=logo height=35>Luenci</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://luenci.com/en/ title=ğŸ ä¸»é¡µ><span>ğŸ ä¸»é¡µ</span></a></li><li><a href=https://luenci.com/en/posts title=ğŸ“šæ–‡ç« ><span class=active>ğŸ“šæ–‡ç« </span></a></li><li><a href=https://luenci.com/en/search title="ğŸ”æœç´¢ (Alt + /)" accesskey=/><span>ğŸ”æœç´¢</span></a></li><li><a href=https://luenci.com/en/archives title=â±æ—¶é—´è½´><span>â±æ—¶é—´è½´</span></a></li><li><a href=https://luenci.com/en/tags title=ğŸ”–æ ‡ç­¾><span>ğŸ”–æ ‡ç­¾</span></a></li><li><a href=https://luenci.com/en/about title=ğŸ™‹ğŸ»â€â™‚ï¸å…³äº><span>ğŸ™‹ğŸ»â€â™‚ï¸å…³äº</span></a></li><li><a href=https://luenci.com/en/links title=ğŸ¤å‹é“¾><span>ğŸ¤å‹é“¾</span></a></li><li><a href=https://luenci.com/en/index.xml title=ğŸ“¬RSS><span>ğŸ“¬RSS</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://luenci.com/en/>Home</a></div><h1>Posts</h1></header><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>VictoriaMetricsn åŸç†å…¥é—¨</h2></header><div class=entry-content><p>VictoriaMetricsn åŸç†å…¥é—¨ ç®€ä»‹ VictoriaMetricsï¼Œæ˜¯ä¸€ä¸ªå¿«é€Ÿé«˜æ•ˆã€ç»æµå¹¶ä¸”å¯æ‰©å±•çš„ç›‘æ§è§£å†³æ–¹æ¡ˆå’Œæ—¶åºæ•°æ®åº“ã€‚
â€‹ è°ˆåˆ°VictoriaMetricså°±å¿…é¡»è¦æåˆ°Prometheusï¼ŒVictoriaMetricsæ˜¯ä¸€ä¸ªæ–°å…´çš„ç›‘æ§è§£å†³æ–¹æ¡ˆã€‚å®ƒå€ŸåŠ©Prometheuså¼ºå¤§çš„exporterç”Ÿæ€ã€æˆç†Ÿçš„è§„èŒƒã€æœåŠ¡å‘ç°ç­‰ä¼˜ç‚¹ç­‰ï¼Œèå…¥åˆ°Prometheusç”Ÿæ€ä¸­ã€‚VictoriaMetricså®˜ç½‘å¾ˆå¤šå…¼å®¹Prometheuså‚æ•°è§£é‡Šéƒ½æ˜¯ç›´æ¥è·³è½¬åˆ°Prometheuså®˜ç½‘ã€‚
â€‹ VictoriaMetricså¯ä»¥ä½œä¸ºPrometheusçš„é•¿æœŸè¿œç¨‹å­˜å‚¨æ–¹æ¡ˆï¼Œå½“ç„¶ VictoriaMetrics ä¹Ÿå¯ä»¥å®Œå…¨å–ä»£ Prometheusï¼Œå› ä¸º VictoriaMetrics åŸºæœ¬æ”¯æŒ Prometheusé…ç½®æ–‡ä»¶ã€PromQLã€å„ç±»APIã€æ•°æ®æ ¼å¼ç­‰ç­‰ã€‚
VictoriaMetrics ä¼˜ç‚¹ è¿œç¨‹å­˜å‚¨ï¼šå¯ä½œä¸ºå•ä¸€æˆ–å¤šä¸ªPrometheusçš„è¿œç¨‹å­˜å‚¨ å®‰è£…ç®€å•ï¼šå•èŠ‚ç‚¹æ¶æ„ä¸€æ¡å‘½ä»¤å°±å¯ä»¥éƒ¨ç½²å®Œæ¯•ï¼ˆé›†ç¾¤æ–¹å¼ç¨å¾®å¤æ‚ä¸€äº›ï¼Œä½†ä¹Ÿå¾ˆå¥½ç†è§£ï¼‰ å…¼å®¹æ€§ï¼šPromQLå…¼å®¹å’Œå¢å¼ºçš„MetricsQL Grafanaå…¼å®¹ï¼šVMå¯æ›¿æ¢Grafanaçš„Prometheusæ•°æ®æºï¼ˆç»æµ‹è¯•ï¼Œçº¿ä¸Šæ•°æ®æºç›´æ¥æ›¿æ¢å100%å…¼å®¹ï¼‰ ä½å†…å­˜ï¼šæ›´ä½çš„å†…å­˜å ç”¨ï¼Œå®˜æ–¹å¯¹æ¯”Prometheusï¼Œå¯ä»¥é‡Šæ”¾7å€å·¦å³å†…å­˜ç©ºé—´ï¼ˆçº¿ä¸Šå¯¹æ¯”å¤§æ¦‚4å€ï¼‰ é«˜å‹ç¼©æ¯”ï¼šæä¾›å­˜å‚¨æ•°æ®é«˜å‹ç¼©ï¼Œå®˜æ–¹è¯´å¯ä»¥æ¯”Prometheuså‡å°‘7å€çš„å­˜å‚¨ç©ºé—´ï¼ˆçº¿ä¸Šå¯¹æ¯”å¤§æ¦‚æ˜¯4~5å€ï¼‰ é«˜æ€§èƒ½ï¼šæŸ¥è¯¢æ€§èƒ½æ¯”Prometheusæ›´å¿« æ”¯æŒæ°´å¹³æ‰©å®¹&amp;HAï¼šåŸºäºVMé›†ç¾¤ç‰ˆå®ç° æ”¯æŒå¤šç§Ÿæˆ·ï¼šä¸»è¦é’ˆå¯¹é›†ç¾¤ç‰ˆ VictoriaMetrics ç¼ºç‚¹ å›¾å½¢åŒ–åšçš„ä¸å¥½ï¼Œè™½ç„¶æœ‰vmuiï¼Œä½†åŠŸèƒ½å¾ˆå°‘ å‘Šè­¦åŠŸèƒ½éœ€è¦å•ç‹¬é…ç½®vmalertï¼Œè€Œä¸”vmalertåªæœ‰apiç®¡ç†å’ŒæŸ¥çœ‹ï¼Œæš‚æ—¶æ²¡ç”¨å›¾å½¢ç•Œé¢ æ²¡æœ‰ç±»ä¼¼Prometheusçš„WALæ—¥å¿—ï¼Œçªç„¶æ•…éšœå¯èƒ½ä¼šä¸¢å¤±éƒ¨åˆ†æ•°æ® ...</p></div><footer class=entry-footer><span title='2024-06-24 00:00:00 +0000 UTC'>ğŸ¬åˆ›å»ºæ—¥æœŸ:2024-06-24</span>&nbsp|&nbspğŸ“…æœ€åæ›´æ–°:&nbsp;2024-06-24&nbsp|&nbspâ²ï¸æ—¶é•¿: 6 min&nbsp|&nbspğŸ“–å­—æ•°: 2797 words&nbsp;|&nbsp;Luenci</footer><a class=entry-link aria-label="post link to VictoriaMetricsn åŸç†å…¥é—¨" href=https://luenci.com/en/posts/victoriametricsn-%E5%8E%9F%E7%90%86%E5%85%A5%E9%97%A8/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Redisäº”ä¸ªä½¿ç”¨åœºæ™¯</h2></header><div class=entry-content><p>Redisäº”ä¸ªä½¿ç”¨åœºæ™¯ åŸæ–‡è½¬è‡ªï¼šhttps://www.jdon.com/69107.html
1.ç¼“å­˜ æœ€å¸¸è§çš„ç”¨ä¾‹æ˜¯åˆ©ç”¨ Redis è¿›è¡Œç¼“å­˜ã€‚è¿™æœ‰åŠ©äºä¿æŠ¤æ•°æ®åº“å±‚ä¸è¶…è½½ã€‚Redis å¯ä¸ºç¼“å­˜æ•°æ®æä¾›å¿«é€ŸæŸ¥æ‰¾æ—¶é—´ï¼Œæœ‰åŠ©äºæé«˜åº”ç”¨ç¨‹åºæ€§èƒ½ã€‚
...</p></div><footer class=entry-footer><span title='2024-07-11 00:00:00 +0000 UTC'>ğŸ¬åˆ›å»ºæ—¥æœŸ:2024-07-11</span>&nbsp|&nbspğŸ“…æœ€åæ›´æ–°:&nbsp;2024-07-11&nbsp|&nbspâ²ï¸æ—¶é•¿: 1 min&nbsp|&nbspğŸ“–å­—æ•°: 364 words&nbsp;|&nbsp;Luenci</footer><a class=entry-link aria-label="post link to Redisäº”ä¸ªä½¿ç”¨åœºæ™¯" href=https://luenci.com/en/posts/redis%E4%BA%94%E4%B8%AA%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>what-happens-whenï¼ˆæµè§ˆå™¨ä¸€æ¬¡è¯·æ±‚çš„å†ç¨‹ï¼‰</h2></header><div class=entry-content><p>what-happens-whenï¼ˆæµè§ˆå™¨ä¸€æ¬¡è¯·æ±‚çš„å†ç¨‹ï¼‰ åŸæ–‡æ¥è‡ªï¼šalex/what-happens-when: An attempt to answer the age old interview question â€œWhat happens when you type google.com into your browser and press enter?â€ â€” äºšå†å…‹æ–¯/ä»€ä¹ˆæ—¶å€™ä¼šå‘ç”Ÿä»€ä¹ˆï¼šè¯•å›¾å›ç­”å¤è€çš„é¢è¯•é—®é¢˜â€œå½“ä½ åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ google.com å¹¶æŒ‰å›è½¦é”®æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ (github.com)
...</p></div><footer class=entry-footer><span title='2024-06-20 00:00:00 +0000 UTC'>ğŸ¬åˆ›å»ºæ—¥æœŸ:2024-06-20</span>&nbsp|&nbspğŸ“…æœ€åæ›´æ–°:&nbsp;2024-06-20&nbsp|&nbspâ²ï¸æ—¶é•¿: 19 min&nbsp|&nbspğŸ“–å­—æ•°: 9336 words&nbsp;|&nbsp;Luenci</footer><a class=entry-link aria-label="post link to what-happens-whenï¼ˆæµè§ˆå™¨ä¸€æ¬¡è¯·æ±‚çš„å†ç¨‹ï¼‰" href=https://luenci.com/en/posts/what-happens-when/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Prometheus æ¦‚å¿µå…¥é—¨</h2></header><div class=entry-content><p>Prometheus æ¦‚å¿µå…¥é—¨ æ•°æ®æ¨¡å‹ â€‹ Prometheus æ‰€æœ‰é‡‡é›†çš„ç›‘æ§æ•°æ®å‡ä»¥æŒ‡æ ‡ï¼ˆmetricï¼‰çš„å½¢å¼ä¿å­˜åœ¨å†…ç½®çš„æ—¶é—´åºåˆ—æ•°æ®åº“å½“ä¸­ï¼ˆTSDBï¼‰ï¼šå±äºåŒä¸€æŒ‡æ ‡åç§°ï¼ŒåŒä¸€æ ‡ç­¾é›†åˆçš„ã€æœ‰æ—¶é—´æˆ³æ ‡è®°çš„æ•°æ®æµã€‚é™¤äº†å­˜å‚¨çš„æ—¶é—´åºåˆ—ï¼ŒPrometheus è¿˜å¯ä»¥æ ¹æ®æŸ¥è¯¢è¯·æ±‚äº§ç”Ÿä¸´æ—¶çš„ã€è¡ç”Ÿçš„æ—¶é—´åºåˆ—ä½œä¸ºè¿”å›ç»“æœã€‚
æŒ‡æ ‡åç§°å’Œæ ‡ç­¾ æ¯ä¸€æ¡æ—¶é—´åºåˆ—ç”±æŒ‡æ ‡åç§°ï¼ˆMetrics Nameï¼‰ä»¥åŠä¸€ç»„æ ‡ç­¾ï¼ˆé”®å€¼å¯¹ï¼‰å”¯ä¸€æ ‡è¯†ã€‚å…¶ä¸­æŒ‡æ ‡çš„åç§°ï¼ˆmetric nameï¼‰å¯ä»¥åæ˜ è¢«ç›‘æ§æ ·æœ¬çš„å«ä¹‰ï¼ˆä¾‹å¦‚ï¼Œhttp_requests_total â€” è¡¨ç¤ºå½“å‰ç³»ç»Ÿæ¥æ”¶åˆ°çš„ HTTP è¯·æ±‚æ€»é‡ï¼‰ï¼ŒæŒ‡æ ‡åç§°åªèƒ½ç”± ASCII å­—ç¬¦ã€æ•°å­—ã€ä¸‹åˆ’çº¿ä»¥åŠå†’å·ç»„æˆï¼ŒåŒæ—¶å¿…é¡»åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼ [a-zA-Z_:][a-zA-Z0-9_:]*ã€‚
[info] æ³¨æ„
å†’å·ç”¨æ¥è¡¨ç¤ºç”¨æˆ·è‡ªå®šä¹‰çš„è®°å½•è§„åˆ™ï¼Œä¸èƒ½åœ¨ exporter ä¸­æˆ–ç›‘æ§å¯¹è±¡ç›´æ¥æš´éœ²çš„æŒ‡æ ‡ä¸­ä½¿ç”¨å†’å·æ¥å®šä¹‰æŒ‡æ ‡åç§°ã€‚
é€šè¿‡ä½¿ç”¨æ ‡ç­¾ï¼ŒPrometheus å¼€å¯äº†å¼ºå¤§çš„å¤šç»´æ•°æ®æ¨¡å‹ï¼šå¯¹äºç›¸åŒçš„æŒ‡æ ‡åç§°ï¼Œé€šè¿‡ä¸åŒæ ‡ç­¾åˆ—è¡¨çš„é›†åˆï¼Œä¼šå½¢æˆç‰¹å®šçš„åº¦é‡ç»´åº¦å®ä¾‹ï¼ˆä¾‹å¦‚ï¼šæ‰€æœ‰åŒ…å«åº¦é‡åç§°ä¸º /api/tracks çš„ http è¯·æ±‚ï¼Œæ‰“ä¸Š method=POST çš„æ ‡ç­¾ï¼Œå°±ä¼šå½¢æˆå…·ä½“çš„ http è¯·æ±‚ï¼‰ã€‚è¯¥æŸ¥è¯¢è¯­è¨€åœ¨è¿™äº›æŒ‡æ ‡å’Œæ ‡ç­¾åˆ—è¡¨çš„åŸºç¡€ä¸Šè¿›è¡Œè¿‡æ»¤å’Œèšåˆã€‚æ”¹å˜ä»»ä½•åº¦é‡æŒ‡æ ‡ä¸Šçš„ä»»ä½•æ ‡ç­¾å€¼ï¼ˆåŒ…æ‹¬æ·»åŠ æˆ–åˆ é™¤æŒ‡æ ‡ï¼‰ï¼Œéƒ½ä¼šåˆ›å»ºæ–°çš„æ—¶é—´åºåˆ—ã€‚
æ ‡ç­¾çš„åç§°åªèƒ½ç”± ASCII å­—ç¬¦ã€æ•°å­—ä»¥åŠä¸‹åˆ’çº¿ç»„æˆå¹¶æ»¡è¶³æ­£åˆ™è¡¨è¾¾å¼ [a-zA-Z_][a-zA-Z0-9_]*ã€‚å…¶ä¸­ä»¥ __ ä½œä¸ºå‰ç¼€çš„æ ‡ç­¾ï¼Œæ˜¯ç³»ç»Ÿä¿ç•™çš„å…³é”®å­—ï¼Œåªèƒ½åœ¨ç³»ç»Ÿå†…éƒ¨ä½¿ç”¨ã€‚æ ‡ç­¾çš„å€¼åˆ™å¯ä»¥åŒ…å«ä»»ä½• Unicode ç¼–ç çš„å­—ç¬¦ã€‚
æ ·æœ¬ åœ¨æ—¶é—´åºåˆ—ä¸­çš„æ¯ä¸€ä¸ªç‚¹ç§°ä¸ºä¸€ä¸ªæ ·æœ¬ï¼ˆsampleï¼‰ï¼Œæ ·æœ¬ç”±ä»¥ä¸‹ä¸‰éƒ¨åˆ†ç»„æˆï¼š
æŒ‡æ ‡ï¼ˆmetricï¼‰ï¼šæŒ‡æ ‡åç§°å’Œæè¿°å½“å‰æ ·æœ¬ç‰¹å¾çš„ labelsetsï¼› æ—¶é—´æˆ³ï¼ˆtimestampï¼‰ï¼šä¸€ä¸ªç²¾ç¡®åˆ°æ¯«ç§’çš„æ—¶é—´æˆ³ï¼› æ ·æœ¬å€¼ï¼ˆvalueï¼‰ï¼š ä¸€ä¸ª folat64 çš„æµ®ç‚¹å‹æ•°æ®è¡¨ç¤ºå½“å‰æ ·æœ¬çš„å€¼ã€‚ ...</p></div><footer class=entry-footer><span title='2024-06-15 00:00:00 +0000 UTC'>ğŸ¬åˆ›å»ºæ—¥æœŸ:2024-06-15</span>&nbsp|&nbspğŸ“…æœ€åæ›´æ–°:&nbsp;2024-06-15&nbsp|&nbspâ²ï¸æ—¶é•¿: 7 min&nbsp|&nbspğŸ“–å­—æ•°: 3087 words&nbsp;|&nbsp;Luenci</footer><a class=entry-link aria-label="post link to Prometheus æ¦‚å¿µå…¥é—¨" href=https://luenci.com/en/posts/prometheus-%E6%A6%82%E5%BF%B5%E5%85%A5%E9%97%A8/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>å¤œèºç›‘æ§å…¥é—¨</h2></header><div class=entry-content><p>å¼•å­ ç›‘æ§ç³»ç»Ÿå¿…è¦æ€§ â€‹ ä½œä¸ºè¿ç»´è€…ï¼Œç¬¬ä¸€ä¸ªæ¥è§¦çš„åŸºæœ¬ä¸Šæ˜¯ç›‘æ§å¹³å°ï¼Œå„ç§å„æ ·çš„ç›‘æ§ï¼Œçœ‹å„ç§å„æ ·çš„æŒ‡æ ‡ï¼Œå¥½åƒæ²¡æœ‰ç›‘æ§å°±è§‰å¾—ä¸æ­£å¸¸ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆéœ€è¦ç›‘æ§å‘¢ï¼Ÿ
é¢„é˜²æ•…éšœï¼Œä¾‹å¦‚å½“ç£ç›˜ç©ºé—´å¢é•¿åˆ°ä¸€å®šçš„ç¨‹åº¦çš„æ—¶å€™ï¼Œå°±ä¼šäº§ç”Ÿæ•…éšœï¼Œè¿™ä¸ªæ—¶å€™ç›‘æ§ç³»ç»Ÿçš„ä½œç”¨å°±æ˜¯å½“è¾¾åˆ°ä¸€ä¸ªé˜€å€¼çš„æ—¶å€™ï¼Œå‘å‡ºå‘Šè­¦ï¼Œç„¶åè¿›è¡Œå¤„ç†ã€‚ é¢„æµ‹å˜åŒ–è¶‹åŠ¿ï¼Œä¾‹å¦‚æˆ‘çš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œæ¯å¤©æ•°æ®å¢é•¿1Tç©ºé—´ï¼Œé‚£ä¹ˆæˆ‘æ€»å…±æœ‰å¤šå°‘ç©ºé—´ï¼Œå‰©ä½™ç©ºé—´å¤§å°ï¼Œæ˜¯å¦è¦è¿›è¡Œæ‰©å®¹ç­‰æ“ä½œã€‚ å½“æ•…éšœå‘ç”Ÿçš„æ—¶å€™ï¼Œèƒ½æä¾›ç»™æˆ‘åŸºæœ¬ä¿¡æ¯ç»™ä¸æˆ‘æ’æŸ¥çš„æ€è·¯ï¼Œä¾‹å¦‚redisä¸å¯è¯»ï¼Œæ˜¯å¦èƒ½çœ‹åˆ°æ˜¯å“ªä¸ªå®ä¾‹ï¼Œèƒ½çœ‹åˆ°ç›¸å…³çš„æ—¥å¿—ä¿¡æ¯ï¼Œèƒ½æµ‹è¯•æ˜¯å¦åˆ»è¯»å†™ï¼Œèƒ½æŸ¥çœ‹å“ªä¸ªæ˜¯masterã€‚ ç›‘æ§ç³»ç»Ÿå…³é”®æŒ‡æ ‡ï¼Œä¾‹å¦‚å¯¹äºwebæœåŠ¡å™¨æ¥è¯´ï¼Œå“åº”é€Ÿåº¦ï¼Œæ¥åˆ¤æ–­æ˜¯å¦ä¸­é—´ä»¶æœ‰é—®é¢˜ï¼Œæ˜¯å¦æ•°æ®åº“æœ‰é—®é¢˜ï¼Œè¿˜æ˜¯ç½‘ç»œæœ‰é—®é¢˜ï¼›æ´»è·ƒçš„ç”¨æˆ·æ•°ï¼Œæ¯å¤©æˆ‘çš„ç½‘ç«™æœ‰å¤šå°‘ç”¨æˆ·è®¿é—®ï¼›æœ‰å¤šå°‘æ–°æ³¨å†Œçš„ç”¨æˆ·ã€‚ ç®€ä»‹ â€‹ å¤œèºç›‘æ§ï¼ˆ Nightingale ï¼‰æ˜¯ä¸€æ¬¾å›½äº§ã€å¼€æºäº‘åŸç”Ÿç›‘æ§åˆ†æç³»ç»Ÿï¼Œé‡‡ç”¨ All-In-One çš„è®¾è®¡ï¼Œé›†æ•°æ®é‡‡é›†ã€å¯è§†åŒ–ã€ç›‘æ§å‘Šè­¦ã€æ•°æ®åˆ†æäºä¸€ä½“ã€‚äº 2020 å¹´ 3 æœˆ 20 æ—¥ï¼Œåœ¨ github ä¸Šå‘å¸ƒ v1 ç‰ˆæœ¬ï¼Œå·²ç´¯è®¡è¿­ä»£ 60 å¤šä¸ªç‰ˆæœ¬ã€‚ä» v5 ç‰ˆæœ¬å¼€å§‹ä¸ Prometheusã€VictoriaMetricsã€Grafanaã€Telegrafã€Datadog ç­‰ç”Ÿæ€ç´§å¯†ååŒé›†æˆï¼Œæä¾›å¼€ç®±å³ç”¨çš„ä¼ä¸šçº§ç›‘æ§åˆ†æå’Œå‘Šè­¦èƒ½åŠ›ï¼Œå·²æœ‰ä¼—å¤šä¼ä¸šé€‰æ‹©å°† Prometheus + AlertManager + Grafana çš„ç»„åˆæ–¹æ¡ˆå‡çº§ä¸ºä½¿ç”¨å¤œèºç›‘æ§ã€‚å¤œèºç›‘æ§ï¼Œç”±æ»´æ»´å¼€å‘å’Œå¼€æºï¼Œå¹¶äº 2022 å¹´ 5 æœˆ 11 æ—¥ï¼Œæèµ äºˆä¸­å›½è®¡ç®—æœºå­¦ä¼šå¼€æºå‘å±•å§”å‘˜ä¼šï¼ˆCCF ODCï¼‰ï¼Œä¸º CCF ODC æˆç«‹åæ¥å—æèµ çš„ç¬¬ä¸€ä¸ªå¼€æºé¡¹ç›®ã€‚å¤œèºç›‘æ§çš„æ ¸å¿ƒå¼€å‘å›¢é˜Ÿï¼Œä¹Ÿæ˜¯Open-Falconé¡¹ç›®åŸæ ¸å¿ƒç ”å‘äººå‘˜ã€‚
äº§å“ä»‹ç» å¼€ç®±å³ç”¨ï¼šæ”¯æŒ Dockerã€Helm Chartã€äº‘æœåŠ¡ç­‰å¤šç§éƒ¨ç½²æ–¹å¼ï¼›é›†æ•°æ®é‡‡é›†ã€ç›‘æ§å‘Šè­¦ã€å¯è§†åŒ–ä¸ºä¸€ä½“ï¼›å†…ç½®å¤šç§ç›‘æ§ä»ªè¡¨ç›˜ã€å¿«æ·è§†å›¾ã€å‘Šè­¦è§„åˆ™æ¨¡æ¿ï¼Œå¯¼å…¥å³å¯å¿«é€Ÿä½¿ç”¨ï¼›å¤§å¹…é™ä½äº‘åŸç”Ÿç›‘æ§ç³»ç»Ÿçš„å»ºè®¾æˆæœ¬ã€å­¦ä¹ æˆæœ¬ã€ä½¿ç”¨æˆæœ¬ äº‘åŸç”Ÿï¼šä»¥äº¤é’¥åŒ™çš„æ–¹å¼å¿«é€Ÿæ„å»ºä¼ä¸šçº§çš„äº‘åŸç”Ÿç›‘æ§ä½“ç³»ï¼Œæ”¯æŒ Categrafã€Telegrafã€Grafana-agent ç­‰å¤šç§é‡‡é›†å™¨ï¼Œæ”¯æŒ Prometheusã€VictoriaMetricsã€M3DBã€ElasticSearch ç­‰å¤šç§æ•°æ®åº“ï¼Œå…¼å®¹æ”¯æŒå¯¼å…¥ Grafana ä»ªè¡¨ç›˜ï¼Œä¸äº‘åŸç”Ÿç”Ÿæ€æ— ç¼é›†æˆ ä¸“ä¸šå‘Šè­¦ï¼šå¯è§†åŒ–çš„å‘Šè­¦é…ç½®å’Œç®¡ç†ï¼Œæ”¯æŒä¸°å¯Œçš„å‘Šè­¦è§„åˆ™ï¼Œæä¾›å±è”½è§„åˆ™ã€è®¢é˜…è§„åˆ™çš„é…ç½®èƒ½åŠ›ï¼Œæ”¯æŒå‘Šè­¦å¤šç§é€è¾¾æ¸ é“ï¼Œæ”¯æŒå‘Šè­¦è‡ªæ„ˆã€å‘Šè­¦äº‹ä»¶ç®¡ç†ç­‰ çµæ´»æ‰©å±•ã€ä¸­å¿ƒåŒ–ç®¡ç†ï¼šå¤œèºç›‘æ§ï¼Œå¯éƒ¨ç½²åœ¨ 1 æ ¸ 1G çš„äº‘ä¸»æœºï¼Œå¯åœ¨ä¸Šç™¾å°æœºå™¨é›†ç¾¤åŒ–éƒ¨ç½²ï¼Œå¯è¿è¡Œåœ¨ K8s ä¸­ï¼›ä¹Ÿå¯å°†æ—¶åºåº“ã€å‘Šè­¦å¼•æ“ç­‰ç»„ä»¶ä¸‹æ²‰åˆ°å„æœºæˆ¿ã€å„ Regionï¼Œå…¼é¡¾è¾¹ç¼˜éƒ¨ç½²å’Œä¸­å¿ƒåŒ–ç»Ÿä¸€ç®¡ç†ï¼Œè§£å†³æ•°æ®å‰²è£‚ï¼Œç¼ºä¹ç»Ÿä¸€è§†å›¾çš„éš¾é¢˜ é«˜æ€§èƒ½ã€é«˜å¯ç”¨ï¼šå¾—ç›Šäºå¤œèºçš„å¤šæ•°æ®æºç®¡ç†å¼•æ“ï¼Œå’Œå¤œèºå¼•æ“ä¾§ä¼˜ç§€çš„æ¶æ„è®¾è®¡ï¼Œå€ŸåŠ©äºé«˜æ€§èƒ½æ—¶åºåº“ï¼Œå¯ä»¥æ»¡è¶³æ•°äº¿æ—¶é—´çº¿çš„é‡‡é›†ã€å­˜å‚¨ã€å‘Šè­¦åˆ†æåœºæ™¯ï¼ŒèŠ‚çœå¤§é‡æˆæœ¬ï¼›å¤œèºç›‘æ§ç»„ä»¶å‡å¯æ°´å¹³æ‰©å±•ï¼Œæ— å•ç‚¹ï¼Œå·²åœ¨ä¸Šåƒå®¶ä¼ä¸šéƒ¨ç½²è½åœ°ï¼Œç»å—äº†ä¸¥è‹›çš„ç”Ÿäº§å®è·µæ£€éªŒ â€‹ Nightingale å¯ä»¥æ¥æ”¶å„ç§é‡‡é›†å™¨ä¸ŠæŠ¥çš„ç›‘æ§æ•°æ®ï¼Œè½¬å­˜åˆ°æ—¶åºåº“ï¼ˆå¯ä»¥æ”¯æŒPrometheusã€M3DBã€VictoriaMetricsã€Thanosç­‰ï¼‰ï¼Œå¹¶æä¾›å‘Šè­¦è§„åˆ™ã€å±è”½è§„åˆ™ã€è®¢é˜…è§„åˆ™çš„é…ç½®èƒ½åŠ›ï¼Œæä¾›ç›‘æ§æ•°æ®çš„æŸ¥çœ‹èƒ½åŠ›ï¼Œæä¾›å‘Šè­¦è‡ªæ„ˆæœºåˆ¶ï¼ˆå‘Šè­¦è§¦å‘ä¹‹åè‡ªåŠ¨å›è°ƒæŸä¸ªwebhookåœ°å€æˆ–è€…æ‰§è¡ŒæŸä¸ªè„šæœ¬ï¼‰ï¼Œæä¾›å†å²å‘Šè­¦äº‹ä»¶çš„å­˜å‚¨ç®¡ç†ã€åˆ†ç»„æŸ¥çœ‹çš„èƒ½åŠ›ã€‚
...</p></div><footer class=entry-footer><span title='2024-06-10 00:00:00 +0000 UTC'>ğŸ¬åˆ›å»ºæ—¥æœŸ:2024-06-10</span>&nbsp|&nbspğŸ“…æœ€åæ›´æ–°:&nbsp;2024-06-10&nbsp|&nbspâ²ï¸æ—¶é•¿: 10 min&nbsp|&nbspğŸ“–å­—æ•°: 4640 words&nbsp;|&nbsp;Luenci</footer><a class=entry-link aria-label="post link to å¤œèºç›‘æ§å…¥é—¨" href=https://luenci.com/en/posts/%E5%A4%9C%E8%8E%BA%E7%9B%91%E6%8E%A7%E5%85%A5%E9%97%A8/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>k8s æ ¸å¿ƒç»„ä»¶ä»‹ç»</h2></header><div class=entry-content><p>Etcd å‚¨å­˜æ ¸å¿ƒå®ç° â€‹ Eted é›†ç¾¤æ˜¯åˆ†å¸ƒå¼KVå­˜å‚¨é›†ç¾¤ï¼Œæä¾›äº†å¯é çš„å¼ºä¸€è‡´æ€§æœåŠ¡å‘ç°ã€‚Etcd é›†ç¾¤å­˜å‚¨ Kubernetes ç³»ç»Ÿçš„é›†ç¾¤çŠ¶æ€å’Œå…ƒæ•°æ®ï¼Œå…¶ä¸­åŒ…æ‹¬æ‰€æœ‰ Kubemetes èµ„æºå¯¹è±¡ä¿¡æ¯ã€ èµ„æºå¯¹è±¡çŠ¶æ€ã€é›†ç¾¤èŠ‚ç‚¹ä¿¡æ¯ç­‰ã€‚Kubernetes å°†æ‰€æœ‰æ•°æ®å­˜å‚¨è‡³ Etcd é›†ç¾¤å‰ç¼€ä¸º /registry çš„ç›®å½•ä¸‹ã€‚
...</p></div><footer class=entry-footer><span title='2024-06-08 00:00:00 +0000 UTC'>ğŸ¬åˆ›å»ºæ—¥æœŸ:2024-06-08</span>&nbsp|&nbspğŸ“…æœ€åæ›´æ–°:&nbsp;2024-06-08&nbsp|&nbspâ²ï¸æ—¶é•¿: 3 min&nbsp|&nbspğŸ“–å­—æ•°: 1204 words&nbsp;|&nbsp;Luenci</footer><a class=entry-link aria-label="post link to k8s æ ¸å¿ƒç»„ä»¶ä»‹ç»" href=https://luenci.com/en/posts/k8s%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D%E4%B8%80/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>kustomize ä»‹ç»</h2></header><div class=entry-content><p>kustomize ä»‹ç» kustomize æ˜¯ä¸€ä¸ªé€šè¿‡ kustomization æ–‡ä»¶å®šåˆ¶ kubernetes å¯¹è±¡çš„å·¥å…·ï¼Œå®ƒå¯ä»¥é€šè¿‡ä¸€äº›èµ„æºç”Ÿæˆä¸€äº›æ–°çš„èµ„æºï¼Œä¹Ÿå¯ä»¥å®šåˆ¶ä¸åŒçš„èµ„æºçš„é›†åˆã€‚
kustomize æœ¯è¯­ kustomization kustomization æŒ‡çš„æ˜¯ kustomization.yaml æ–‡ä»¶ï¼Œæˆ–è€…æŒ‡çš„æ˜¯åŒ…å« kustomization.yaml æ–‡ä»¶çš„ç›®å½•ä»¥åŠå®ƒé‡Œé¢å¼•ç”¨çš„æ‰€æœ‰ç›¸å…³æ–‡ä»¶è·¯å¾„
...</p></div><footer class=entry-footer><span title='2024-05-28 00:00:00 +0000 UTC'>ğŸ¬åˆ›å»ºæ—¥æœŸ:2024-05-28</span>&nbsp|&nbspğŸ“…æœ€åæ›´æ–°:&nbsp;2024-05-28&nbsp|&nbspâ²ï¸æ—¶é•¿: 5 min&nbsp|&nbspğŸ“–å­—æ•°: 2060 words&nbsp;|&nbsp;Luenci</footer><a class=entry-link aria-label="post link to kustomize ä»‹ç»" href=https://luenci.com/en/posts/kustomize%E4%BB%8B%E7%BB%8D/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Prometheus å…¥é—¨å®æ“</h2></header><div class=entry-content><p>Prometheus å…¥é—¨å®æ“ å‚è€ƒæ–‡ç« ï¼šPrometheusç›‘æ§Linuxä¸»æœº - å•æŒ¯æ±Ÿ - åšå®¢å›­ (cnblogs.com)
å®‰è£… 1 2 3 4 5 6 7 8 9 # ä¸‹è½½ wget https://github.com/prometheus/prometheus/releases/download/v2.44.0/prometheus-2.44.0.linux-amd64.tar.gz # è§£å‹ tar zxf prometheus-2.44.0.linux-amd64.tar.gz # ç§»åŠ¨ mv prometheus-2.24.1.linux-amd64/* /usr/local/prometheus # å°†æœ¬æœºä¸ŠæŠ¥ sed -i 's/localhost/ä½ çš„ä¸»æœºip/g' /usr/local/prometheus/prometheus.yml å¯åŠ¨(systemedï¼Œå®ˆæŠ¤è¿›ç¨‹) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 cat &lt;&lt;EOF > /usr/lib/systemd/system/prometheus.service [Unit] Description=prometheus After=network.target [Service] Type=simple ExecStart=/usr/local/prometheus/prometheus --config.file=/usr/local/prometheus/prometheus.yml --storage.tsdb.path=/usr/local/prometheus/data/ --web.enable-lifecycle --storage.tsdb.retention.time=30d Restart=on-failure [Install] WantedBy=multi-user.target EOF systemctl daemon-reload systemctl start prometheus systemctl status prometheus && systemctl enable prometheus è®¿é—® Ip:9090
...</p></div><footer class=entry-footer>ğŸ“…æœ€åæ›´æ–°:&nbsp;0001-01-01&nbsp|&nbspâ²ï¸æ—¶é•¿: 2 min&nbsp|&nbspğŸ“–å­—æ•°: 656 words&nbsp;|&nbsp;Luenci</footer><a class=entry-link aria-label="post link to Prometheus å…¥é—¨å®æ“" href=https://luenci.com/en/posts/prometheus-%E5%85%A5%E9%97%A8%E5%AE%9E%E6%93%8D/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>k8sæ ¸å¿ƒæ•°æ®ç»“æ„ï¼ˆ2ï¼‰</h2></header><div class=entry-content><p>K8s æ ¸å¿ƒæ•°æ®ç»“æ„ï¼ˆ2ï¼‰ å‚è€ƒä¹¦ç±ï¼šã€ŠKubernetesæºç å‰–æ-éƒ‘æ—­ä¸œè‘—ã€‹
Kubernetes å†…ç½®èµ„æºæ¦‚è§ˆ èµ„æºç»„ èµ„æºç§ç±» è¯´æ˜ apiextensions.k8s.io CustomResourceDefinition è‡ªå®šä¹‰èµ„æºç±»å‹ ï¼Œ ç”± APIExtensions Server è´Ÿè´£ç®¡ç†è¯¥èµ„æºç±»å‹ apiregistration.k8s.io APIService èšåˆèµ„æºç±»å‹ï¼Œç”± AggregatorServer è´Ÿè´£ç®¡ç†è¯¥èµ„æºç±» admissionregistration.k8s.io MutatingWebhookConfiguration å˜æ›´å‡†å…¥æ§åˆ¶å™¨èµ„æºç±»å‹( Webhook) ValidatingWebhookConfiguration éªŒè¯å‡†å…¥æ§åˆ¶å™¨èµ„æºç±»å‹ ( Webhook) apps ControllerRevision è®°å½•èµ„æºå¯¹è±¡æ‰€æœ‰çš„å†å²ç‰ˆæœ¬çš„èµ„æºç±»å‹ DaemonSet åœ¨ Pod èµ„æºå¯¹è±¡çš„åŸºç¡€ä¸Šæä¾›å®ˆæŠ¤è¿›ç¨‹çš„èµ„æºç±»å‹ Deployment åœ¨ Podèµ„æºå¯¹è±¡çš„åŸºç¡€ä¸Šæä¾›æ”¯æŒæ— çŠ¶æ€æœåŠ¡çš„èµ„æºç±»å‹ ReplicaSet åœ¨ Pod èµ„æºå¯¹è±¡çš„åŸºç¡€ä¸Šæä¾›ä¸€ç»„ Pod å‰¯æœ¬çš„èµ„æºç±»å‹ StatefulSet åœ¨ Podèµ„æºå¯¹è±¡çš„åŸºç¡€ä¸Šæä¾›æ”¯æŒæœ‰çŠ¶æ€æœåŠ¡çš„èµ„æºç±»å‹ auditregistration.k8s.io AuditSink å®¡è®¡èµ„æºç±»å‹ authentication.k8s.io TokenReview è®¤è¯èµ„æºç±»å‹ authorization.k8s.io LocalSubjectAccessReview æˆæƒæ£€æŸ¥ç”¨æˆ·æ˜¯å¦å¯ä»¥åœ¨æŒ‡å®šçš„å‘½åç©ºé—´ä¸­æ‰§è¡Œæ“ä½œ SelfSubjectAccessReview æˆæƒæ£€æŸ¥ç”¨æˆ·æ˜¯å¦å¯ä»¥æ‰§è¡Œæ“ä½œ(è‹¥ä¸æŒ‡å®š spec.namespaceï¼Œåˆ™åœ¨æ‰€æœ‰çš„å‘½åç©ºé—´ä¸­æ‰§è¡Œæ“ä½œï¼‰ SelfSubjectRulesReview æˆæƒæšä¸¾ç”¨æˆ·å¯ä»¥åœ¨æŒ‡å®šçš„å‘½åç©ºé—´ä¸­æ‰§è¡Œä¸€ç»„æ“ä½œ SubjectAccessReview æˆ æƒæ£€æŸ¥ç”¨æˆ·æ˜¯å¦å¯ä»¥æ‰§è¡Œæ“ä½œ autoscaling HorizontalPodAutoscaler åœ¨ Pod èµ„æºå¯¹è±¡çš„åŸºç¡€ä¸Šæä¾›æ°´å¹³è‡ªåŠ¨ä¼¸ç¼©èµ„æºç±»å‹ batch Job æä¾›ä¸€æ¬¡æ€§ä»»åŠ¡çš„èµ„æºç±»å‹ CronJob æä¾›å®šæ—¶ä»»åŠ¡çš„èµ„æºç±»å‹ certificates.k8s.io CertificateSigningRequest æä¾›è¯ä¹¦ç®¡ç†çš„èµ„æºç±»å‹ coordination.k8s.io Leases æä¾›é¢†å¯¼è€…é€‰ä¸¾æœºåˆ¶çš„èµ„æºç±»å‹ core ComponentStatus è¯¥èµ„æºç±»å‹å·²è¢«å¥”ç”¨ï¼Œå…¶ç”¨äºæä¾›è·å– Kuberetes ç»„ä»¶è¿è¡ŒçŠ¶å†µçš„èµ„æºç±»å‹ ConfigMap æä¾›å®¹å™¨å†…åº”ç”¨ç¨‹åºé…ç½®ç®¡ç†çš„èµ„æºç±»å‹ Endpoints æä¾›å°†å¤–éƒ¨æœåŠ¡å™¨æ˜ å°„ä¸ºå†…éƒ¨æœåŠ¡çš„èµ„æºç±»å‹ Event æä¾› Kubernetes é›†ç¾¤äº‹ä»¶ç®¡ç†çš„èµ„æºç±»å‹ LimitRange ä¸ºå‘½åç©ºé—´ä¸­çš„æ¯ç§èµ„æºå¯¹è±¡è®¾ç½®èµ„æº(ç¡¬ä»¶èµ„æº)ä½¿ ç”¨é™åˆ¶ Namespace æä¾›èµ„æºå¯¹è±¡æ‰€åœ¨çš„å‘½åç©ºé—´çš„èµ„æºç±»å‹ Node æä¾› Kubernetes é›†ç¾¤ä¸­ç®¡ç†å·¥ä½œèŠ‚ç‚¹çš„èµ„æºç±»å‹ã€‚æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ç¬¦ PersistentVolume æä¾› PV å­˜å‚¨çš„èµ„æºç±»å‹ PersistentVolumeClaim æä¾› PVC å­˜å‚¨çš„èµ„æºç±»å‹ Pod æä¾›å®¹å™¨é›†åˆç®¡ç†çš„èµ„æºç±»å‹ PodTemplate æä¾›ç”¨äºæè¿°é¢„å®šä¹‰ Pod èµ„æºå¯¹è±¡å‰¯æœ¬æ•°æ¨¡æ¿çš„èµ„æºç±»å‹ ReplicationController åœ¨ Podèµ„æºå¯¹è±¡çš„åŸºç¡€ä¸Šæä¾›å‰¯æœ¬æ•°ä¿æŒä¸å˜çš„èµ„æºç±»å‹ ResourceQuota æä¾›æ¯ä¸ªå‘½åç©ºé—´é…é¢é™åˆ¶çš„èµ„æºç±»å‹ Secret æä¾›å­˜å‚¨å¯†ç  ã€Token ã€å¯†é’¥ç­‰æ•æ„Ÿæ•°æ®çš„èµ„æºç±»å‹ Service æä¾›è´Ÿè½½å‡è¡¡å™¨ä¸º Pod èµ„æºå¯¹è±¡çš„ä»£ç†æœåŠ¡çš„èµ„æºç±»å‹ ServiceAccount æä¾› ServiceAccount è®¤è¯çš„èµ„æºç±»å‹ events.k8s.io Event æä¾›Kuberetesé›†ç¾¤äº‹ä»¶ç®¡ç†çš„èµ„æºç±»å‹ networking.k8s.io RuntimeClass æä¾›å®¹å™¨è¿è¡Œæ—¶åŠŸèƒ½çš„èµ„æºç±»å‹ Ingress æä¾› ä»Kubernetes é›†ç¾¤å¤–éƒ¨è®¿é—®é›†ç¾¤å†…éƒ¨æœåŠ¡ç®¡ç†çš„èµ„æºç±»å‹ node.k8s.io RuntimeClass æä¾›å®¹å™¨è¿è¡Œæ—¶åŠŸèƒ½çš„èµ„æºç±»å‹ policy Evictions åœ¨ Pod èµ„æºå¯¹è±¡çš„åŸºç¡€ä¸Šæä¾›é©±é€ç­–ç•¥çš„èµ„æºç±»å‹ PodDisruptionBudget æä¾›é™åˆ¶åŒæ—¶ä¸­æ–­ Pod çš„æ•°é‡ ï¼Œä»¥ä¿è¯é›†ç¾¤çš„é«˜å¯ç”¨æ€§ PodSecurityPolicy æä¾›æ§åˆ¶ Pod èµ„æºå®‰å…¨ç›¸å…³ç­–ç•¥çš„èµ„æºç±»å‹ rbac.authorization.k8s.io ClusterRole æä¾› RBAC é›†ç¾¤è§’è‰²çš„èµ„æºç±»å‹ ClusterRoleBinding æä¾› RBAC é›†ç¾¤è§’è‰²é„‰å®šçš„èµ„æºç±»å‹ Role æä¾› RBAC è§’è‰²çš„èµ„æºç±»å‹ RoleBinding æä¾› RBAC è§’è‰²ç»‘å®šçš„èµ„æºç±»å‹ scheduling.k8s.io PriorityClass æä¾› Pod èµ„æºå¯¹è±¡ä¼˜å…ˆçº§ç®¡ç†çš„èµ„æºç±»å‹ settings.k8s.10 PodPreset åœ¨åˆ›å»º Pod èµ„æºå¯¹è±¡æ—¶ï¼Œå¯ä»¥å°†ç‰¹å®šä¿¡æ¯æ³¨å…¥ Pod èµ„æºå¯¹è±¡ä¸­ storage.k8s.io StorageClass æä¾›åŠ¨æ€è®¾ç½®PVå­˜å‚¨å‚æ•°çš„èµ„æºç±» VolumeAttachment ä¾›è§¦å‘ CSI ControllerPublish å’Œ ControllerUnpublish æ“ä½œçš„èµ„æºç±»å‹ ...</p></div><footer class=entry-footer><span title='2024-05-20 00:00:00 +0000 UTC'>ğŸ¬åˆ›å»ºæ—¥æœŸ:2024-05-20</span>&nbsp|&nbspğŸ“…æœ€åæ›´æ–°:&nbsp;2024-05-20&nbsp|&nbspâ²ï¸æ—¶é•¿: 24 min&nbsp|&nbspğŸ“–å­—æ•°: 11761 words&nbsp;|&nbsp;Luenci</footer><a class=entry-link aria-label="post link to k8sæ ¸å¿ƒæ•°æ®ç»“æ„ï¼ˆ2ï¼‰" href=https://luenci.com/en/posts/k8s%E6%A0%B8%E5%BF%83%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%842/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>k8sæ ¸å¿ƒæ•°æ®ç»“æ„ï¼ˆ1ï¼‰</h2></header><div class=entry-content><p>Kubernetes æ ¸å¿ƒæ•°æ®ç»“æ„ï¼ˆ1ï¼‰ å‚è€ƒä¹¦ç±ï¼šã€ŠKubernetesæºç å‰–æ-éƒ‘æ—­ä¸œè‘—ã€‹
K8s æ˜¯ä¸€ä¸ªå®Œå…¨ä»¥èµ„æºä¸ºä¸­å¿ƒçš„ç³»ç»Ÿ
Groupã€Versionã€Resource æ ¸å¿ƒæ•°æ®ç»“æ„ â€‹ Kuberetes ç³»ç»Ÿè™½ç„¶æœ‰ç›¸å½“å¤æ‚å’Œä¼—å¤šçš„ åŠŸèƒ½ï¼Œä½†å®ƒæœ¬è´¨ ä¸Šæ˜¯ä¸€ä¸ªèµ„æºæ§åˆ¶ç³»ç»Ÿâ€”â€”æ³¨å†Œã€ç®¡ç†ã€è°ƒåº¦èµ„æº å¹¶ç»´æŠ¤èµ„æºçš„çŠ¶æ€ã€‚
â€‹ Kuberetes å°†èµ„æºå†æ¬¡åˆ†ç»„å’Œç‰ˆæœ¬åŒ–ï¼Œå½¢æˆ Groupï¼ˆèµ„æºç»„ï¼‰ã€Versionï¼ˆèµ„æºç‰ˆæœ¬ï¼‰ã€Resourceï¼ˆèµ„æºï¼‰
Group: è¢«ç§°ä¸ºèµ„æºç»„ï¼Œåœ¨Kubernetes API Server ä¸­ä¹Ÿå¯ç§°å…¶ä¸º APIGroupã€‚ Version: è¢«ç§°ä¸ºèµ„æºç‰ˆæœ¬ï¼Œåœ¨Kubernetes API Server ä¸­ä¹Ÿå¯ç§°å…¶ä¸º APIVersionsã€‚ Resource: è¢«ç§°ä¸ºèµ„æºï¼Œåœ¨Kubernetes API Server ä¸­ä¹Ÿå¯ç§°å…¶ä¸º APIResourceã€‚ Kind: èµ„æºç§ç±»ï¼Œæè¿° Resource çš„ç§ç±»ï¼Œä¸ Resource ä¸ºåŒä¸€çº§åˆ«ã€‚ â€‹
â€‹ Kubernetes ç³»ç»Ÿæ”¯æŒå¤šä¸ªGroupï¼Œæ¯ä¸ªGroup æ”¯æŒå¤šä¸ªVersionï¼Œæ¯ä¸ªVersion æ”¯ æŒå¤šä¸ªResourceï¼Œå…¶ä¸­éƒ¨åˆ†èµ„æºåŒæ—¶ä¼šæ‹¥æœ‰è‡ªå·±çš„å­èµ„æº(å³SubResource )ã€‚ä¾‹å¦‚ï¼Œ Deploymentèµ„æºæ‹¥æœ‰Status å­èµ„æºã€‚ â€‹ èµ„æºç»„ã€èµ„æºç‰ˆæœ¬ã€èµ„æºã€å­èµ„æºçš„å®Œæ•´è¡¨ç°å½¢å¼&lt;group>/&lt;version>/&lt;resource>/ &lt;subresource>ã€‚ä»¥å¸¸ç”¨çš„ Deployment èµ„æºä¸ºä¾‹ï¼Œå…¶å®Œæ•´è¡¨ç°å½¢å¼ä¸ºapps/v1/deployments/status
â€‹ å¦å¤–èµ„æºå¯¹è±¡(Resource Object )åœ¨æœ¬ä¹¦ä¸­ä¹Ÿæ˜¯ ä¸€ä¸ªå¸¸ç”¨æ¦‚å¿µï¼Œç”±â€œ èµ„æºç»„+ èµ„æºç‰ˆæœ¬+èµ„æºç§ç±»â€ ç»„æˆï¼Œå¹¶åœ¨å®ä¾‹åŒ–åè¡¨è¾¾ä¸€ä¸ªèµ„æºå¯¹è±¡ï¼Œä¾‹å¦‚ Deployment èµ„æºå®ä¾‹åŒ–åæ‹¥æœ‰èµ„æºç»„ã€èµ„æºç‰ˆæœ¬åŠèµ„æºç§ç±»ï¼Œå…¶è¡¨ç°å½¢å¼ä¸º&lt;group>/&lt;version>, Kind=&lt;kind>ï¼Œä¾‹å¦‚apps/v1, Kind=Deployment.
â€‹ æ¯ä¸€ä¸ªèµ„æºéƒ½æ‹¥æœ‰ä¸€å®šæ•°é‡çš„èµ„æºæ“ä½œæ–¹æ³•(å³ Verbs )ï¼Œèµ„æºæ“ä½œæ–¹æ³•ç”¨äº Etcd é›†ç¾¤å­˜å‚¨ä¸­å¯¹èµ„æºå¯¹è±¡çš„å¢ã€åˆ ã€æ”¹ã€æŸ¥æ“ä½œã€‚ç›®å‰ Kubemetes ç³»ç»Ÿæ”¯æŒ8 ç§èµ„æºæ“ä½œæ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯ createã€deleteã€deleteã€collectionã€getã€listã€patchã€updateã€watch æ“ä½œæ–¹æ³•ã€‚
â€‹ æ¯ä¸€ä¸ªèµ„æºéƒ½è‡³å°‘æœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼Œåˆ†åˆ«æ˜¯å¤–éƒ¨ç‰ˆæœ¬(External Version)å’Œå†…éƒ¨ç‰ˆæœ¬ ( Internal Version )ã€‚å¤–éƒ¨ç‰ˆæœ¬ç”¨äºå¯¹å¤–æš´éœ²ç»™ç”¨æˆ·è¯·æ±‚çš„æ¥åˆæ‰€ä½¿ç”¨çš„èµ„æºå¯¹è±¡ã€‚å†…éƒ¨ç‰ˆæœ¬ä¸å¯¹å¤–æš´éœ²ï¼Œä»…åœ¨Kubernetes API Server å†…éƒ¨ä½¿ç”¨ã€‚
â€‹ Kubernetes èµ„æºä¹Ÿå¯åˆ†ä¸ºä¸¤ç§ï¼Œ åˆ†åˆ«æ˜¯Kubernetes Resource (Kubermetes å†…ç½èµ„æº ) å’Œ Custom Resource( è‡ª å®š ä¹‰ èµ„ æº )ã€‚ å¼€ å‘ è€… é€š è¿‡ C R D ( å³ Custom Resource Definitions )å¯å®ç°è‡ªå®šä¹‰èµ„æºï¼Œå®ƒå…è®¸ç”¨æˆ·å°†è‡ªå·±å®šä¹‰çš„èµ„æºæ·»åŠ åˆ° Kubernetes ç³»ç»Ÿä¸­ï¼Œå¹¶åƒä½¿ç”¨ Kubernetes å†…ç½®èµ„æº ä¸€æ ·ä½¿ç”¨å®ƒä»¬ã€‚
...</p></div><footer class=entry-footer><span title='2024-05-18 00:00:00 +0000 UTC'>ğŸ¬åˆ›å»ºæ—¥æœŸ:2024-05-18</span>&nbsp|&nbspğŸ“…æœ€åæ›´æ–°:&nbsp;2024-05-18&nbsp|&nbspâ²ï¸æ—¶é•¿: 19 min&nbsp|&nbspğŸ“–å­—æ•°: 9050 words&nbsp;|&nbsp;Luenci</footer><a class=entry-link aria-label="post link to k8sæ ¸å¿ƒæ•°æ®ç»“æ„ï¼ˆ1ï¼‰" href=https://luenci.com/en/posts/k8s%E6%A0%B8%E5%BF%83%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%841/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>k8sæ¶æ„ä»‹ç»</h2></header><div class=entry-content><p>K8s æ¶æ„ å‚è€ƒæ–‡ç« ï¼šKubernetesæºç å‰–æ
æ¶æ„æ¦‚è§ˆ â€‹ Kubernetes ç³»ç»Ÿæ¶æ„éµå¾ªå®¢æˆ·ç«¯ / æœåŠ¡ç«¯ ï¼ˆ C/S ï¼‰ æ¶æ„ ï¼Œ ç³»ç»Ÿæ¶æ„åˆ†ä¸º Master å’Œ Node ä¸¤éƒ¨åˆ† ï¼Œ Master ä½œä¸ºæœåŠ¡ç«¯ ï¼Œ Node ä½œä¸ºå®¢æˆ·ç«¯ ã€‚ Kubernetes ç³»ç»Ÿå…·æœ‰å¤šä¸ª Master æœåŠ¡ç«¯ ï¼Œ å¯ä»¥å®ç°é«˜å¯ç”¨ ã€‚ åœ¨é»˜è®¤çš„æƒ…å†µä¸‹ ï¼Œ ä¸€ä¸ª Master æœåŠ¡ç«¯å³å¯å®Œæˆæ‰€æœ‰å·¥ä½œ ã€‚
æœåŠ¡ç«¯ä¹Ÿè¢«ç§°ä¸ºä¸»æ§èŠ‚ç‚¹ ï¼Œ å®ƒåœ¨é›†ç¾¤ä¸­ä¸»è¦è´Ÿè´£å¦‚ä¸‹ä»»åŠ¡ ã€‚
é›†ç¾¤çš„ â€œ å¤§è„‘ â€ ï¼Œ è´Ÿè´£ç®¡ç†æ‰€æœ‰èŠ‚ç‚¹ (Nodeï¼‰ã€‚ è´Ÿè´£è°ƒåº¦ Pod åœ¨å“ªäº›èŠ‚ç‚¹ä¸Šè¿è¡Œ ã€‚ è´Ÿè´£æ§åˆ¶é›†ç¾¤è¿è¡Œè¿‡ç¨‹ä¸­çš„æ‰€æœ‰çŠ¶æ€ ã€‚ Node å®¢æˆ·ç«¯ä¹Ÿè¢«ç§°ä¸ºå·¥ä½œèŠ‚ç‚¹ ï¼Œ å®ƒåœ¨é›†ç¾¤ä¸­ä¸»è¦è´Ÿè´£å¦‚ä¸‹ä»»åŠ¡ ã€‚
è´Ÿè´£ç®¡ç†æ‰€æœ‰å®¹å™¨ ï¼ˆ container ) ã€‚ è´Ÿè´£ç›‘æ§ / ä¸ŠæŠ¥æ‰€æœ‰ Pod çš„è¿è¡ŒçŠ¶æ€ ã€‚ ç»„ä»¶æ¦‚è§ˆ ...</p></div><footer class=entry-footer><span title='2024-05-15 00:00:00 +0000 UTC'>ğŸ¬åˆ›å»ºæ—¥æœŸ:2024-05-15</span>&nbsp|&nbspğŸ“…æœ€åæ›´æ–°:&nbsp;2024-05-15&nbsp|&nbspâ²ï¸æ—¶é•¿: 8 min&nbsp|&nbspğŸ“–å­—æ•°: 3734 words&nbsp;|&nbsp;Luenci</footer><a class=entry-link aria-label="post link to k8sæ¶æ„ä»‹ç»" href=https://luenci.com/en/posts/k8s%E6%9E%B6%E6%9E%84%E4%BB%8B%E7%BB%8D/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>GO ä¸‰æ–¹åº“æºç é˜…è¯»å§¿åŠ¿</h2></header><div class=entry-content><p>GO ä¸‰æ–¹åº“æºç é˜…è¯»å§¿åŠ¿ å‚è€ƒå†…å®¹ï¼šæå®¢ä¸“æ ï¼šæ‰‹æŠŠæ‰‹å¸¦ä½ å†™ä¸€ä¸ªwebæ¡†æ¶
é˜…è¯»é¡ºåº åº“å‡½æ•° > ç»“æ„å®šä¹‰ > ç»“æ„å‡½æ•°ã€‚
â€‹ ç®€å•æ¥è¯´ï¼Œå°±æ˜¯å½“ä½ åœ¨é˜…è¯»ä¸€ä¸ªä»£ç åº“çš„æ—¶å€™ï¼Œä¸åº”è¯¥ä»ä¸Šåˆ°ä¸‹é˜…è¯»æ•´ä¸ªä»£ç æ–‡æ¡£ï¼Œè€Œåº” è¯¥å…ˆé˜…è¯»æ•´ä¸ªä»£ç åº“æä¾›çš„å¯¹å¤–åº“å‡½æ•°(function)ï¼Œå†è¯»è¿™ä¸ªåº“æä¾›çš„ç»“æ„ (struct/class)ï¼Œæœ€åå†é˜…è¯»æ¯ä¸ªç»“æ„å‡½æ•°(method)
æŸ¥çœ‹åº“å‡½æ•° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 go doc net/http(ä¸‰æ–¹åº“åç§°) | grep "^func" func CanonicalHeaderKey(s string) string func DetectContentType(data []byte) string func Error(w ResponseWriter, error string, code int) func Get(url string) (resp *Response, err error) func Handle(pattern string, handler Handler) func HandleFunc(pattern string, handler func(ResponseWriter, *Request)) func Head(url string) (resp *Response, err error) func ListenAndServe(addr string, handler Handler) error func ListenAndServeTLS(addr, certFile, keyFile string, handler Handler) error func MaxBytesReader(w ResponseWriter, r io.ReadCloser, n int64) io.ReadCloser func NewRequest(method, url string, body io.Reader) (*Request, error) func NewRequestWithContext(ctx context.Context, method, url string, body io.Reader) (*Request, error) func NotFound(w ResponseWriter, r *Request) func ParseHTTPVersion(vers string) (major, minor int, ok bool) func ParseTime(text string) (t time.Time, err error) func Post(url, contentType string, body io.Reader) (resp *Response, err error) func PostForm(url string, data url.Values) (resp *Response, err error) func ProxyFromEnvironment(req *Request) (*url.URL, error) func ProxyURL(fixedURL *url.URL) func(*Request) (*url.URL, error) func ReadRequest(b *bufio.Reader) (*Request, error) func ReadResponse(r *bufio.Reader, req *Request) (*Response, error) func Redirect(w ResponseWriter, r *Request, url string, code int) func Serve(l net.Listener, handler Handler) error func ServeContent(w ResponseWriter, req *Request, name string, modtime time.Time, ...) func ServeFile(w ResponseWriter, r *Request, name string) func ServeTLS(l net.Listener, handler Handler, certFile, keyFile string) error func SetCookie(w ResponseWriter, cookie *Cookie) func StatusText(code int) string â€‹ åœ¨è¿™ä¸ªåº“æä¾›çš„æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å»æ‰ä¸€äº› New å’Œ Set å¼€å¤´çš„å‡½æ•°ï¼Œå› ä¸ºä½ ä»å‘½åä¸Šå¯ä»¥çœ‹å‡ºï¼Œè¿™äº›å‡½æ•°æ˜¯å¯¹æŸä¸ªå¯¹è±¡æˆ–è€…å±æ€§çš„è®¾ç½®ã€‚
å‰©ä¸‹çš„å‡½æ•°å¤§è‡´å¯ä»¥åˆ†æˆä¸‰ç±»:
ä¸ºæœåŠ¡ç«¯æä¾›åˆ›å»º HTTP æœåŠ¡çš„å‡½æ•°ï¼Œåå­—ä¸­ä¸€èˆ¬åŒ…å« Serve å­—æ ·ï¼Œæ¯”å¦‚ Serveã€ ServeFileã€ListenAndServe ç­‰ã€‚
ä¸ºå®¢æˆ·ç«¯æä¾›è°ƒç”¨ HTTP æœåŠ¡çš„ç±»åº“ï¼Œä»¥ HTTP çš„ method åŒåï¼Œæ¯”å¦‚ Getã€Postã€ Head ç­‰ã€‚
æä¾›ä¸­è½¬ä»£ç†çš„ä¸€äº›å‡½æ•°ï¼Œæ¯”å¦‚ ProxyURLã€ProxyFromEnvironment ç­‰ã€‚
æŸ¥çœ‹ç»“æ„å®šä¹‰(æ¨¡å—) â€‹ æˆ‘ä»¬è¿‡ä¸€éè¿™ä¸ªåº“æä¾›çš„æ‰€æœ‰ structï¼Œçœ‹çœ‹æ ¸å¿ƒæ¨¡å—æœ‰å“ªäº›ï¼ŒåŒæ ·ä½¿ç”¨ go doc:
1 go doc net/http | grep "^type"| grep struct â€‹ å¯ä»¥çœ‹åˆ°æ•´ä¸ªåº“æœ€æ ¸å¿ƒçš„å‡ ä¸ªç»“æ„:
1 2 3 4 5 6 7 8 9 10 type Client struct{ ... } type Cookie struct{ ... } type MaxBytesError struct{ ... } type ProtocolError struct{ ... } type PushOptions struct{ ... } type Request struct{ ... } type Response struct{ ... } type ServeMux struct{ ... } type Server struct{ ... } type Transport struct{ ... } çœ‹ç»“æ„çš„åå­—æˆ–è€… go doc æŸ¥çœ‹ç»“æ„è¯´æ˜æ–‡æ¡£ï¼Œèƒ½é€æ¸äº†è§£å®ƒä»¬çš„åŠŸèƒ½:
Client è´Ÿè´£æ„å»º HTTP å®¢æˆ·ç«¯;
Server è´Ÿè´£æ„å»º HTTP æœåŠ¡ç«¯;
ServerMux è´Ÿè´£ HTTP æœåŠ¡ç«¯è·¯ç”±;
Transportã€Requestã€Responseã€Cookie è´Ÿè´£å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¼ è¾“å¯¹åº”çš„ä¸åŒæ¨¡å—ã€‚
â€‹ ç°åœ¨é€šè¿‡åº“æ–¹æ³•(function)å’Œç»“æ„ä½“(struct)ï¼Œæˆ‘ä»¬å¯¹æ•´ä¸ªåº“çš„ç»“æ„å’ŒåŠŸèƒ½æœ‰å¤§è‡´å°è±¡ äº†ã€‚æ•´ä¸ªåº“æ‰¿æ‹…äº†ä¸¤éƒ¨åˆ†åŠŸèƒ½ï¼Œä¸€éƒ¨åˆ†æ˜¯æ„å»º HTTP å®¢æˆ·ç«¯ï¼Œä¸€éƒ¨åˆ†æ˜¯æ„å»º HTTP æœåŠ¡ ç«¯ã€‚
â€‹ æ„å»ºçš„ HTTP æœåŠ¡ç«¯é™¤äº†æä¾›çœŸå®æœåŠ¡ä¹‹å¤–ï¼Œä¹Ÿèƒ½æä¾›ä»£ç†ä¸­è½¬æœåŠ¡ï¼Œå®ƒä»¬åˆ†åˆ«ç”± Client å’Œ Server ä¸¤ä¸ªæ•°æ®ç»“æ„è´Ÿè´£ã€‚é™¤äº†è¿™ä¸¤ä¸ªæœ€é‡è¦çš„æ•°æ®ç»“æ„ä¹‹å¤–ï¼ŒHTTP åè®®çš„æ¯ä¸ªéƒ¨ åˆ†ï¼Œæ¯”å¦‚è¯·æ±‚ã€è¿”å›ã€ä¼ è¾“è®¾ç½®ç­‰éƒ½æœ‰å…·ä½“çš„æ•°æ®ç»“æ„è´Ÿè´£ã€‚
...</p></div><footer class=entry-footer>ğŸ“…æœ€åæ›´æ–°:&nbsp;0001-01-01&nbsp|&nbspâ²ï¸æ—¶é•¿: 3 min&nbsp|&nbspğŸ“–å­—æ•°: 1271 words&nbsp;|&nbsp;Luenci</footer><a class=entry-link aria-label="post link to GO ä¸‰æ–¹åº“æºç é˜…è¯»å§¿åŠ¿" href=https://luenci.com/en/posts/go%E4%B8%89%E6%96%B9%E5%BA%93%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E5%A7%BF%E5%8A%BF/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>K8sçš„Podåˆ›å»ºå†ç¨‹</h2></header><div class=entry-content><p>K8såˆ›å»ºPodçš„å†ç¨‹ å‚è€ƒåŸæ–‡ï¼šhttps://icloudnative.io/posts/what-happens-when-k8s/#span-idinline-toc1span-kubectl
1. kubectl éªŒè¯å’Œç”Ÿæˆå™¨ â€‹ å½“æ•²ä¸‹å›è½¦é”®ä»¥åï¼Œkubectl é¦–å…ˆä¼šæ‰§è¡Œä¸€äº›å®¢æˆ·ç«¯éªŒè¯æ“ä½œï¼Œä»¥ç¡®ä¿ä¸åˆæ³•çš„è¯·æ±‚ï¼ˆä¾‹å¦‚ï¼Œåˆ›å»ºä¸æ”¯æŒçš„èµ„æºæˆ–ä½¿ç”¨æ ¼å¼é”™è¯¯çš„é•œåƒåç§°ï¼‰å°†ä¼šå¿«é€Ÿå¤±è´¥ï¼Œä¹Ÿä¸ä¼šå‘é€ç»™ kube-apiserverã€‚é€šè¿‡å‡å°‘ä¸å¿…è¦çš„è´Ÿè½½æ¥æé«˜ç³»ç»Ÿæ€§èƒ½ã€‚
â€‹ éªŒè¯é€šè¿‡ä¹‹åï¼Œ kubectl å¼€å§‹å°†å‘é€ç»™ kube-apiserver çš„ HTTP è¯·æ±‚è¿›è¡Œå°è£…ã€‚kube-apiserver ä¸ etcd è¿›è¡Œé€šä¿¡ï¼Œæ‰€æœ‰å°è¯•è®¿é—®æˆ–æ›´æ”¹ Kubernetes ç³»ç»ŸçŠ¶æ€çš„è¯·æ±‚éƒ½ä¼šé€šè¿‡ kube-apiserver è¿›è¡Œï¼Œkubectl ä¹Ÿä¸ä¾‹å¤–ã€‚kubectl ä½¿ç”¨ç”Ÿæˆå™¨ï¼ˆ generatorsï¼‰æ¥æ„é€  HTTP è¯·æ±‚ã€‚ç”Ÿæˆå™¨æ˜¯ä¸€ä¸ªç”¨æ¥å¤„ç†åºåˆ—åŒ–çš„æŠ½è±¡æ¦‚å¿µã€‚
â€‹ é€šè¿‡ kubectl run ä¸ä»…å¯ä»¥è¿è¡Œ deploymentï¼Œè¿˜å¯ä»¥é€šè¿‡æŒ‡å®šå‚æ•° --generator æ¥éƒ¨ç½²å…¶ä»–å¤šç§èµ„æºç±»å‹ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®š --generator å‚æ•°çš„å€¼ï¼Œkubectl å°†ä¼šè‡ªåŠ¨åˆ¤æ–­èµ„æºçš„ç±»å‹ã€‚
â€‹ ä¾‹å¦‚ï¼Œå¸¦æœ‰å‚æ•° --restart-policy=Always çš„èµ„æºå°†è¢«éƒ¨ç½²ä¸º Deploymentï¼Œè€Œå¸¦æœ‰å‚æ•° --restart-policy=Never çš„èµ„æºå°†è¢«éƒ¨ç½²ä¸º Podã€‚åŒæ—¶ kubectl ä¹Ÿä¼šæ£€æŸ¥æ˜¯å¦éœ€è¦è§¦å‘å…¶ä»–æ“ä½œï¼Œä¾‹å¦‚è®°å½•å‘½ä»¤ï¼ˆç”¨æ¥è¿›è¡Œå›æ»šæˆ–å®¡è®¡ï¼‰ã€‚
â€‹ åœ¨ kubectl åˆ¤æ–­å‡ºè¦åˆ›å»ºä¸€ä¸ª Deployment åï¼Œå®ƒå°†ä½¿ç”¨ DeploymentV1Beta1 ç”Ÿæˆå™¨ä»æˆ‘ä»¬æä¾›çš„å‚æ•°ä¸­ç”Ÿæˆä¸€ä¸ª è¿è¡Œæ—¶å¯¹è±¡ã€‚
API ç‰ˆæœ¬åå•†ä¸ API ç»„ â€‹ ä¸ºäº†æ›´å®¹æ˜“åœ°æ¶ˆé™¤å­—æ®µæˆ–è€…é‡æ–°ç»„ç»‡èµ„æºç»“æ„ï¼ŒKubernetes æ”¯æŒå¤šä¸ª API ç‰ˆæœ¬ï¼Œæ¯ä¸ªç‰ˆæœ¬éƒ½åœ¨ä¸åŒçš„ API è·¯å¾„ä¸‹ï¼Œä¾‹å¦‚ /api/v1 æˆ–è€… /apis/extensions/v1beta1ã€‚ä¸åŒçš„ API ç‰ˆæœ¬è¡¨æ˜ä¸åŒçš„ç¨³å®šæ€§å’Œæ”¯æŒçº§åˆ«ï¼Œæ›´è¯¦ç»†çš„æè¿°å¯ä»¥å‚è€ƒ Kubernetes API æ¦‚è¿°ã€‚
â€‹ API ç»„æ—¨åœ¨å¯¹ç±»ä¼¼èµ„æºè¿›è¡Œåˆ†ç±»ï¼Œä»¥ä¾¿ä½¿å¾— Kubernetes API æ›´å®¹æ˜“æ‰©å±•ã€‚API çš„ç»„ååœ¨ REST è·¯å¾„æˆ–è€…åºåˆ—åŒ–å¯¹è±¡çš„ apiVersion å­—æ®µä¸­æŒ‡å®šã€‚ä¾‹å¦‚ï¼ŒDeployment çš„ API ç»„åæ˜¯ appsï¼Œæœ€æ–°çš„ API ç‰ˆæœ¬æ˜¯ v1beta2ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ è¦åœ¨ Deployment manifests é¡¶éƒ¨è¾“å…¥ apiVersion: apps/v1beta2ã€‚
â€‹ kubectl åœ¨ç”Ÿæˆè¿è¡Œæ—¶å¯¹è±¡åï¼Œå¼€å§‹ä¸ºå®ƒ æ‰¾åˆ°é€‚å½“çš„ API ç»„å’Œ API ç‰ˆæœ¬ï¼Œç„¶å ç»„è£…æˆä¸€ä¸ªç‰ˆæœ¬åŒ–å®¢æˆ·ç«¯ï¼Œè¯¥å®¢æˆ·ç«¯çŸ¥é“èµ„æºçš„å„ç§ REST è¯­ä¹‰ã€‚è¯¥é˜¶æ®µè¢«ç§°ä¸ºç‰ˆæœ¬åå•†ï¼Œkubectl ä¼šæ‰«æ remote API ä¸Šçš„ /apis è·¯å¾„æ¥æ£€ç´¢æ‰€æœ‰å¯èƒ½çš„ API ç»„ã€‚ç”±äº kube-apiserver åœ¨ /apis è·¯å¾„ä¸Šå…¬å¼€äº† OpenAPI æ ¼å¼çš„è§„èŒƒæ–‡æ¡£ï¼Œ å› æ­¤å®¢æˆ·ç«¯å¾ˆå®¹æ˜“æ‰¾åˆ°åˆé€‚çš„ APIã€‚
â€‹ ä¸ºäº†æé«˜æ€§èƒ½ï¼Œkubectl å°† OpenAPI è§„èŒƒç¼“å­˜åˆ°äº† ~/.kube/cache ç›®å½•ã€‚å¦‚æœä½ æƒ³äº†è§£ API å‘ç°çš„è¿‡ç¨‹ï¼Œè¯·å°è¯•åˆ é™¤è¯¥ç›®å½•å¹¶åœ¨è¿è¡Œ kubectl å‘½ä»¤æ—¶å°† -v å‚æ•°çš„å€¼è®¾ä¸ºæœ€å¤§å€¼ï¼Œç„¶åä½ å°†ä¼šçœ‹åˆ°æ‰€æœ‰è¯•å›¾æ‰¾åˆ°è¿™äº› API ç‰ˆæœ¬çš„HTTP è¯·æ±‚ã€‚å‚è€ƒ kubectl å¤‡å¿˜å•ã€‚
â€‹ æœ€åä¸€æ­¥æ‰æ˜¯çœŸæ­£åœ°å‘é€ HTTP è¯·æ±‚ã€‚ä¸€æ—¦è¯·æ±‚å‘é€ä¹‹åè·å¾—æˆåŠŸçš„å“åº”ï¼Œkubectl å°†ä¼šæ ¹æ®æ‰€éœ€çš„è¾“å‡ºæ ¼å¼æ‰“å° success messageã€‚
å®¢æˆ·ç«¯èº«ä»½è®¤è¯ åœ¨å‘é€ HTTP è¯·æ±‚ä¹‹å‰è¿˜è¦è¿›è¡Œå®¢æˆ·ç«¯è®¤è¯ï¼Œè¿™æ˜¯ä¹‹å‰æ²¡æœ‰æåˆ°çš„ï¼Œç°åœ¨å¯ä»¥æ¥çœ‹ä¸€ä¸‹ã€‚
ä¸ºäº†èƒ½å¤ŸæˆåŠŸå‘é€è¯·æ±‚ï¼Œkubectl éœ€è¦å…ˆè¿›è¡Œèº«ä»½è®¤è¯ã€‚ç”¨æˆ·å‡­è¯ä¿å­˜åœ¨ kubeconfig æ–‡ä»¶ä¸­ï¼Œkubectl é€šè¿‡ä»¥ä¸‹é¡ºåºæ¥æ‰¾åˆ° kubeconfig æ–‡ä»¶ï¼š
å¦‚æœæä¾›äº† --kubeconfig å‚æ•°ï¼Œ kubectl å°±ä½¿ç”¨ â€“kubeconfig å‚æ•°æä¾›çš„ kubeconfig æ–‡ä»¶ã€‚ å¦‚æœæ²¡æœ‰æä¾› â€“kubeconfig å‚æ•°ï¼Œä½†è®¾ç½®äº†ç¯å¢ƒå˜é‡ $KUBECONFIGï¼Œåˆ™ä½¿ç”¨è¯¥ç¯å¢ƒå˜é‡æä¾›çš„ kubeconfig æ–‡ä»¶ã€‚ å¦‚æœ â€“kubeconfig å‚æ•°å’Œç¯å¢ƒå˜é‡ $KUBECONFIG éƒ½æ²¡æœ‰æä¾›ï¼Œkubectl å°±ä½¿ç”¨é»˜è®¤çš„ kubeconfig æ–‡ä»¶ $HOME/.kube/configã€‚ è§£æå®Œ kubeconfig æ–‡ä»¶åï¼Œkubectl ä¼šç¡®å®šå½“å‰è¦ä½¿ç”¨çš„ä¸Šä¸‹æ–‡ã€å½“å‰æŒ‡å‘çš„ç¾¤é›†ä»¥åŠä¸å½“å‰ç”¨æˆ·å…³è”çš„ä»»ä½•è®¤è¯ä¿¡æ¯ã€‚å¦‚æœç”¨æˆ·æä¾›äº†é¢å¤–çš„å‚æ•°ï¼ˆä¾‹å¦‚ â€“usernameï¼‰ï¼Œåˆ™ä¼˜å…ˆä½¿ç”¨è¿™äº›å‚æ•°è¦†ç›– kubeconfig ä¸­æŒ‡å®šçš„å€¼ã€‚ä¸€æ—¦æ‹¿åˆ°è¿™äº›ä¿¡æ¯ä¹‹åï¼Œ kubectl å°±ä¼šæŠŠè¿™äº›ä¿¡æ¯å¡«å……åˆ°å°†è¦å‘é€çš„ HTTP è¯·æ±‚å¤´ä¸­ï¼š
x509 è¯ä¹¦ä½¿ç”¨ tls.TLSConfig å‘é€ï¼ˆåŒ…æ‹¬ CA è¯ä¹¦ï¼‰ã€‚ bearer tokens åœ¨ HTTP è¯·æ±‚å¤´ Authorization ä¸­ å‘é€ã€‚ ç”¨æˆ·åå’Œå¯†ç é€šè¿‡ HTTP åŸºæœ¬è®¤è¯ å‘é€ã€‚ OpenID è®¤è¯è¿‡ç¨‹æ˜¯ç”±ç”¨æˆ·äº‹å…ˆæ‰‹åŠ¨å¤„ç†çš„ï¼Œäº§ç”Ÿä¸€ä¸ªåƒ bearer token ä¸€æ ·è¢«å‘é€çš„ tokenã€‚ å°ç»“è¡¥å…… â€‹ å¦‚æœè¦å¯¹k8sçš„éƒ¨ç½²æ–‡ä»¶è¿›è¡Œè¿›ä¸€æ­¥æ­£ç¡®æ€§æ ¡éªŒï¼Œå¯ä»¥å‚çœ‹è¿™ä¸ªKubeval
...</p></div><footer class=entry-footer>ğŸ“…æœ€åæ›´æ–°:&nbsp;0001-01-01&nbsp|&nbspâ²ï¸æ—¶é•¿: 23 min&nbsp|&nbspğŸ“–å­—æ•°: 11069 words&nbsp;|&nbsp;Luenci</footer><a class=entry-link aria-label="post link to K8sçš„Podåˆ›å»ºå†ç¨‹" href=https://luenci.com/en/posts/k8s%E5%88%9B%E5%BB%BApod%E5%8E%86%E7%A8%8B/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Tekton å…¥é—¨</h2></header><div class=entry-content><p>Tekton å…¥é—¨ æœ¯è¯­è§£é‡Š Cloud Native â€‹ äº‘åŸç”Ÿæ˜¯ä¸€ç§è½¯ä»¶å¼€å‘æ–¹æ³•ï¼Œå…¶ä¸­åº”ç”¨ç¨‹åºè¢«åˆ†è§£ä¸ºå¾®æœåŠ¡ï¼Œè¿™äº›å¾®æœåŠ¡è¢«æ‰“åŒ…åˆ°å®¹å™¨ä¸­ï¼Œå®¹å™¨åœ¨äº‘ä¸­åŠ¨æ€ç¼–æ’ä»¥ä¼˜åŒ–èµ„æºåˆ©ç”¨
Continuous Delivery â€‹ æŒç»­äº¤ä»˜æ˜¯ä¸€ç§è½¯ä»¶å¼€å‘å®è·µï¼Œå›¢é˜Ÿå¯ä»¥å®‰å…¨ã€å¿«é€Ÿã€å¯æŒç»­åœ°å‘ç”¨æˆ·å‘å¸ƒè½¯ä»¶å˜æ›´ã€‚
Tekton â€‹ Tekton æ˜¯ä¸€ä¸ªç”¨äºåˆ›å»ºæŒç»­äº¤ä»˜ç³»ç»Ÿçš„å¼€æº kubernetes åŸç”Ÿçš„æ¡†æ¶ã€‚ä½ å¯ä»¥ä½¿ç”¨ tekton è·¨å¤šä¸ªäº‘æä¾›å•†æˆ–æ··åˆç¯å¢ƒæ„å»ºï¼Œæµ‹è¯•å’Œéƒ¨ç½²ã€‚Tekton é€šè¿‡æŠ½è±¡å‡ºå¤æ‚çš„kubenetesæ¦‚å¿µå’Œå®ç°ç»†èŠ‚æ¥ç®€åŒ–åº”ç”¨ç¨‹åºç®¡ç†ã€‚å®ƒæä¾›äº†ç”¨äºå£°æ˜æŒç»­äº¤ä»˜ç®¡é“çš„ Kubernetes è‡ªå®šä¹‰èµ„æºã€‚
åŸºæœ¬æ„å»ºå— å…¶ä¸­Taskã€TaskRunã€Pipelineã€PipelineRunã€PipelineResourceã€Conditionä½œä¸ºå…¶æ ¸å¿ƒCRDï¼Œè¿™é‡Œä¸»è¦ä»‹ç»å®ƒä»¬ã€‚
Taskï¼š å®šä¹‰æ„å»ºä»»åŠ¡ï¼Œå®ƒç”±ä¸€ç³»åˆ—æœ‰åºstepsæ„æˆã€‚æ¯ä¸ªstepå¯ä»¥å®šä¹‰è¾“å…¥å’Œè¾“å‡ºï¼Œä¸”å¯ä»¥å°†ä¸Šä¸€ä¸ªstepçš„è¾“å‡ºä½œä¸ºä¸‹ä¸€ä¸ªstepçš„è¾“å…¥ã€‚æ¯ä¸ªstepéƒ½ä¼šç”±ä¸€ä¸ªcontaineræ¥æ‰§è¡Œã€‚
æ˜¯ Tekton ä¸­ä¸å¯åˆ†å‰²çš„æœ€å°å•ä½ï¼Œæ­£å¦‚åŒ Pod åœ¨ Kubernetes ä¸­çš„æ¦‚å¿µä¸€æ · TaskRunï¼š Taskç”¨äºå®šä¹‰å…·ä½“è¦åšçš„äº‹æƒ…ï¼Œå¹¶ä¸ä¼šçœŸæ­£çš„è¿è¡Œï¼Œè€ŒTaskRunå°±æ˜¯çœŸæ­£çš„æ‰§è¡Œè€…ï¼Œå¹¶ä¸”ä¼šæä¾›æ‰§è¡Œæ‰€éœ€éœ€è¦çš„å‚æ•°ï¼Œä¸€ä¸ªTaskRunå°±æ˜¯ä¸€ä¸ªPodã€‚
Pipelineï¼š é¡¾åæ€ä¹‰å°±æ˜¯æµæ°´çº¿ï¼Œå®ƒç”±ä¸€ç³»åˆ—Tasksç»„æˆã€‚å°±åƒTaskä¸­çš„stepä¸€æ ·ï¼Œä¸Šä¸€ä¸ªTaskçš„è¾“å‡ºå¯ä»¥ä½œä¸ºä¸‹ä¸€ä¸ªTaskçš„è¾“å…¥ã€‚
PipelineRunï¼š Pipelineçš„å®é™…æ‰§è¡Œï¼Œåˆ›å»ºåä¼šåˆ›å»ºPodæ¥æ‰§è¡ŒTaskï¼Œä¸€ä¸ªPipelineRunä¸­æœ‰å¤šä¸ªTaskã€‚
PipelineResourceï¼š ä¸»è¦ç”¨äºå®šä¹‰Pipelineçš„èµ„æºï¼Œå¸¸è§çš„å¦‚Gitåœ°å€ã€Dockeré•œåƒç­‰ã€‚
Conditionï¼š å®ƒä¸»è¦æ˜¯åœ¨Pipelineä¸­ç”¨äºåˆ¤æ–­çš„ï¼ŒTaskçš„æ‰§è¡Œä¸å¦é€šè¿‡Conditionçš„åˆ¤æ–­ç»“æœæ¥å†³å®šã€‚
Tipsï¼š PipelineResourceå’ŒConditionéƒ½ä¼šè¢«åºŸå¼ƒã€‚ä½†æ˜¯åœ¨ä½ç‰ˆæœ¬ä¸­è¿˜æ˜¯ä¼šç»§ç»­ä½¿ç”¨ï¼Œæ‰€ä»¥è¿™é‡Œä¼šç®€å•ä»‹ç»ä¸€ä¸‹ã€‚
...</p></div><footer class=entry-footer>ğŸ“…æœ€åæ›´æ–°:&nbsp;0001-01-01&nbsp|&nbspâ²ï¸æ—¶é•¿: 4 min&nbsp|&nbspğŸ“–å­—æ•°: 1828 words&nbsp;|&nbsp;Luenci</footer><a class=entry-link aria-label="post link to Tekton å…¥é—¨" href=https://luenci.com/en/posts/tekton-%E5%85%A5%E9%97%A8/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>åˆ†å¸ƒå¼12é—®</h2></header><div class=entry-content><p>åˆ†å¸ƒå¼12é—® åŸæ–‡è½¬è½½è‡ªï¼šåˆ†å¸ƒå¼å¤ºå‘½12è¿é—® (qq.com)
åˆ†å¸ƒå¼ç†è®º 1. è¯´è¯´CAPåŸåˆ™ï¼Ÿ CAPåŸåˆ™åˆç§°CAPå®šç†ï¼ŒæŒ‡çš„æ˜¯åœ¨ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼ŒConsistencyï¼ˆä¸€è‡´æ€§ï¼‰ã€ Availabilityï¼ˆå¯ç”¨æ€§ï¼‰ã€Partition toleranceï¼ˆåˆ†åŒºå®¹é”™æ€§ï¼‰è¿™3ä¸ªåŸºæœ¬éœ€æ±‚ï¼Œæœ€å¤šåªèƒ½åŒæ—¶æ»¡è¶³å…¶ä¸­çš„2ä¸ªã€‚
...</p></div><footer class=entry-footer>ğŸ“…æœ€åæ›´æ–°:&nbsp;0001-01-01&nbsp|&nbspâ²ï¸æ—¶é•¿: 22 min&nbsp|&nbspğŸ“–å­—æ•°: 10996 words&nbsp;|&nbsp;Luenci</footer><a class=entry-link aria-label="post link to åˆ†å¸ƒå¼12é—®" href=https://luenci.com/en/posts/%E5%88%86%E5%B8%83%E5%BC%8F12%E9%97%AE/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://luenci.com/en/posts/>Â«&nbsp;Prev&nbsp;
</a><a class=next href=https://luenci.com/en/posts/page/3/>Next&nbsp;&nbsp;Â»</a></nav></footer></main><footer class=footer><script src=https://sdk.jinrishici.com/v2/browser/jinrishici.js></script><script type=text/javascript>jinrishici.load(function(e){var t=document.querySelector(".poem_sentence"),n=document.querySelector(".poem_info");t.innerHTML=e.data.content,n.innerHTML="â€”â€” "+e.data.origin.author})</script><span><a id=running-time></a><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><span id=busuanzi_container><link rel=stylesheet href=//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css>ğŸ‘ï¸â€ğŸ—¨ï¸è®¿å®¢äººæ•°: <span id=busuanzi_value_site_uv></span>|
ğŸŒè®¿é—®é‡: <span id=busuanzi_value_site_pv></span></span></span><br><span>&copy; 2025 <a href=https://luenci.com/en/>Luenci</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a> ğŸ“–
<text class=poem_sentence></text><text class=poem_info></text></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})});const RunningTimerInterval=1e3,StartTime=new Date("10/11/2018 00:00:00");function prefixZero(e){return e<10&&(e="0"+e),e}function updateTime(){const r=new Date;let e=r.getTime()-StartTime.getTime();const t=24*60*60*1e3,n=Math.floor(e/t);e-=n*t;const s=60*60*1e3,o=Math.floor(e/s);e-=o*s;const i=60*1e3,a=Math.floor(e/i);e-=a*i;const c=Math.floor(e/1e3),l=document.getElementById("running-time");l.innerText="ğŸ•š: "+n+"å¤©"+prefixZero(o)+"å°æ—¶"+prefixZero(a)+"åˆ†"+prefixZero(c)+"ç§’"}document.addEventListener("DOMContentLoaded",()=>{let e=setInterval(updateTime,RunningTimerInterval)})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>