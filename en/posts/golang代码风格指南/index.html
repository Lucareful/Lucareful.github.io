<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>GO ä»£ç é£æ ¼æŒ‡å— | Luenci</title>
<meta name=keywords content="ä»£ç é£æ ¼"><meta name=description content="GO ä»£ç é£æ ¼æŒ‡å—
é£æ ¼åŸåˆ™
â€‹	æœ‰ä¸€äº›æ€»ä½“åŸåˆ™æ€»ç»“äº†å¦‚ä½•è€ƒè™‘ç¼–å†™å¯è¯»çš„ Go ä»£ç ã€‚ä»¥ä¸‹æ˜¯å¯è¯»ä»£ç çš„å±æ€§ï¼ŒæŒ‰é‡è¦æ€§æ’åºï¼š

æ¸…æ™°ï¼šä»£ç çš„ç›®çš„å’ŒåŸºæœ¬åŸç†å¯¹è¯»è€…æ¥è¯´æ˜¯æ¸…æ¥šçš„ã€‚
ç®€å•æ€§ï¼šä»£ç ä»¥å°½å¯èƒ½ç®€å•çš„æ–¹å¼å®ç°å…¶ç›®æ ‡ã€‚
ç®€æ´ï¼šä»£ç å…·æœ‰é«˜ä¿¡å™ªæ¯”ã€‚
å¯ç»´æŠ¤æ€§ï¼šä»£ç çš„ç¼–å†™ä½¿å…¶æ˜“äºç»´æŠ¤ã€‚
ä¸€è‡´æ€§ï¼šä»£ç ä¸æ›´å¹¿æ³›çš„ Google ä»£ç åº“ä¸€è‡´ã€‚
"><meta name=author content="Luenci"><link rel=canonical href=https://luenci.com/en/posts/golang%E4%BB%A3%E7%A0%81%E9%A3%8E%E6%A0%BC%E6%8C%87%E5%8D%97/><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://luenci.com/images/L.png><link rel=icon type=image/png sizes=16x16 href=https://luenci.com/images/L.png><link rel=icon type=image/png sizes=32x32 href=https://luenci.com/images/L.png><link rel=apple-touch-icon href=https://luenci.com/L.png><link rel=mask-icon href=https://luenci.com/L.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://luenci.com/en/posts/golang%E4%BB%A3%E7%A0%81%E9%A3%8E%E6%A0%BC%E6%8C%87%E5%8D%97/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script defer src=https://umami.luenci.com/script.js data-website-id=b0a9e971-b470-43a2-bda9-182c654377f4></script><meta property="og:title" content="GO ä»£ç é£æ ¼æŒ‡å—"><meta property="og:description" content="GO ä»£ç é£æ ¼æŒ‡å—
é£æ ¼åŸåˆ™
â€‹	æœ‰ä¸€äº›æ€»ä½“åŸåˆ™æ€»ç»“äº†å¦‚ä½•è€ƒè™‘ç¼–å†™å¯è¯»çš„ Go ä»£ç ã€‚ä»¥ä¸‹æ˜¯å¯è¯»ä»£ç çš„å±æ€§ï¼ŒæŒ‰é‡è¦æ€§æ’åºï¼š

æ¸…æ™°ï¼šä»£ç çš„ç›®çš„å’ŒåŸºæœ¬åŸç†å¯¹è¯»è€…æ¥è¯´æ˜¯æ¸…æ¥šçš„ã€‚
ç®€å•æ€§ï¼šä»£ç ä»¥å°½å¯èƒ½ç®€å•çš„æ–¹å¼å®ç°å…¶ç›®æ ‡ã€‚
ç®€æ´ï¼šä»£ç å…·æœ‰é«˜ä¿¡å™ªæ¯”ã€‚
å¯ç»´æŠ¤æ€§ï¼šä»£ç çš„ç¼–å†™ä½¿å…¶æ˜“äºç»´æŠ¤ã€‚
ä¸€è‡´æ€§ï¼šä»£ç ä¸æ›´å¹¿æ³›çš„ Google ä»£ç åº“ä¸€è‡´ã€‚
"><meta property="og:type" content="article"><meta property="og:url" content="https://luenci.com/en/posts/golang%E4%BB%A3%E7%A0%81%E9%A3%8E%E6%A0%BC%E6%8C%87%E5%8D%97/"><meta property="article:section" content="posts"><meta property="og:site_name" content="(ã€ƒ'â–½'ã€ƒ)"><meta name=twitter:card content="summary"><meta name=twitter:title content="GO ä»£ç é£æ ¼æŒ‡å—"><meta name=twitter:description content="GO ä»£ç é£æ ¼æŒ‡å—
é£æ ¼åŸåˆ™
â€‹	æœ‰ä¸€äº›æ€»ä½“åŸåˆ™æ€»ç»“äº†å¦‚ä½•è€ƒè™‘ç¼–å†™å¯è¯»çš„ Go ä»£ç ã€‚ä»¥ä¸‹æ˜¯å¯è¯»ä»£ç çš„å±æ€§ï¼ŒæŒ‰é‡è¦æ€§æ’åºï¼š

æ¸…æ™°ï¼šä»£ç çš„ç›®çš„å’ŒåŸºæœ¬åŸç†å¯¹è¯»è€…æ¥è¯´æ˜¯æ¸…æ¥šçš„ã€‚
ç®€å•æ€§ï¼šä»£ç ä»¥å°½å¯èƒ½ç®€å•çš„æ–¹å¼å®ç°å…¶ç›®æ ‡ã€‚
ç®€æ´ï¼šä»£ç å…·æœ‰é«˜ä¿¡å™ªæ¯”ã€‚
å¯ç»´æŠ¤æ€§ï¼šä»£ç çš„ç¼–å†™ä½¿å…¶æ˜“äºç»´æŠ¤ã€‚
ä¸€è‡´æ€§ï¼šä»£ç ä¸æ›´å¹¿æ³›çš„ Google ä»£ç åº“ä¸€è‡´ã€‚
"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://luenci.com/en/posts/"},{"@type":"ListItem","position":2,"name":"GO ä»£ç é£æ ¼æŒ‡å—","item":"https://luenci.com/en/posts/golang%E4%BB%A3%E7%A0%81%E9%A3%8E%E6%A0%BC%E6%8C%87%E5%8D%97/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"GO ä»£ç é£æ ¼æŒ‡å—","name":"GO ä»£ç é£æ ¼æŒ‡å—","description":"GO ä»£ç é£æ ¼æŒ‡å— é£æ ¼åŸåˆ™ â€‹\tæœ‰ä¸€äº›æ€»ä½“åŸåˆ™æ€»ç»“äº†å¦‚ä½•è€ƒè™‘ç¼–å†™å¯è¯»çš„ Go ä»£ç ã€‚ä»¥ä¸‹æ˜¯å¯è¯»ä»£ç çš„å±æ€§ï¼ŒæŒ‰é‡è¦æ€§æ’åºï¼š\næ¸…æ™°ï¼šä»£ç çš„ç›®çš„å’ŒåŸºæœ¬åŸç†å¯¹è¯»è€…æ¥è¯´æ˜¯æ¸…æ¥šçš„ã€‚ ç®€å•æ€§ï¼šä»£ç ä»¥å°½å¯èƒ½ç®€å•çš„æ–¹å¼å®ç°å…¶ç›®æ ‡ã€‚ ç®€æ´ï¼šä»£ç å…·æœ‰é«˜ä¿¡å™ªæ¯”ã€‚ å¯ç»´æŠ¤æ€§ï¼šä»£ç çš„ç¼–å†™ä½¿å…¶æ˜“äºç»´æŠ¤ã€‚ ä¸€è‡´æ€§ï¼šä»£ç ä¸æ›´å¹¿æ³›çš„ Google ä»£ç åº“ä¸€è‡´ã€‚ ","keywords":["ä»£ç é£æ ¼"],"articleBody":"GO ä»£ç é£æ ¼æŒ‡å— é£æ ¼åŸåˆ™ â€‹\tæœ‰ä¸€äº›æ€»ä½“åŸåˆ™æ€»ç»“äº†å¦‚ä½•è€ƒè™‘ç¼–å†™å¯è¯»çš„ Go ä»£ç ã€‚ä»¥ä¸‹æ˜¯å¯è¯»ä»£ç çš„å±æ€§ï¼ŒæŒ‰é‡è¦æ€§æ’åºï¼š\næ¸…æ™°ï¼šä»£ç çš„ç›®çš„å’ŒåŸºæœ¬åŸç†å¯¹è¯»è€…æ¥è¯´æ˜¯æ¸…æ¥šçš„ã€‚ ç®€å•æ€§ï¼šä»£ç ä»¥å°½å¯èƒ½ç®€å•çš„æ–¹å¼å®ç°å…¶ç›®æ ‡ã€‚ ç®€æ´ï¼šä»£ç å…·æœ‰é«˜ä¿¡å™ªæ¯”ã€‚ å¯ç»´æŠ¤æ€§ï¼šä»£ç çš„ç¼–å†™ä½¿å…¶æ˜“äºç»´æŠ¤ã€‚ ä¸€è‡´æ€§ï¼šä»£ç ä¸æ›´å¹¿æ³›çš„ Google ä»£ç åº“ä¸€è‡´ã€‚ å‘½å ä¸‹åˆ’çº¿ Go ä¸­çš„åç§°é€šå¸¸ä¸åº”åŒ…å«ä¸‹åˆ’çº¿ã€‚è¿™ä¸ªåŸåˆ™æœ‰ä¸‰ä¸ªä¾‹å¤–ï¼š\nä»…ç”±ç”Ÿæˆçš„ä»£ç å¯¼å…¥çš„åŒ…åç§°å¯èƒ½åŒ…å«ä¸‹åˆ’çº¿ã€‚æœ‰å…³å¦‚ä½•é€‰æ‹©å¤šè¯åŒ…åç§°çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…åŒ…åç§° æ–‡ä»¶ä¸­çš„æµ‹è¯•ã€åŸºå‡†å’Œç¤ºä¾‹å‡½æ•°åç§°*_test.goå¯èƒ½åŒ…å«ä¸‹åˆ’çº¿ã€‚ ä¸æ“ä½œç³»ç»Ÿæˆ– cgo äº’æ“ä½œçš„ä½çº§åº“å¯èƒ½ä¼šé‡ç”¨æ ‡è¯†ç¬¦ï¼Œå¦‚syscall. åœ¨å¤§å¤šæ•°ä»£ç åº“ä¸­ï¼Œè¿™é¢„è®¡æ˜¯éå¸¸ç½•è§çš„ã€‚ åŒ…å â€‹\tGo åŒ…åç§°åº”è¯¥ç®€çŸ­å¹¶ä¸”åªåŒ…å«å°å†™å­—æ¯ã€‚ç”±å¤šä¸ªå•è¯ç»„æˆçš„åŒ…åç§°åº”å…¨éƒ¨å°å†™ã€‚ä¾‹å¦‚ï¼ŒåŒ…tabwriteræœªå‘½åä¸ºtabWriterã€TabWriteræˆ– tab_writerã€‚\nâ€‹\té¿å…é€‰æ‹©å¯èƒ½è¢«å¸¸ç”¨å±€éƒ¨å˜é‡åé®è”½çš„åŒ…åã€‚ä¾‹å¦‚ï¼Œusercountæ˜¯ä¸€ä¸ªæ¯” æ›´å¥½çš„åŒ…å countï¼Œå› ä¸ºcountæ˜¯ä¸€ä¸ªå¸¸ç”¨çš„å˜é‡åã€‚\nâ€‹\tGo åŒ…åç§°ä¸åº”è¯¥æœ‰ä¸‹åˆ’çº¿ã€‚å¦‚æœæ‚¨éœ€è¦å¯¼å…¥åç§°ä¸­ç¡®å®æœ‰ä¸€ä¸ªåŒ…ï¼ˆé€šå¸¸æ¥è‡ªç”Ÿæˆçš„æˆ–ç¬¬ä¸‰æ–¹ä»£ç ï¼‰ï¼Œåˆ™å¿…é¡»åœ¨å¯¼å…¥æ—¶å°†å…¶é‡å‘½åä¸ºé€‚åˆåœ¨ Go ä»£ç ä¸­ä½¿ç”¨çš„åç§°ã€‚\nä¸€ä¸ªä¾‹å¤–æ˜¯ä»…ç”±ç”Ÿæˆçš„ä»£ç å¯¼å…¥çš„åŒ…åç§°å¯èƒ½åŒ…å«ä¸‹åˆ’çº¿ã€‚å…·ä½“ä¾‹å­åŒ…æ‹¬ï¼š\nä½¿ç”¨_testå¤–éƒ¨æµ‹è¯•åŒ…çš„åç¼€ï¼Œä¾‹å¦‚é›†æˆæµ‹è¯• ä½¿ç”¨åŒ…çº§æ–‡æ¡£ç¤ºä¾‹_testçš„åç¼€ â€‹\té¿å…ä½¿ç”¨æ— æ„ä¹‰çš„åŒ…åç§°ï¼Œä¾‹å¦‚util, utility, common,helperç­‰ã€‚æŸ¥çœ‹æ›´å¤šå…³äº æ‰€è°“çš„â€œå®ç”¨ç¨‹åºåŒ…â€çš„ä¿¡æ¯ã€‚\nâ€‹\tå½“å¯¼å…¥çš„åŒ…è¢«é‡å‘½åï¼ˆä¾‹å¦‚import foopb \"path/to/foo_go_proto\"ï¼‰æ—¶ï¼ŒåŒ…çš„æœ¬åœ°åç§°å¿…é¡»ç¬¦åˆä¸Šè¿°è§„åˆ™ï¼Œå› ä¸ºæœ¬åœ°åç§°å†³å®šäº†åŒ…ä¸­çš„ç¬¦å·åœ¨æ–‡ä»¶ä¸­çš„å¼•ç”¨æ–¹å¼ã€‚å¦‚æœç»™å®šçš„å¯¼å…¥åœ¨å¤šä¸ªæ–‡ä»¶ä¸­é‡å‘½åï¼Œç‰¹åˆ«æ˜¯åœ¨ç›¸åŒæˆ–é™„è¿‘çš„åŒ…ä¸­ï¼Œåˆ™åº”å°½å¯èƒ½ä½¿ç”¨ç›¸åŒçš„æœ¬åœ°åç§°ä»¥ä¿æŒä¸€è‡´æ€§ã€‚\nå¦è¯·å‚é˜…ï¼šhttps://go.dev/blog/package-names\nå‚æ•°åˆ«å æ¥æ”¶å™¨å˜é‡åç§°å¿…é¡»æ˜¯ï¼š\nçŸ­ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸¤ä¸ªå­—æ¯çš„é•¿åº¦ï¼‰ ç±»å‹æœ¬èº«çš„ç¼©å†™ ä¸€è‡´åœ°åº”ç”¨äºè¯¥ç±»å‹çš„æ¯ä¸ªæ¥æ”¶å™¨ é•¿å æ›´å¥½çš„åå­— func (tray Tray) func (t Tray) func (info *ResearchInfo) func (ri *ResearchInfo) func (this *ReportWriter) func (w *ReportWriter) func (self *Scanner) func (s *Scanner) å¸¸é‡åç§° â€‹\tå¸¸é‡åç§°å¿…é¡»åƒ Go ä¸­çš„æ‰€æœ‰å…¶ä»–åç§°ä¸€æ ·ä½¿ç”¨MixedCapsï¼ˆå¯¼å‡º çš„å¸¸é‡ä»¥å¤§å†™å­—æ¯å¼€å¤´ï¼Œè€Œæœªå¯¼å‡ºçš„å¸¸é‡ä»¥å°å†™å­—æ¯å¼€å¤´ã€‚ï¼‰å³ä½¿å®ƒæ‰“ç ´äº†å…¶ä»–è¯­è¨€çš„çº¦å®šï¼Œè¿™ä¹Ÿé€‚ç”¨ã€‚\nâ€‹\tå¸¸é‡åç§°ä¸åº”æ˜¯å…¶å€¼çš„æ´¾ç”Ÿè¯ï¼Œè€Œåº”è§£é‡Šå€¼çš„å«ä¹‰ã€‚\n1 2 3 4 5 6 7 8 // Good: const MaxPacketSize = 512 const ( ExecuteBit = 1 \u003c\u003c iota WriteBit ReadBit ) ä¸è¦ä½¿ç”¨é MixedCaps å¸¸é‡åç§°æˆ–å¸¦æœ‰Kå‰ç¼€çš„å¸¸é‡ã€‚\n1 2 3 4 // Bad: const MAX_PACKET_SIZE = 512 const kMaxBufferSize = 1024 const KMaxUsersPergroup = 500 æ ¹æ®å®ƒä»¬çš„è§’è‰²è€Œä¸æ˜¯å®ƒä»¬çš„å€¼æ¥å‘½åå¸¸é‡ã€‚å¦‚æœä¸€ä¸ªå¸¸é‡é™¤äº†å®ƒçš„å€¼ä¹‹å¤–æ²¡æœ‰å…¶ä»–ä½œç”¨ï¼Œé‚£ä¹ˆå°±æ²¡æœ‰å¿…è¦å°†å®ƒå®šä¹‰ä¸ºä¸€ä¸ªå¸¸é‡ã€‚\n1 2 3 4 5 6 7 // Bad: const Twelve = 12 const ( UserNameColumn = \"username\" GroupColumn = \"group\" ) ç¼©å†™è¯ â€‹\tåç§°ä¸­çš„é¦–å­—æ¯ç¼©ç•¥è¯æˆ–é¦–å­—æ¯ç¼©ç•¥è¯ï¼ˆä¾‹å¦‚ï¼ŒURLå’ŒNATOï¼‰åº”è¯¥å…·æœ‰ç›¸åŒçš„å¤§å°å†™ã€‚URLåº”æ˜¾ç¤ºä¸ºURLæˆ–urlï¼ˆå¦‚urlPony, æˆ– URLPonyï¼‰ï¼Œç»ä¸èƒ½æ˜¾ç¤ºä¸ºUrl. è¿™ä¹Ÿé€‚ç”¨äºIDâ€œæ ‡è¯†ç¬¦â€çš„ç¼©å†™ï¼›å†™appIDè€Œä¸æ˜¯appIdã€‚\nåœ¨å…·æœ‰å¤šä¸ªé¦–å­—æ¯ç¼©å†™è¯çš„åç§°ä¸­ï¼ˆä¾‹å¦‚XMLAPIï¼Œå› ä¸ºå®ƒåŒ…å«XML and APIï¼‰ï¼Œç»™å®šé¦–å­—æ¯ç¼©å†™è¯ä¸­çš„æ¯ä¸ªå­—æ¯éƒ½åº”è¯¥å…·æœ‰ç›¸åŒçš„å¤§å°å†™ï¼Œä½†åç§°ä¸­çš„æ¯ä¸ªé¦–å­—æ¯ç¼©å†™è¯ä¸éœ€è¦å…·æœ‰ç›¸åŒçš„å¤§å°å†™ã€‚ åœ¨é¦–å­—æ¯ç¼©å†™åŒ…å«å°å†™å­—æ¯ï¼ˆä¾‹å¦‚DDoS, iOS, gRPCï¼‰çš„åç§°ä¸­ï¼Œé¦–å­—æ¯ç¼©å†™åº”è¯¥åƒåœ¨æ ‡å‡†æ•£æ–‡ä¸­ä¸€æ ·å‡ºç°ï¼Œé™¤éæ‚¨éœ€è¦ä¸ºäº†å¯¼å‡ºæ€§è€Œæ›´æ”¹ç¬¬ä¸€ä¸ªå­—æ¯ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œæ•´ä¸ªé¦–å­—æ¯å¤§å†™åº”è¯¥æ˜¯ç›¸åŒçš„æƒ…å†µï¼ˆä¾‹å¦‚ddos, IOS, GRPCï¼‰ã€‚ åˆå§‹ä¸»ä¹‰ èŒƒå›´ æ­£ç¡®çš„ ä¸æ­£ç¡® XML API å·²å‡ºå£ XMLAPI XmlApi, XMLApi, XmlAPI,XMLapi XML API æœªå‡ºå£ xmlAPI xmlapi,xmlApi iOS å·²å‡ºå£ IOS Ios,IoS iOS æœªå‡ºå£ iOS ios gRPC å·²å‡ºå£ GRPC Grpc gRPC æœªå‡ºå£ gRPC grpc åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡ å·²å‡ºå£ DDoS DDOS,Ddos åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡ æœªå‡ºå£ ddos dDoS,dDOS å‡½æ•°åç§° â€‹\tå‡½æ•°å’Œæ–¹æ³•åç§°ä¸åº”ä½¿ç”¨Getæˆ–getå‰ç¼€ï¼Œé™¤éåº•å±‚æ¦‚å¿µä½¿ç”¨å•è¯â€œgetâ€ï¼ˆä¾‹å¦‚ HTTP GETï¼‰ã€‚æ›´å–œæ¬¢ç›´æ¥ä»¥åè¯å¼€å¤´çš„åç§°ï¼Œä¾‹å¦‚ä½¿ç”¨Countsover GetCountsã€‚\nå¦‚æœè¯¥å‡½æ•°æ¶‰åŠæ‰§è¡Œå¤æ‚çš„è®¡ç®—æˆ–æ‰§è¡Œè¿œç¨‹è°ƒç”¨ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ä¸åŒçš„è¯ï¼ˆå¦‚Computeæˆ–ï¼‰ä»£æ›¿ï¼Œä»¥å‘è¯»è€…æ¸…æ¥šåœ°è¡¨æ˜å‡½æ•°è°ƒç”¨å¯èƒ½éœ€è¦æ—¶é—´å¹¶ä¸”å¯èƒ½ä¼šé˜»å¡æˆ–å¤±è´¥ã€‚Fetch Get\nå˜é‡å ä¸€èˆ¬çš„ç»éªŒæ³•åˆ™æ˜¯ï¼Œåç§°çš„é•¿åº¦åº”ä¸å…¶èŒƒå›´çš„å¤§å°æˆæ­£æ¯”ï¼Œå¹¶ä¸å…¶åœ¨è¯¥èŒƒå›´å†…ä½¿ç”¨çš„æ¬¡æ•°æˆåæ¯”ã€‚åœ¨æ–‡ä»¶èŒƒå›´å†…åˆ›å»ºçš„å˜é‡å¯èƒ½éœ€è¦å¤šä¸ªå•è¯ï¼Œè€Œä½œç”¨åŸŸä¸ºå•ä¸ªå†…éƒ¨å—çš„å˜é‡å¯èƒ½æ˜¯å•ä¸ªå•è¯ç”šè‡³åªæ˜¯ä¸€ä¸¤ä¸ªå­—ç¬¦ï¼Œä»¥ä¿æŒä»£ç æ¸…æ™°å¹¶é¿å…æ— å…³ä¿¡æ¯ã€‚\nè¿™æ˜¯ä¸€ä¸ªç²—ç•¥çš„åŸºçº¿ã€‚è¿™äº›æ•°å­—å‡†åˆ™ä¸æ˜¯ä¸¥æ ¼çš„è§„åˆ™ã€‚æ ¹æ®ä¸Šä¸‹æ–‡ã€æ¸…æ™°åº¦å’Œç®€æ´æ€§åº”ç”¨åˆ¤æ–­ã€‚\nå°èŒƒå›´æ˜¯æ‰§è¡Œä¸€ä¸¤ä¸ªå°æ“ä½œçš„èŒƒå›´ï¼Œæ¯”å¦‚ 1-7 è¡Œã€‚ ä¸­ç­‰èŒƒå›´æ˜¯ä¸€äº›å°çš„æˆ–ä¸€ä¸ªå¤§çš„æ“ä½œï¼Œæ¯”å¦‚ 8-15 è¡Œã€‚ å¤§èŒƒå›´æ˜¯ä¸€ä¸ªæˆ–å‡ ä¸ªå¤§æ“ä½œï¼Œæ¯”å¦‚ 15-25 è¡Œã€‚ éå¸¸å¤§çš„èŒƒå›´æ˜¯æŒ‡è¶…è¿‡ä¸€é¡µï¼ˆä¾‹å¦‚ï¼Œè¶…è¿‡ 25 è¡Œï¼‰çš„ä»»ä½•å†…å®¹ã€‚ åœ¨å°èŒƒå›´å†…å¯èƒ½éå¸¸æ¸…æ¥šçš„åç§°ï¼ˆä¾‹å¦‚ï¼Œcå¯¹äºè®¡æ•°å™¨ï¼‰åœ¨è¾ƒå¤§èŒƒå›´å†…å¯èƒ½æ˜¯ä¸å¤Ÿçš„ï¼Œå¹¶ä¸”éœ€è¦æ¾„æ¸…ä»¥æé†’è¯»è€…å…¶åœ¨ä»£ç ä¸­çš„ç›®çš„ã€‚ä¸€ä¸ªä½œç”¨åŸŸä¸­æœ‰å¾ˆå¤šå˜é‡ï¼Œæˆ–è€…è¡¨ç¤ºç›¸ä¼¼å€¼æˆ–æ¦‚å¿µçš„å˜é‡ï¼Œå¯èƒ½éœ€è¦æ¯”ä½œç”¨åŸŸå»ºè®®çš„æ›´é•¿çš„å˜é‡åç§°ã€‚\næ¦‚å¿µçš„ç‰¹æ®Šæ€§ä¹Ÿæœ‰åŠ©äºä¿æŒå˜é‡åç§°çš„ç®€æ´ã€‚ä¾‹å¦‚ï¼Œå‡è®¾åªæœ‰ä¸€ä¸ªæ•°æ®åº“åœ¨ä½¿ç”¨ï¼Œåƒdbè¿™æ ·çš„çŸ­å˜é‡åé€šå¸¸å¯èƒ½ä¸ºéå¸¸å°çš„èŒƒå›´ä¿ç•™ï¼Œå³ä½¿èŒƒå›´éå¸¸å¤§ä¹Ÿå¯èƒ½ä¿æŒå®Œå…¨æ¸…æ™°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ ¹æ®èŒƒå›´çš„å¤§å°ï¼Œå•ä¸ªè¯ databaseå¯èƒ½æ˜¯å¯ä»¥æ¥å—çš„ï¼Œä½†ä¸æ˜¯å¿…éœ€çš„ï¼Œå› ä¸ºè¿™dbæ˜¯ä¸€ä¸ªéå¸¸å¸¸è§çš„è¯ç¼©å†™ï¼Œå‡ ä¹æ²¡æœ‰å…¶ä»–è§£é‡Šã€‚\nå±€éƒ¨å˜é‡çš„åç§°åº”è¯¥åæ˜ å®ƒåŒ…å«çš„å†…å®¹ä»¥åŠå®ƒåœ¨å½“å‰ä¸Šä¸‹æ–‡ä¸­çš„ä½¿ç”¨æ–¹å¼ï¼Œè€Œä¸æ˜¯å€¼çš„æ¥æºã€‚ä¾‹å¦‚ï¼Œé€šå¸¸æƒ…å†µä¸‹æœ€ä½³å±€éƒ¨å˜é‡åç§°ä¸ç»“æ„æˆ–åè®®ç¼“å†²åŒºå­—æ®µåç§°ä¸åŒã€‚\nä¸€èˆ¬æ¥è¯´ï¼š\nåƒcountæˆ–è¿™æ ·çš„å•è¯åç§°optionsæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ã€‚\nå¯ä»¥æ·»åŠ å…¶ä»–è¯æ¥æ¶ˆé™¤ç›¸ä¼¼åç§°çš„æ­§ä¹‰ï¼Œä¾‹å¦‚ userCountand projectCountã€‚\nä¸è¦ä¸ºäº†èŠ‚çœæ‰“å­—è€Œç®€å•åœ°æ”¾ä¸‹å­—æ¯ã€‚ä¾‹å¦‚Sandboxæ¯” æ›´å—æ¬¢è¿Sbxï¼Œç‰¹åˆ«æ˜¯å¯¹äºå¯¼å‡ºçš„åç§°ã€‚\nä»å¤§å¤šæ•°å˜é‡åä¸­ çœç•¥\nç±»å‹å’Œç±»ä¼¼ç±»å‹çš„è¯ã€‚\nå¯¹äºæ•°å­—ï¼ŒuserCountæ˜¯æ¯”numUsersor æ›´å¥½çš„åç§°usersIntã€‚ å¯¹äºåˆ‡ç‰‡ï¼Œusersæ˜¯ä¸€ä¸ªæ¯”userSlice. å¦‚æœèŒƒå›´å†…æœ‰ä¸¤ä¸ªç‰ˆæœ¬çš„å€¼ï¼Œåˆ™åŒ…å«ç±»ä¼¼ç±»å‹çš„é™å®šç¬¦æ˜¯å¯ä»¥æ¥å—çš„ï¼Œä¾‹å¦‚ï¼Œæ‚¨å¯èƒ½å°†è¾“å…¥å­˜å‚¨åœ¨è§£æå€¼ä¸­ageStringå¹¶ageç”¨äºè§£æå€¼ã€‚ çœç•¥å‘¨å›´ä¸Šä¸‹æ–‡æ¸…æ¥šçš„è¯ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªUserCountæ–¹æ³•çš„å®ç°ä¸­ï¼Œè°ƒç”¨çš„ä¸€ä¸ªå±€éƒ¨å˜é‡ userCountå¾ˆå¯èƒ½æ˜¯å¤šä½™çš„ï¼›count, users, ç”šè‡³céƒ½ä¸€æ ·å¯è¯»ã€‚\nå•å­—æ¯å˜é‡å å•å­—æ¯å˜é‡åå¯èƒ½æ˜¯å‡å°‘ é‡å¤çš„æœ‰ç”¨å·¥å…·ï¼Œä½†ä¹Ÿå¯èƒ½ä½¿ä»£ç ä¸å¿…è¦åœ°å˜å¾—ä¸é€æ˜ã€‚å°†å®ƒä»¬çš„ä½¿ç”¨é™åˆ¶åœ¨å®Œæ•´å•è¯å¾ˆæ˜æ˜¾ä»¥åŠå®ƒä¼šé‡å¤å‡ºç°ä»¥ä»£æ›¿å•å­—æ¯å˜é‡çš„æƒ…å†µã€‚\nä¸€èˆ¬æ¥è¯´ï¼š\nå¯¹äºæ–¹æ³•æ¥æ”¶è€…å˜é‡ï¼Œé¦–é€‰ä¸€ä¸ªå­—æ¯æˆ–ä¸¤ä¸ªå­—æ¯çš„åç§°ã€‚ å¯¹å¸¸è§ç±»å‹ä½¿ç”¨ç†Ÿæ‚‰çš„å˜é‡åé€šå¸¸å¾ˆæœ‰å¸®åŠ©ï¼š rå¯¹äºä¸€ä¸ªio.Readeræˆ–*http.Request wå¯¹äºä¸€ä¸ªio.Writeræˆ–http.ResponseWriter å•å­—æ¯æ ‡è¯†ç¬¦ä½œä¸ºæ•´æ•°å¾ªç¯å˜é‡æ˜¯å¯æ¥å—çš„ï¼Œç‰¹åˆ«æ˜¯å¯¹äºç´¢å¼•ï¼ˆä¾‹å¦‚ï¼Œiï¼‰å’Œåæ ‡ï¼ˆä¾‹å¦‚ï¼Œxå’Œyï¼‰ã€‚ å½“èŒƒå›´å¾ˆçŸ­æ—¶ï¼Œç¼©å†™å¯ä»¥æ˜¯å¯æ¥å—çš„å¾ªç¯æ ‡è¯†ç¬¦ï¼Œä¾‹å¦‚for _, n := range nodes { ... }. é‡å¤ â€‹\tä¸€æ®µ Go æºä»£ç åº”è¯¥é¿å…ä¸å¿…è¦çš„é‡å¤ã€‚ä¸€ä¸ªå¸¸è§çš„æ¥æºæ˜¯é‡å¤åç§°ï¼Œå…¶ä¸­é€šå¸¸åŒ…å«ä¸å¿…è¦çš„å•è¯æˆ–é‡å¤å…¶ä¸Šä¸‹æ–‡æˆ–ç±»å‹ã€‚å¦‚æœç›¸åŒæˆ–ç›¸ä¼¼çš„ä»£ç æ®µåœ¨å¾ˆè¿‘çš„åœ°æ–¹å¤šæ¬¡å‡ºç°ï¼Œä»£ç æœ¬èº«ä¹Ÿå¯èƒ½æ˜¯ä¸å¿…è¦çš„é‡å¤ã€‚\né‡å¤å‘½åå¯ä»¥æœ‰å¤šç§å½¢å¼ï¼ŒåŒ…æ‹¬ï¼š\nåŒ…ä¸å¯¼å‡ºçš„ç¬¦å·åç§° â€‹\tå‘½åå¯¼å‡ºçš„ç¬¦å·æ—¶ï¼ŒåŒ…çš„åç§°å§‹ç»ˆåœ¨åŒ…å¤–å¯è§ï¼Œå› æ­¤åº”å‡å°‘æˆ–æ¶ˆé™¤ä¸¤è€…ä¹‹é—´çš„å†—ä½™ä¿¡æ¯ã€‚å¦‚æœä¸€ä¸ªåŒ…ä»…å¯¼å‡ºä¸€ç§ç±»å‹å¹¶ä¸”å®ƒä»¥åŒ…æœ¬èº«å‘½åï¼Œåˆ™æ„é€ å‡½æ•°çš„è§„èŒƒåç§°æ˜¯Newif one is requiredã€‚\n**ç¤ºä¾‹ï¼š**é‡å¤åç§° -\u003e æ›´å¥½çš„åç§°\nwidget.NewWidget-\u003ewidget.New widget.NewWidgetWithName-\u003ewidget.NewWithName db.LoadFromDatabase-\u003edb.Load goatteleportutil.CountGoatsTeleported-\u003egtutil.CountGoatsTeleported æˆ–goatteleport.Count myteampb.MyTeamMethodRequest-\u003emtpb.MyTeamMethodRequestæˆ– myteampb.MethodRequest å˜é‡åä¸ç±»å‹ â€‹\tç¼–è¯‘å™¨æ€»æ˜¯çŸ¥é“å˜é‡çš„ç±»å‹ï¼Œå¹¶ä¸”åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¯»è€…ä¹Ÿå¯ä»¥é€šè¿‡å˜é‡çš„ä½¿ç”¨æ–¹å¼æ¸…æ¥šåœ°çŸ¥é“å˜é‡æ˜¯ä»€ä¹ˆç±»å‹ã€‚å¦‚æœä¸€ä¸ªå˜é‡çš„å€¼åœ¨åŒä¸€èŒƒå›´å†…å‡ºç°ä¸¤æ¬¡ï¼Œåˆ™åªéœ€æ˜ç¡®å˜é‡çš„ç±»å‹ã€‚\né‡å¤åç§° æ›´å¥½çš„åå­— var numUsers int var users int var nameString string var name string var primaryProject *Project var primary *Project å¦‚æœè¯¥å€¼ä»¥å¤šç§å½¢å¼å‡ºç°ï¼Œåˆ™å¯ä»¥ä½¿ç”¨åƒrawandparsedæˆ–åº•å±‚è¡¨ç¤ºè¿™æ ·çš„é¢å¤–è¯æ¥æ¾„æ¸…ï¼š\n1 2 3 4 5 6 // Good: limitStr := r.FormValue(\"limit\") limit, err := strconv.Atoi(limitStr) // Good: limitRaw := r.FormValue(\"limit\") limit, err := strconv.Atoi(limitRaw) å¤–éƒ¨ä¸Šä¸‹æ–‡ä¸æœ¬åœ°åç§° â€‹\tåŒ…å«æ¥è‡ªå‘¨å›´ä¸Šä¸‹æ–‡ä¿¡æ¯çš„åç§°é€šå¸¸ä¼šäº§ç”Ÿé¢å¤–çš„å™ªéŸ³è€Œæ²¡æœ‰ä»»ä½•å¥½å¤„ã€‚åŒ…åã€æ–¹æ³•åã€ç±»å‹åã€å‡½æ•°åã€å¯¼å…¥è·¯å¾„ï¼Œç”šè‡³æ–‡ä»¶åéƒ½å¯ä»¥æä¾›è‡ªåŠ¨é™å®šå…¶ä¸­æ‰€æœ‰åç§°çš„ä¸Šä¸‹æ–‡ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 // Bad: // In package \"ads/targeting/revenue/reporting\" type AdsTargetingRevenueReport struct{} func (p *Project) ProjectName() string // Good: // In package \"ads/targeting/revenue/reporting\" type Report struct{} func (p *Project) Name() string // Bad: // In package \"sqldb\" type DBConnection struct{} // Good: // In package \"sqldb\" type Connection struct{} // Bad: // In package \"ads/targeting\" func Process(in *pb.FooProto) *Report { adsTargetingID := in.GetAdsTargetingID() } // Good: // In package \"ads/targeting\" func Process(in *pb.FooProto) *Report { id := in.GetAdsTargetingID() } â€‹\té‡å¤é€šå¸¸åº”è¯¥åœ¨ç¬¦å·ç”¨æˆ·çš„ä¸Šä¸‹æ–‡ä¸­è¿›è¡Œè¯„ä¼°ï¼Œè€Œä¸æ˜¯å­¤ç«‹åœ°è¿›è¡Œè¯„ä¼°ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢çš„ä»£ç æœ‰å¾ˆå¤šåç§°ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½æ²¡é—®é¢˜ï¼Œä½†åœ¨ä¸Šä¸‹æ–‡ä¸­æ˜¯å¤šä½™çš„ï¼š\n1 2 3 4 5 6 7 8 9 // Bad: func (db *DB) UserCount() (userCount int, err error) { var userCountInt64 int64 if dbLoadError := db.LoadFromDatabase(\"count(distinct users)\", \u0026userCountInt64); dbLoadError != nil { return 0, fmt.Errorf(\"failed to load user count: %s\", dbLoadError) } userCount = int(userCountInt64) return userCount, nil } ç›¸åï¼Œé€šå¸¸å¯ä»¥çœç•¥æœ‰å…³ä»ä¸Šä¸‹æ–‡æˆ–ç”¨æ³•ä¸­æ¸…æ¥šçš„åç§°çš„ä¿¡æ¯ï¼š\n1 2 3 4 5 6 7 8 // Good: func (db *DB) UserCount() (int, error) { var count int64 if err := db.Load(\"count(distinct users)\", \u0026count); err != nil { return 0, fmt.Errorf(\"failed to load user count: %s\", err) } return int(count), nil } imports å¯¼å…¥é‡å‘½å â€‹\tåªåº”é‡å‘½åå¯¼å…¥ä»¥é¿å…ä¸å…¶ä»–å¯¼å…¥çš„åç§°å†²çªã€‚ï¼ˆç”±æ­¤æ¨è®ºï¼Œå¥½çš„åŒ…åä¸åº”è¯¥éœ€è¦é‡å‘½åã€‚ï¼‰åœ¨åç§°å†²çªçš„æƒ…å†µä¸‹ï¼Œæ›´æ„¿æ„é‡å‘½åæœ€æœ¬åœ°æˆ–ç‰¹å®šäºé¡¹ç›®çš„å¯¼å…¥ã€‚åŒ…çš„æœ¬åœ°åç§°ï¼ˆåˆ«åï¼‰å¿…é¡»éµå¾ª åŒ…å‘½åæŒ‡å—ï¼ŒåŒ…æ‹¬ç¦æ­¢ä½¿ç”¨ä¸‹åˆ’çº¿å’Œå¤§å†™å­—æ¯ã€‚\nâ€‹\tç”Ÿæˆçš„ protocol buffer åŒ…å¿…é¡»é‡å‘½åä»¥ä»åç§°ä¸­åˆ é™¤ä¸‹åˆ’çº¿ï¼Œå¹¶ä¸”å®ƒä»¬çš„åˆ«åå¿…é¡»æœ‰pbåç¼€ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… åŸå‹å’Œå­˜æ ¹æœ€ä½³å®è·µã€‚\n1 2 3 4 // Good: import ( fspb \"path/to/package/foo_service_go_proto\" ) å¯¼å…¥çš„åŒ…åç§°æ²¡æœ‰æœ‰ç”¨çš„è¯†åˆ«ä¿¡æ¯ï¼ˆä¾‹å¦‚ package v1ï¼‰åº”è¯¥é‡å‘½åä»¥åŒ…æ‹¬ä»¥å‰çš„è·¯å¾„ç»„ä»¶ã€‚é‡å‘½åå¿…é¡»ä¸å¯¼å…¥ç›¸åŒåŒ…çš„å…¶ä»–æœ¬åœ°æ–‡ä»¶ä¸€è‡´ï¼Œå¹¶ä¸”å¯ä»¥åŒ…æ‹¬ç‰ˆæœ¬å·ã€‚\n**æ³¨æ„ï¼š**æœ€å¥½é‡å‘½ååŒ…ä»¥ç¬¦åˆ è‰¯å¥½çš„åŒ…åç§°ï¼Œä½†è¿™å¯¹äº vendored ç›®å½•ä¸­çš„åŒ…é€šå¸¸ä¸å¯è¡Œã€‚\n1 2 3 4 5 // Good: import ( core \"github.com/kubernetes/api/core/v1\" meta \"github.com/kubernetes/apimachinery/pkg/apis/meta/v1beta1\" ) â€‹\tå¦‚æœæ‚¨éœ€è¦å¯¼å…¥ä¸€ä¸ªåç§°ä¸æ‚¨è¦ä½¿ç”¨çš„å…¬å…±å±€éƒ¨å˜é‡åç§°ï¼ˆä¾‹å¦‚url, sshï¼‰å†²çªçš„åŒ…ï¼Œå¹¶ä¸”æ‚¨å¸Œæœ›é‡å‘½åè¯¥åŒ…ï¼Œé¦–é€‰æ–¹æ³•æ˜¯ä½¿ç”¨pkgåç¼€ï¼ˆä¾‹å¦‚urlpkgï¼‰ã€‚è¯·æ³¨æ„ï¼Œå¯ä»¥ä½¿ç”¨å±€éƒ¨å˜é‡éšè—åŒ…ï¼›ä»…å½“æ­¤ç±»å˜é‡åœ¨èŒƒå›´å†…æ—¶ä»éœ€è¦ä½¿ç”¨åŒ…æ—¶ï¼Œæ‰éœ€è¦é‡å‘½åã€‚\nå¯¼å…¥åˆ†ç»„ å¯¼å…¥åº”åˆ†ä¸ºä¸¤ç»„ï¼š\næ ‡å‡†åº“åŒ… å…¶ä»–ï¼ˆé¡¹ç›®å’Œé”€å”®ï¼‰åŒ… 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 // Good: package main import ( \"fmt\" \"hash/adler32\" \"os\" \"github.com/dsnet/compress/flate\" \"golang.org/x/text/encoding\" \"google.golang.org/protobuf/proto\" foopb \"myproj/foo/proto/proto\" _ \"myproj/rpc/protocols/dial\" _ \"myproj/security/auth/authhooks\" ) â€‹\tå°†é¡¹ç›®åŒ…åˆ†æˆå¤šä¸ªç»„æ˜¯å¯ä»¥æ¥å—çš„ï¼Œä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æƒ³è¦ä¸€ä¸ªå•ç‹¬çš„ç»„æ¥é‡å‘½åã€import-only-for-side-effects æˆ–å¦ä¸€ä¸ªç‰¹æ®Šçš„å¯¼å…¥ç»„ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 // Good: package main import ( \"fmt\" \"hash/adler32\" \"os\" \"github.com/dsnet/compress/flate\" \"golang.org/x/text/encoding\" \"google.golang.org/protobuf/proto\" foopb \"myproj/foo/proto/proto\" _ \"myproj/rpc/protocols/dial\" _ \"myproj/security/auth/authhooks\" ) â€‹\tæ³¨æ„ï¼šgoimportså·¥å…·ä¸æ”¯æŒç»´æŠ¤å¯é€‰ç»„ - è¶…å‡ºæ ‡å‡†åº“å’Œ Google å¯¼å…¥ä¹‹é—´å¼ºåˆ¶åˆ†ç¦»æ‰€éœ€çš„æ‹†åˆ†ã€‚é¢å¤–çš„å¯¼å…¥å­ç»„éœ€è¦ä½œè€…å’Œå®¡ç¨¿äººçš„æ³¨æ„ï¼Œä»¥ä¿æŒç¬¦åˆçŠ¶æ€ã€‚\nâ€‹\tä¹Ÿæ˜¯ AppEngine åº”ç”¨ç¨‹åºçš„ Google ç¨‹åºåº”è¯¥æœ‰ä¸€ä¸ªå•ç‹¬çš„ç»„ç”¨äº AppEngine å¯¼å…¥ã€‚\nå¯¼å…¥â€œç©ºç™½â€ ( import _) ä»…ä¸ºäº†å‰¯ä½œç”¨import _ \"package\"è€Œå¯¼å…¥çš„åŒ…ï¼ˆä½¿ç”¨è¯­æ³• ï¼‰åªèƒ½åœ¨ä¸»åŒ…æˆ–éœ€è¦å®ƒä»¬çš„æµ‹è¯•ä¸­å¯¼å…¥ã€‚\næ­¤ç±»è½¯ä»¶åŒ…çš„ä¸€äº›ç¤ºä¾‹åŒ…æ‹¬ï¼š\næ—¶é—´/tzdata å›¾åƒå¤„ç†ä»£ç ä¸­çš„image/jpeg é¿å…åœ¨åº“åŒ…ä¸­å¯¼å…¥ç©ºç™½ï¼Œå³ä½¿åº“é—´æ¥ä¾èµ–äºå®ƒä»¬ã€‚å°†å‰¯ä½œç”¨å¯¼å…¥é™åˆ¶åˆ°ä¸»åŒ…æœ‰åŠ©äºæ§åˆ¶ä¾èµ–æ€§ï¼Œå¹¶ä½¿å¾—ç¼–å†™ä¾èµ–äºä¸åŒå¯¼å…¥çš„æµ‹è¯•æˆä¸ºå¯èƒ½ï¼Œè€Œä¸ä¼šå‘ç”Ÿå†²çªæˆ–æµªè´¹æ„å»ºæˆæœ¬ã€‚\nä»¥ä¸‹æ˜¯æ­¤è§„åˆ™çš„å”¯ä¸€ä¾‹å¤–æƒ…å†µï¼š\næ‚¨å¯ä»¥ä½¿ç”¨ç©ºç™½å¯¼å…¥ç»•è¿‡ nogo é™æ€æ£€æŸ¥å™¨ä¸­å¯¹ä¸å…è®¸å¯¼å…¥çš„æ£€æŸ¥ã€‚ æ‚¨å¯ä»¥åœ¨ä½¿ç”¨ç¼–è¯‘å™¨æŒ‡ä»¤çš„æºæ–‡ä»¶ä¸­ä½¿ç”¨åµŒå…¥åŒ…çš„ç©ºç™½å¯¼å…¥ã€‚//go:embed **æç¤ºï¼š**å¦‚æœæ‚¨åˆ›å»ºçš„åº“åŒ…é—´æ¥ä¾èµ–äºç”Ÿäº§ä¸­çš„å‰¯ä½œç”¨å¯¼å…¥ï¼Œè¯·è®°å½•é¢„æœŸç”¨é€”ã€‚\nå¯¼å…¥â€œç‚¹â€( import .) â€‹\timport .è¡¨å•æ˜¯ä¸€ç§è¯­è¨€åŠŸèƒ½ï¼Œå…è®¸å°†ä»å¦ä¸€ä¸ªåŒ…å¯¼å‡ºçš„æ ‡è¯†ç¬¦æ— æ¡ä»¶åœ°å¸¦åˆ°å½“å‰åŒ…ä¸­ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…è¯­è¨€è§„èŒƒã€‚\nä¸è¦åœ¨ Google ä»£ç åº“ä¸­ä½¿ç”¨æ­¤åŠŸèƒ½ï¼›è¿™ä½¿å¾—æ›´éš¾åˆ¤æ–­åŠŸèƒ½æ¥è‡ªä½•å¤„ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 // Bad: package foo_test import ( \"bar/testutil\" // also imports \"foo\" . \"foo\" ) var myThing = Bar() // Bar defined in package foo; no qualification needed. // Good: package foo_test import ( \"bar/testutil\" // also imports \"foo\" \"foo\" ) var myThing = foo.Bar() é”™è¯¯ è¿”å›é”™è¯¯ â€‹\tç”¨äºerrorè¡¨ç¤ºå‡½æ•°å¯èƒ½ä¼šå¤±è´¥ã€‚æŒ‰ç…§æƒ¯ä¾‹ï¼Œerroræ˜¯æœ€åä¸€ä¸ªç»“æœå‚æ•°ã€‚\n1 2 // Good: func Good() error { /* ... */ } â€‹\tè¿”å›nilé”™è¯¯æ˜¯è¡¨ç¤ºæ“ä½œæˆåŠŸçš„æƒ¯ç”¨æ–¹å¼ï¼Œå¦åˆ™å¯èƒ½ä¼šå¤±è´¥ã€‚å¦‚æœå‡½æ•°è¿”å›é”™è¯¯ï¼Œé™¤éå¦æœ‰æ˜ç¡®è¯´æ˜ï¼Œå¦åˆ™è°ƒç”¨è€…å¿…é¡»å°†æ‰€æœ‰éé”™è¯¯è¿”å›å€¼è§†ä¸ºæœªæŒ‡å®šã€‚é€šå¸¸ï¼Œéé”™è¯¯è¿”å›å€¼æ˜¯å®ƒä»¬çš„é›¶å€¼ï¼Œä½†è¿™ä¸èƒ½å‡è®¾ã€‚\n1 2 3 4 5 6 7 8 // Good: func GoodLookup() (*Result, error) { // ... if err != nil { return nil, err } return res, nil } â€‹\tè¿”å›é”™è¯¯çš„å¯¼å‡ºå‡½æ•°åº”è¯¥ä½¿ç”¨errorç±»å‹è¿”å›å®ƒä»¬ã€‚å…·ä½“çš„é”™è¯¯ç±»å‹å®¹æ˜“å—åˆ°ç»†å¾®é”™è¯¯çš„å½±å“ï¼šå…·ä½“çš„nilæŒ‡é’ˆå¯ä»¥åŒ…è£…åˆ°æ¥å£ä¸­ï¼Œä»è€Œå˜æˆéé›¶å€¼ï¼ˆè¯·å‚é˜… ä¸»é¢˜ä¸Šçš„ Go FAQ æ¡ç›®ï¼‰ã€‚\n1 2 // Bad: func Bad() *os.PathError { /*...*/ } â€‹\tæç¤ºï¼šå¸¦æœ‰context.Contextå‚æ•°çš„å‡½æ•°é€šå¸¸åº”è¿”å›ä¸€ä¸ªerrorï¼Œä»¥ä¾¿è°ƒç”¨è€…å¯ä»¥ç¡®å®šåœ¨å‡½æ•°è¿è¡Œæ—¶ä¸Šä¸‹æ–‡æ˜¯å¦è¢«å–æ¶ˆã€‚\né”™è¯¯å­—ç¬¦ä¸² â€‹\té”™è¯¯å­—ç¬¦ä¸²ä¸åº”å¤§å†™ï¼ˆé™¤éä»¥å¯¼å‡ºåç§°ã€ä¸“æœ‰åè¯æˆ–é¦–å­—æ¯ç¼©å†™è¯å¼€å¤´ï¼‰å¹¶ä¸”ä¸åº”ä»¥æ ‡ç‚¹ç¬¦å·ç»“å°¾ã€‚è¿™æ˜¯å› ä¸ºé”™è¯¯å­—ç¬¦ä¸²é€šå¸¸åœ¨æ‰“å°ç»™ç”¨æˆ·ä¹‹å‰å‡ºç°åœ¨å…¶ä»–ä¸Šä¸‹æ–‡ä¸­ã€‚\n1 2 3 4 // Bad: err := fmt.Errorf(\"Something bad happened.\") // Good: err := fmt.Errorf(\"something bad happened\") â€‹\tå¦ä¸€æ–¹é¢ï¼Œå®Œæ•´æ˜¾ç¤ºæ¶ˆæ¯ï¼ˆæ—¥å¿—è®°å½•ã€æµ‹è¯•å¤±è´¥ã€API å“åº”æˆ–å…¶ä»– UIï¼‰çš„æ ·å¼å–å†³äºï¼Œä½†é€šå¸¸åº”å¤§å†™ã€‚\n1 2 3 4 // Good: log.Infof(\"Operation aborted: %v\", err) log.Errorf(\"Operation aborted: %v\", err) t.Errorf(\"Op(%q) failed unexpectedly; err=%v\", args, err) å¤„ç†é”™è¯¯ â€‹\té‡åˆ°é”™è¯¯çš„ä»£ç åº”è¯¥æ…é‡é€‰æ‹©å¦‚ä½•å¤„ç†å®ƒã€‚_ä½¿ç”¨å˜é‡ä¸¢å¼ƒé”™è¯¯é€šå¸¸æ˜¯ä¸åˆé€‚çš„ã€‚å¦‚æœå‡½æ•°è¿”å›é”™è¯¯ï¼Œè¯·æ‰§è¡Œä»¥ä¸‹æ“ä½œä¹‹ä¸€ï¼š\nç«‹å³å¤„ç†å¹¶è§£å†³é”™è¯¯ã€‚ å°†é”™è¯¯è¿”å›ç»™è°ƒç”¨è€…ã€‚ åœ¨ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œè¯·è‡´ç”µlog.Fatalæˆ–ï¼ˆå¦‚æœç»å¯¹å¿…è¦ï¼‰ panicã€‚ æ³¨æ„ï¼š log.Fatalfä¸æ˜¯æ ‡å‡†åº“æ—¥å¿—ã€‚å‚è§ [#logging]ã€‚\nâ€‹\tåœ¨æå°‘æ•°æƒ…å†µä¸‹ï¼Œå¿½ç•¥æˆ–ä¸¢å¼ƒé”™è¯¯æ˜¯åˆé€‚çš„ï¼ˆä¾‹å¦‚(*bytes.Buffer).Writeï¼Œè®°å½•çš„è°ƒç”¨æ°¸è¿œä¸ä¼šå¤±è´¥ï¼‰ï¼Œéšé™„çš„æ³¨é‡Šåº”è¯¥è§£é‡Šä¸ºä»€ä¹ˆè¿™æ˜¯å®‰å…¨çš„ã€‚\n1 2 3 4 // Good: var b *bytes.Buffer n, _ := b.Write(p) // never returns a non-nil error æœ‰å…³é”™è¯¯å¤„ç†çš„æ›´å¤šè®¨è®ºå’Œç¤ºä¾‹ï¼Œè¯·å‚é˜… Effective Go and best practicesã€‚\nå¸¦å†…é”™è¯¯ â€‹\tåœ¨ C å’Œç±»ä¼¼è¯­è¨€ä¸­ï¼Œå‡½æ•°è¿”å›å€¼ï¼ˆå¦‚ -1ã€null æˆ–ç©ºå­—ç¬¦ä¸²ï¼‰ä»¥è¡¨ç¤ºé”™è¯¯æˆ–ç¼ºå°‘ç»“æœæ˜¯å¾ˆå¸¸è§çš„ã€‚è¿™ç§°ä¸ºå¸¦å†…é”™è¯¯å¤„ç†ã€‚\n1 2 3 // Bad: // Lookup returns the value for key or -1 if there is no mapping for key. func Lookup(key string) int â€‹\tæœªèƒ½æ£€æŸ¥å¸¦å†…é”™è¯¯å€¼å¯èƒ½ä¼šå¯¼è‡´é”™è¯¯ï¼Œå¹¶å°†é”™è¯¯å½’å› äºé”™è¯¯çš„å‡½æ•°ã€‚\n1 2 3 4 // Bad: // The following line returns an error that Parse failed for the input value, // whereas the failure was that there is no mapping for missingKey. return Parse(Lookup(missingKey)) â€‹\tGo å¯¹å¤šä¸ªè¿”å›å€¼çš„æ”¯æŒæä¾›äº†æ›´å¥½çš„è§£å†³æ–¹æ¡ˆï¼ˆè¯·å‚é˜… Effective Go éƒ¨åˆ†çš„å¤šä¸ªè¿”å›å€¼ï¼‰ã€‚å‡½æ•°ä¸åº”è¦æ±‚å®¢æˆ·ç«¯æ£€æŸ¥å¸¦å†…é”™è¯¯å€¼ï¼Œè€Œåº”è¿”å›ä¸€ä¸ªé™„åŠ å€¼ä»¥æŒ‡ç¤ºå…¶å…¶ä»–è¿”å›å€¼æ˜¯å¦æœ‰æ•ˆã€‚è¿™ä¸ªè¿”å›å€¼å¯èƒ½æ˜¯ä¸€ä¸ªé”™è¯¯ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œæ— éœ€è§£é‡Šï¼Œåº”è¯¥æ˜¯æœ€ç»ˆçš„è¿”å›å€¼ã€‚\n1 2 3 // Good: // Lookup returns the value for key or ok=false if there is no mapping for key. func Lookup(key string) (value string, ok bool) â€‹\tæ­¤ API å¯é˜²æ­¢è°ƒç”¨è€…é”™è¯¯å†™å…¥Parse(Lookup(key))è€Œå¯¼è‡´ç¼–è¯‘æ—¶é”™è¯¯ï¼Œå› ä¸ºLookup(key)å®ƒæœ‰ 2 ä¸ªè¾“å‡ºã€‚\nä»¥è¿™ç§æ–¹å¼è¿”å›é”™è¯¯é¼“åŠ±æ›´å¥å£®å’Œæ˜ç¡®çš„é”™è¯¯å¤„ç†ï¼š\n1 2 3 4 5 6 // Good: value, ok := Lookup(key) if !ok { return fmt.Errorf(\"no value for %q\", key) } return Parse(value) â€‹\tä¸€äº›æ ‡å‡†åº“å‡½æ•°ï¼Œå¦‚ packageä¸­çš„å‡½æ•°stringsï¼Œè¿”å›å¸¦å†…é”™è¯¯å€¼ã€‚è¿™æå¤§åœ°ç®€åŒ–äº†å­—ç¬¦ä¸²æ“ä½œä»£ç ï¼Œä½†ä»£ä»·æ˜¯éœ€è¦ç¨‹åºå‘˜æ›´åŠ å‹¤å¥‹ã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒGoogle ä»£ç åº“ä¸­çš„ Go ä»£ç åº”è¯¥ä¸ºé”™è¯¯è¿”å›é¢å¤–çš„å€¼ã€‚\nç¼©è¿›é”™è¯¯æµç¨‹ â€‹\tåœ¨ç»§ç»­æ‚¨çš„ä»£ç çš„å…¶ä½™éƒ¨åˆ†ä¹‹å‰å¤„ç†é”™è¯¯ã€‚è¿™é€šè¿‡ä½¿è¯»è€…èƒ½å¤Ÿå¿«é€Ÿæ‰¾åˆ°æ­£å¸¸è·¯å¾„æ¥æé«˜ä»£ç çš„å¯è¯»æ€§ã€‚åŒæ ·çš„é€»è¾‘é€‚ç”¨äºä»»ä½•æµ‹è¯•æ¡ä»¶ç„¶åä»¥ç»ˆæ­¢æ¡ä»¶ç»“æŸçš„å—ï¼ˆä¾‹å¦‚returnï¼Œï¼Œï¼Œpanicï¼‰log.Fatalã€‚\nâ€‹\tå¦‚æœä¸æ»¡è¶³ç»ˆæ­¢æ¡ä»¶ï¼Œåˆ™è¿è¡Œçš„ä»£ç åº”å‡ºç°åœ¨if å—ä¹‹åï¼Œå¹¶ä¸”ä¸åº”åœ¨elseå­å¥ä¸­ç¼©è¿›ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 // Good: if err != nil { // error handling return // or continue, etc. } // normal code // Bad: if err != nil { // error handling } else { // normal code that looks abnormal due to indentation } **æç¤ºï¼š**å¦‚æœæ‚¨åœ¨å¤šè¡Œä»£ç ä¸­ä½¿ç”¨ä¸€ä¸ªå˜é‡ï¼Œé€šå¸¸ä¸å€¼å¾—ä½¿ç”¨if-with-initializer æ ·å¼ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œé€šå¸¸æœ€å¥½å°†å£°æ˜ç§»å‡ºå¹¶ä½¿ç”¨æ ‡å‡†if è¯­å¥ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 // Good: x, err := f() if err != nil { // error handling return } // lots of code that uses x // across multiple lines // Bad: if x, err := f(); err != nil { // error handling return } else { // lots of code that uses x // across multiple lines } æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…Go æŠ€å·§ #1ï¼šè§†çº¿å’Œ TotTï¼šé€šè¿‡å‡å°‘åµŒå¥— æ¥é™ä½ä»£ç å¤æ‚æ€§ã€‚\næ–‡å­—æ ¼å¼è¯­æ³• æ— åˆ‡ç‰‡ â€‹\tnilå¯¹äºå¤§å¤šæ•°ç”¨é€”ï¼Œç©ºåˆ‡ç‰‡å’Œç©ºåˆ‡ç‰‡ä¹‹é—´æ²¡æœ‰åŠŸèƒ½å·®å¼‚ã€‚å†…ç½®å‡½æ•°åœ¨åˆ‡ç‰‡ä¸Šçš„è¡¨ç°lenå’Œcapé¢„æœŸä¸€æ ·ã€‚nil\n1 2 3 4 5 6 7 8 9 10 11 12 // Good: import \"fmt\" var s []int // nil fmt.Println(s) // [] fmt.Println(len(s)) // 0 fmt.Println(cap(s)) // 0 for range s {...} // no-op s = append(s, 42) fmt.Println(s) // [42] â€‹\tå¦‚æœæ‚¨å°†ç©ºåˆ‡ç‰‡å£°æ˜ä¸ºå±€éƒ¨å˜é‡ï¼ˆå°¤å…¶æ˜¯å¦‚æœå®ƒå¯ä»¥ä½œä¸ºè¿”å›å€¼çš„æ¥æºï¼‰ï¼Œåˆ™é¦–é€‰ nil åˆå§‹åŒ–ä»¥é™ä½è°ƒç”¨è€…å‡ºç°é”™è¯¯çš„é£é™©ã€‚\n1 2 3 4 5 // Good: var t []string // Bad: t := []string{} â€‹\tä¸è¦åˆ›å»ºå¼ºåˆ¶å…¶å®¢æˆ·åŒºåˆ† nil å’Œç©ºåˆ‡ç‰‡çš„ APIã€‚\n1 2 3 4 5 6 7 8 9 10 // Good: // Ping pings its targets. // Returns hosts that successfully responded. func Ping(hosts []string) ([]string, error) { ... } // Bad: // Ping pings its targets and returns a list of hosts // that successfully responded. Can be empty if the input was empty. // nil signifies that a system error occurred. func Ping(hosts []string) []string { ... } â€‹\tåœ¨è®¾è®¡æ¥å£æ—¶ï¼Œé¿å…åŒºåˆ†nilåˆ‡ç‰‡å’Œniléé›¶é•¿åº¦åˆ‡ç‰‡ï¼Œå› ä¸ºè¿™ä¼šå¯¼è‡´ç»†å¾®çš„ç¼–ç¨‹é”™è¯¯ã€‚è¿™é€šå¸¸æ˜¯é€šè¿‡ä½¿ç”¨lento æ£€æŸ¥æ˜¯å¦ä¸ºç©ºæ¥å®Œæˆçš„ï¼Œè€Œä¸æ˜¯== nil.\nâ€‹\tæ­¤å®ç°æ¥å—ä¸¤ä¸ªnilå’Œé›¶é•¿åº¦åˆ‡ç‰‡ä¸ºâ€œç©ºâ€ï¼š\n1 2 3 4 5 6 7 8 // Good: // describeInts describes s with the given prefix, unless s is empty. func describeInts(prefix string, s []int) { if len(s) == 0 { return } fmt.Println(prefix, s) } â€‹\tè€Œä¸æ˜¯ä¾èµ–äºåŒºåˆ«ä½œä¸º API çš„ä¸€éƒ¨åˆ†ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 // Bad: func maybeInts() []int { /* ... */ } // describeInts describes s with the given prefix; pass nil to skip completely. func describeInts(prefix string, s []int) { // The behavior of this function unintentionally changes depending on what // maybeInts() returns in 'empty' cases (nil or []int{}). if s == nil { return } fmt.Println(prefix, s) } describeInts(\"Here are some ints:\", maybeInts()) æœ‰å…³è¿›ä¸€æ­¥è®¨è®ºï¼Œè¯·å‚é˜…å¸¦å†…é”™è¯¯ã€‚\nå‡½æ•°æ ¼å¼åŒ– å‡½æ•°æˆ–æ–¹æ³•å£°æ˜çš„ç­¾ååº”ä¿ç•™åœ¨ä¸€è¡Œä¸­ä»¥é¿å…ç¼©è¿›æ··æ·†ã€‚\nå‡½æ•°å‚æ•°åˆ—è¡¨å¯ä»¥æ„æˆ Go æºæ–‡ä»¶ä¸­æœ€é•¿çš„å‡ è¡Œã€‚ä½†æ˜¯ï¼Œå®ƒä»¬å…ˆäºç¼©è¿›çš„å˜åŒ–ï¼Œå› æ­¤å¾ˆéš¾ä»¥ä¸ä½¿åç»­è¡Œçœ‹èµ·æ¥åƒå‡½æ•°ä½“çš„ä¸€éƒ¨åˆ†çš„æ–¹å¼ä»¥ä»¤äººå›°æƒ‘çš„æ–¹å¼æ–­è¡Œï¼š\n1 2 3 4 5 6 // Bad: func (r *SomeType) SomeLongFunctionName(foo1, foo2, foo3 string, foo4, foo5, foo6 int) { foo7 := bar(foo1) // ... } è¯·å‚é˜…æœ€ä½³å®è·µï¼Œäº†è§£ä¸€äº›é€‰é¡¹ï¼Œä»¥ç¼©çŸ­å‡½æ•°çš„è°ƒç”¨ç«™ç‚¹ï¼Œå¦åˆ™ä¼šæœ‰å¾ˆå¤šå‚æ•°ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 // Good: good := foo.Call(long, CallOptions{ Names: list, Of: of, The: parameters, Func: all, Args: on, Now: separate, Visible: lines, }) // Bad: bad := foo.Call( long, list, of, parameters, all, on, separate, lines, ) é€šå¸¸å¯ä»¥é€šè¿‡åˆ†è§£å‡ºå±€éƒ¨å˜é‡æ¥ç¼©çŸ­è¡Œã€‚\n1 2 3 // Good: local := helper(some, parameters, here) good := foo.Call(list, of, parameters, local) â€‹\tåŒæ ·ï¼Œå‡½æ•°å’Œæ–¹æ³•è°ƒç”¨ä¸åº”ä»…æ ¹æ®è¡Œé•¿åº¦æ¥åˆ†å¼€ã€‚\n1 2 3 4 5 // Good: good := foo.Call(long, list, of, parameters, all, on, one, line) // Bad: bad := foo.Call(long, list, of, parameters, with, arbitrary, line, breaks) â€‹\tä¸è¦ä¸ºç‰¹å®šçš„å‡½æ•°å‚æ•°æ·»åŠ æ³¨é‡Šã€‚ç›¸åï¼Œä½¿ç”¨ é€‰é¡¹ç»“æ„æˆ–å‘å‡½æ•°æ–‡æ¡£æ·»åŠ æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚\n1 2 3 4 5 6 7 // Good: good := server.New(ctx, server.Options{Port: 42}) // Bad: bad := server.New( ctx, 42, // Port ) â€‹\tå¦‚æœè°ƒç”¨ç«™ç‚¹é•¿å¾—è®©äººä¸èˆ’æœï¼Œè¯·è€ƒè™‘é‡æ„ï¼š\n1 2 3 4 5 6 7 8 9 10 // Good: // Sometimes variadic arguments can be factored out replacements := []string{ \"from\", \"to\", // related values can be formatted adjacent to one another \"source\", \"dest\", \"original\", \"new\", } // Use the replacement struct as inputs to NewReplacer. replacer := strings.NewReplacer(replacements...) â€‹\tå¦‚æœ API æ— æ³•æ›´æ”¹æˆ–æœ¬åœ°è°ƒç”¨å¼‚å¸¸ï¼ˆæ— è®ºè°ƒç”¨æ˜¯å¦å¤ªé•¿ï¼‰ï¼Œå¦‚æœæœ‰åŠ©äºç†è§£è°ƒç”¨ï¼Œåˆ™å§‹ç»ˆå…è®¸æ·»åŠ æ¢è¡Œç¬¦ã€‚\n1 2 3 4 5 6 7 8 9 10 11 // Good: canvas.RenderCube(cube, x0, y0, z0, x0, y0, z1, x0, y1, z0, x0, y1, z1, x1, y0, z0, x1, y0, z1, x1, y1, z0, x1, y1, z1, ) è¯·æ³¨æ„ï¼Œä¸Šä¾‹ä¸­çš„çº¿æ¡å¹¶æœªç¯ç»•åœ¨ç‰¹å®šçš„åˆ—è¾¹ç•Œå¤„ï¼Œè€Œæ˜¯æ ¹æ®åæ ‡ä¸‰å…ƒç»„è¿›è¡Œåˆ†ç»„ã€‚\nâ€‹\tå‡½æ•°å†…çš„é•¿å­—ç¬¦ä¸²å­—é¢å€¼ä¸åº”å› è¡Œé•¿è€Œè¢«æ‰“æ–­ã€‚å¯¹äºåŒ…å«æ­¤ç±»å­—ç¬¦ä¸²çš„å‡½æ•°ï¼Œå¯ä»¥åœ¨å­—ç¬¦ä¸²æ ¼å¼åæ·»åŠ æ¢è¡Œç¬¦ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ä¸‹ä¸€è¡Œæˆ–åç»­è¡Œæä¾›å‚æ•°ã€‚å…³äºæ¢è¡Œç¬¦åº”è¯¥å»å“ªé‡Œçš„å†³å®šæœ€å¥½åŸºäºè¾“å…¥çš„è¯­ä¹‰åˆ†ç»„ï¼Œè€Œä¸æ˜¯çº¯ç²¹åŸºäºè¡Œçš„é•¿åº¦ã€‚\n1 2 3 4 5 6 7 8 9 10 // Good: log.Warningf(\"Database key (%q, %d, %q) incompatible in transaction started by (%q, %d, %q)\", currentCustomer, currentOffset, currentKey, txCustomer, txOffset, txKey) // Bad: log.Warningf(\"Database key (%q, %d, %q) incompatible in\"+ \" transaction started by (%q, %d, %q)\", currentCustomer, currentOffset, currentKey, txCustomer, txOffset, txKey) æ¡ä»¶å’Œå¾ªç¯ â€‹\tå£°æ˜ifä¸åº”æ–­è¡Œï¼›å¤šè¡Œifå­å¥ä¼šå¯¼è‡´ ç¼©è¿›æ··ä¹±ã€‚\n1 2 3 4 5 6 7 // Bad: // The second if statement is aligned with the code within the if block, causing // indentation confusion. if db.CurrentStatusIs(db.InTransaction) \u0026\u0026 db.ValuesEqual(db.TransactionKey(), row.Key()) { return db.Errorf(db.TransactionError, \"query failed: row (%v): key does not match transaction key\", row) } å¦‚æœä¸éœ€è¦çŸ­è·¯è¡Œä¸ºï¼Œå¯ä»¥ç›´æ¥æå–å¸ƒå°”æ“ä½œæ•°ï¼š\n1 2 3 4 5 6 // Good: inTransaction := db.CurrentStatusIs(db.InTransaction) keysMatch := db.ValuesEqual(db.TransactionKey(), row.Key()) if inTransaction \u0026\u0026 keysMatch { return db.Error(db.TransactionError, \"query failed: row (%v): key does not match transaction key\", row) } å¯èƒ½è¿˜å¯ä»¥æå–å…¶ä»–å±€éƒ¨å˜é‡ï¼Œå°¤å…¶æ˜¯åœ¨æ¡ä»¶å·²ç»é‡å¤çš„æƒ…å†µä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 // Good: uid := user.GetUniqueUserID() if db.UserIsAdmin(uid) || db.UserHasPermission(uid, perms.ViewServerConfig) || db.UserHasPermission(uid, perms.CreateGroup) { // ... } // Bad: if db.UserIsAdmin(user.GetUniqueUserID()) || db.UserHasPermission(user.GetUniqueUserID(), perms.ViewServerConfig) || db.UserHasPermission(user.GetUniqueUserID(), perms.CreateGroup) { // ... } ifåŒ…å«é—­åŒ…æˆ–å¤šè¡Œç»“æ„æ–‡å­—çš„è¯­å¥åº”ç¡®ä¿å¤§æ‹¬å·åŒ¹é…ä»¥é¿å… ç¼©è¿›æ··æ·†ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 // Good: if err := db.RunInTransaction(func(tx *db.TX) error { return tx.Execute(userUpdate, x, y, z) }); err != nil { return fmt.Errorf(\"user update failed: %s\", err) } // Good: if _, err := client.Update(ctx, \u0026upb.UserUpdateRequest{ ID: userID, User: user, }); err != nil { return fmt.Errorf(\"user update failed: %s\", err) } åŒæ ·ï¼Œä¸è¦å°è¯•åœ¨forè¯­å¥ä¸­æ’å…¥äººä¸ºçš„æ¢è¡Œç¬¦ã€‚å¦‚æœæ²¡æœ‰ä¼˜é›…çš„é‡æ„æ–¹å¼ï¼Œä½ æ€»æ˜¯å¯ä»¥è®©è¿™æ¡çº¿å¾ˆé•¿ï¼š\n1 2 3 4 // Good: for i, max := 0, collection.Size(); i \u003c max \u0026\u0026 !collection.HasPendingWriters(); i++ { // ... } ä½†æ˜¯ï¼Œé€šå¸¸æœ‰ï¼š\n1 2 3 4 5 6 7 // Good: for i, max := 0, collection.Size(); i \u003c max; i++ { if collection.HasPendingWriters() { break } // ... } switchå’Œcaseè¯­å¥ä¹Ÿåº”è¯¥ä¿æŒåœ¨ä¸€è¡Œä¸­ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 // Good: switch good := db.TransactionStatus(); good { case db.TransactionStarting, db.TransactionActive, db.TransactionWaiting: // ... case db.TransactionCommitted, db.NoTransaction: // ... default: // ... } // Bad: switch bad := db.TransactionStatus(); bad { case db.TransactionStarting, db.TransactionActive, db.TransactionWaiting: // ... case db.TransactionCommitted, db.NoTransaction: // ... default: // ... } å¦‚æœè¡Œå¤ªé•¿ï¼Œç¼©è¿›æ‰€æœ‰çš„æ¡ˆä¾‹å¹¶ç”¨ç©ºè¡Œåˆ†éš”å®ƒä»¬ä»¥é¿å…ç¼©è¿›æ··æ·†ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 // Good: switch db.TransactionStatus() { case db.TransactionStarting, db.TransactionActive, db.TransactionWaiting, db.TransactionCommitted: // ... case db.NoTransaction: // ... default: // ... } åœ¨æ¯”è¾ƒå˜é‡å’Œå¸¸é‡çš„æ¡ä»¶è¯­å¥ä¸­ï¼Œå°†å˜é‡å€¼æ”¾åœ¨ç›¸ç­‰è¿ç®—ç¬¦çš„å·¦ä¾§ï¼š\n1 2 3 4 // Good: if result == \"foo\" { // ... } å–è€Œä»£ä¹‹çš„æ˜¯å¸¸æ•°é¦–å…ˆå‡ºç°çš„ä¸å¤ªæ¸…æ™°çš„æªè¾ï¼ˆâ€œYoda style conditionalsâ€ï¼‰ï¼š\n1 2 3 4 // Bad: if \"foo\" == result { // ... } å¤åˆ¶ ä¸ºé¿å…æ„å¤–çš„åˆ«åå’Œç±»ä¼¼é”™è¯¯ï¼Œä»å¦ä¸€ä¸ªåŒ…å¤åˆ¶ç»“æ„æ—¶è¦å°å¿ƒã€‚ä¾‹å¦‚ï¼Œsync.Mutex ä¸å¾—å¤åˆ¶è¯¸å¦‚æ­¤ç±»çš„åŒæ­¥å¯¹è±¡ã€‚\nè¯¥bytes.Bufferç±»å‹åŒ…å«ä¸€ä¸ª[]byteåˆ‡ç‰‡ï¼Œå¹¶ä¸”ä½œä¸ºå¯¹å°å­—ç¬¦ä¸²çš„ä¼˜åŒ–ï¼Œè¿˜åŒ…å«ä¸€ä¸ªåˆ‡ç‰‡å¯èƒ½å¼•ç”¨çš„å°å­—èŠ‚æ•°ç»„ã€‚å¦‚æœæ‚¨å¤åˆ¶ a Bufferï¼Œåˆ™å‰¯æœ¬ä¸­çš„åˆ‡ç‰‡å¯èƒ½ä¼šä¸ºåŸå§‹æ•°ç»„è®¾ç½®åˆ«åï¼Œä»è€Œå¯¼è‡´åç»­æ–¹æ³•è°ƒç”¨äº§ç”Ÿä»¤äººæƒŠè®¶çš„æ•ˆæœã€‚\nTé€šå¸¸ï¼Œå¦‚æœç±»å‹çš„æ–¹æ³•ä¸æŒ‡é’ˆç±»å‹å…³è”ï¼Œåˆ™ä¸è¦å¤åˆ¶è¯¥ç±»å‹çš„å€¼*Tã€‚\n1 2 3 // Bad: b1 := bytes.Buffer{} b2 := b1 è°ƒç”¨é‡‡ç”¨å€¼æ¥æ”¶å™¨çš„æ–¹æ³•å¯ä»¥éšè—å‰¯æœ¬ã€‚å½“æ‚¨ç¼–å†™ API æ—¶ï¼Œå¦‚æœæ‚¨çš„ç»“æ„åŒ…å«ä¸åº”å¤åˆ¶çš„å­—æ®µï¼Œæ‚¨é€šå¸¸åº”è¯¥è·å–å’Œè¿”å›æŒ‡é’ˆç±»å‹ã€‚\nè¿™äº›æ˜¯å¯ä»¥æ¥å—çš„ï¼š\n1 2 3 4 5 6 7 8 9 10 11 // Good: type Record struct { buf bytes.Buffer // other fields omitted } func New() *Record {...} func (r *Record) Process(...) {...} func Consumer(r *Record) {...} ä½†è¿™äº›é€šå¸¸æ˜¯é”™è¯¯çš„ï¼š\n1 2 3 4 5 6 7 8 9 10 // Bad: type Record struct { buf bytes.Buffer // other fields omitted } func (r Record) Process(...) {...} // Makes a copy of r.buf func Consumer(r Record) {...} // Makes a copy of r.buf æœ¬æŒ‡å—ä¹Ÿé€‚ç”¨äºå¤å°sync.Mutexã€‚\næ¥å£ â€‹\tGoæ¥å£é€šå¸¸å±äºä½¿ç”¨æ¥å£ç±»å‹å€¼çš„åŒ…ï¼Œè€Œä¸æ˜¯å®ç°æ¥å£ç±»å‹çš„åŒ…ã€‚å®æ–½åŒ…åº”è¯¥è¿”å›å…·ä½“çš„ï¼ˆé€šå¸¸æ˜¯æŒ‡é’ˆæˆ–ç»“æ„ï¼‰ç±»å‹ã€‚è¿™æ ·ï¼Œæ— éœ€å¤§é‡é‡æ„å³å¯å°†æ–°æ–¹æ³•æ·»åŠ åˆ°å®ç°ä¸­ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…GoTip #49ï¼šæ¥å—æ¥å£ï¼Œè¿”å›å…·ä½“ç±»å‹ ã€‚\nâ€‹\tä¸è¦ä»ä½¿ç”¨æ¥å£çš„ API å¯¼å‡ºæ¥å£çš„æµ‹è¯•æ›¿èº«å®ç°ã€‚ç›¸åï¼Œè®¾è®¡ API ä»¥ä¾¿å¯ä»¥ä½¿ç”¨å®é™…å®ç°çš„å…¬å…± APIå¯¹å…¶è¿›è¡Œæµ‹è¯•ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… GoTip #42ï¼šç¼–å†™ç”¨äºæµ‹è¯•çš„å­˜æ ¹ã€‚å³ä½¿åœ¨ä½¿ç”¨çœŸå®å®ç°ä¸å¯è¡Œçš„æƒ…å†µä¸‹ï¼Œä¹Ÿå¯èƒ½æ²¡æœ‰å¿…è¦å¼•å…¥ä¸€ä¸ªå®Œå…¨è¦†ç›–çœŸå®ç±»å‹ä¸­æ‰€æœ‰æ–¹æ³•çš„æ¥å£ï¼›æ¶ˆè´¹è€…å¯ä»¥åˆ›å»ºä¸€ä¸ªä»…åŒ…å«å…¶æ‰€éœ€æ–¹æ³•çš„æ¥å£ï¼Œå¦‚ GoTip #78ï¼šæœ€å°å¯è¡Œæ¥å£ä¸­æ‰€ç¤ºã€‚\nâ€‹\tè¦æµ‹è¯•ä½¿ç”¨ Stubby RPC å®¢æˆ·ç«¯çš„åŒ…ï¼Œè¯·ä½¿ç”¨çœŸå®çš„å®¢æˆ·ç«¯è¿æ¥ã€‚å¦‚æœæ— æ³•åœ¨æµ‹è¯•ä¸­è¿è¡ŒçœŸå®æœåŠ¡å™¨ï¼ŒGoogle çš„å†…éƒ¨åšæ³•æ˜¯ä½¿ç”¨å†…éƒ¨ rpctest åŒ…ï¼ˆå³å°†æ¨å‡ºï¼ï¼‰è·å–åˆ°æœ¬åœ° [test double] çš„çœŸå®å®¢æˆ·ç«¯è¿æ¥ã€‚\nâ€‹\tä¸è¦åœ¨ä½¿ç”¨ä¹‹å‰å®šä¹‰æ¥å£ï¼ˆè¯·å‚é˜… TotTï¼šä»£ç å¥åº·ï¼šæ¶ˆé™¤ YAGNI æ°”å‘³ï¼‰(YAGNI: ä½ ä¸éœ€è¦å®ƒï¼ˆ You Arenâ€™t Gonna Need It)ã€‚å¦‚æœæ²¡æœ‰å®é™…çš„ä½¿ç”¨ç¤ºä¾‹ï¼Œå°±å¾ˆéš¾åˆ¤æ–­ä¸€ä¸ªæ¥å£æ˜¯å¦å¿…è¦ï¼Œæ›´ä¸ç”¨è¯´å®ƒåº”è¯¥åŒ…å«å“ªäº›æ–¹æ³•äº†ã€‚\nè½¯ä»¶å¼€å‘çš„å¤§éƒ¨åˆ†æˆæœ¬æ˜¯ç»´æŠ¤æˆæœ¬ã€‚å‡å°‘ç»´æŠ¤æˆæœ¬çš„ä¸€ä¸ªæ–¹æ³•æ˜¯ï¼šâ€œåªåœ¨å½“ä½ çœŸæ­£éœ€è¦å®ƒæ—¶ï¼Œæ‰å»ç¼–å†™å®ƒâ€ã€‚\nå¦‚æœåŒ…çš„ç”¨æˆ·ä¸éœ€è¦ä¸ºä»–ä»¬ä¼ é€’ä¸åŒçš„ç±»å‹ï¼Œè¯·ä¸è¦ä½¿ç”¨æ¥å£ç±»å‹å‚æ•°ã€‚\nä¸è¦å¯¼å‡ºåŒ…çš„ç”¨æˆ·ä¸éœ€è¦çš„æ¥å£ã€‚\n**TODOï¼š**åœ¨æ¥å£ä¸Šå†™ä¸€ä¸ªæ›´æ·±å…¥çš„æ–‡æ¡£å¹¶åœ¨æ­¤å¤„é“¾æ¥åˆ°å®ƒã€‚\n1 2 3 4 5 6 // Good: package consumer // consumer.go type Thinger interface { Thing() bool } func Foo(t Thinger) string { ... } 1 2 3 4 5 6 7 // Good: package consumer // consumer_test.go type fakeThinger struct{ ... } func (t fakeThinger) Thing() bool { ... } ... if Foo(fakeThinger{...}) == \"x\" { ... } 1 2 3 4 5 6 7 8 9 // Bad: package producer type Thinger interface { Thing() bool } type defaultThinger struct{ ... } func (t defaultThinger) Thing() bool { ... } func NewThinger() Thinger { return defaultThinger{ ... } } 1 2 3 4 5 6 7 // Good: package producer type Thinger struct{ ... } func (t Thinger) Thing() bool { ... } func NewThinger() Thinger { return Thinger{ ... } } ä¼ å€¼ ä¸è¦ä¸ºäº†èŠ‚çœå‡ ä¸ªå­—èŠ‚è€Œå°†æŒ‡é’ˆä½œä¸ºå‡½æ•°å‚æ•°ä¼ é€’ã€‚\nâ€‹\tå¦‚æœä¸€ä¸ªå‡½æ•°xåªè¯»å–å®ƒçš„å‚æ•°*xï¼Œé‚£ä¹ˆè¿™ä¸ªå‚æ•°ä¸åº”è¯¥æ˜¯ä¸€ä¸ªæŒ‡é’ˆã€‚è¿™æ–¹é¢çš„å¸¸è§å®ä¾‹åŒ…æ‹¬ä¼ é€’ä¸€ä¸ªæŒ‡å‘å­—ç¬¦ä¸² ( *string) çš„æŒ‡é’ˆæˆ–ä¸€ä¸ªæŒ‡å‘æ¥å£å€¼ ( *io.Reader) çš„æŒ‡é’ˆã€‚åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œå€¼æœ¬èº«éƒ½æ˜¯å›ºå®šå¤§å°çš„ï¼Œå¯ä»¥ç›´æ¥ä¼ é€’ã€‚\nâ€‹\tæ­¤å»ºè®®ä¸é€‚ç”¨äºå¤§å‹ç»“æ„ï¼Œç”šè‡³å¯èƒ½ä¼šå¢åŠ å¤§å°çš„å°å‹ç»“æ„ã€‚ç‰¹åˆ«æ˜¯ï¼Œprotocol buffer æ¶ˆæ¯é€šå¸¸åº”è¯¥ç”±æŒ‡é’ˆè€Œä¸æ˜¯å€¼æ¥å¤„ç†ã€‚æŒ‡é’ˆç±»å‹æ»¡è¶³ proto.Messageæ¥å£ï¼ˆè¢« , ç­‰æ¥å—proto.Marshalï¼‰protocmp.Transformï¼Œå¹¶ä¸”åè®®ç¼“å†²åŒºæ¶ˆæ¯å¯èƒ½éå¸¸å¤§ï¼Œå¹¶ä¸”é€šå¸¸ä¼šéšç€æ—¶é—´çš„æ¨ç§»è€Œå˜å¤§ã€‚\næ¥æ”¶å™¨ç±»å‹ â€‹\tæ–¹æ³•æ¥æ”¶è€…å¯ä»¥ä½œä¸ºå€¼æˆ–æŒ‡é’ˆä¼ é€’ï¼Œå°±å¥½åƒå®ƒæ˜¯å¸¸è§„å‡½æ•°å‚æ•°ä¸€æ ·ã€‚é€‰æ‹©å“ªä¸ªåº”è¯¥åŸºäºè¯¥æ–¹æ³•åº”è¯¥å±äºå“ªä¸ªæ–¹æ³•é›†ã€‚\nâ€‹\t**æ­£ç¡®æ€§èƒœè¿‡é€Ÿåº¦æˆ–ç®€å•æ€§ã€‚**åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ‚¨å¿…é¡»ä½¿ç”¨æŒ‡é’ˆå€¼ã€‚åœ¨å…¶ä»–æƒ…å†µä¸‹ï¼Œå¦‚æœæ‚¨å¯¹ä»£ç å°†å¦‚ä½•å¢é•¿æ²¡æœ‰å¾ˆå¥½çš„äº†è§£ï¼Œåˆ™ä¸ºå¤§å‹ç±»å‹é€‰æ‹©æŒ‡é’ˆæˆ–ä½œä¸ºé¢å‘æœªæ¥çš„æŒ‡é’ˆï¼Œå¹¶ä¸ºç®€å•çš„æ™®é€šæ—§æ•°æ®ä½¿ç”¨å€¼ã€‚\nä¸‹é¢çš„åˆ—è¡¨æ›´è¯¦ç»†åœ°è¯´æ˜äº†æ¯ä¸ªæ¡ˆä¾‹ï¼š\nå¦‚æœæ¥æ”¶è€…æ˜¯ä¸€ä¸ªåˆ‡ç‰‡å¹¶ä¸”è¯¥æ–¹æ³•ä¸é‡æ–°åˆ‡ç‰‡æˆ–é‡æ–°åˆ†é…åˆ‡ç‰‡ï¼Œè¯·ä½¿ç”¨å€¼è€Œä¸æ˜¯æŒ‡é’ˆã€‚\n1 2 3 4 // Good: type Buffer []byte func (b Buffer) Len() int { return len(b) } å¦‚æœè¯¥æ–¹æ³•éœ€è¦æ”¹å˜æ¥æ”¶è€…ï¼Œåˆ™æ¥æ”¶è€…å¿…é¡»æ˜¯ä¸€ä¸ªæŒ‡é’ˆã€‚\n1 2 3 4 5 6 7 8 9 // Good: type Counter int func (c *Counter) Inc() { *c++ } // See https://pkg.go.dev/container/heap. type Queue []Item func (q *Queue) Push(x Item) { *q = append([]Item{x}, *q...) } å¦‚æœæ¥æ”¶è€…æ˜¯ä¸€ä¸ªåŒ…å« æ— æ³•å®‰å…¨å¤åˆ¶çš„å­—æ®µçš„ç»“æ„ï¼Œè¯·ä½¿ç”¨æŒ‡é’ˆæ¥æ”¶è€…ã€‚å¸¸è§çš„ä¾‹å­æ˜¯sync.Mutexå’Œå…¶ä»–åŒæ­¥ç±»å‹ã€‚\n1 2 3 4 5 6 7 8 9 10 11 // Good: type Counter struct { mu sync.Mutex total int } func (c *Counter) Inc() { c.mu.Lock() defer c.mu.Unlock() c.total++ } **æç¤ºï¼š**æ£€æŸ¥ç±»å‹çš„Godocä»¥è·å–æœ‰å…³å¤åˆ¶æ˜¯å¦å®‰å…¨çš„ä¿¡æ¯ã€‚\nå¦‚æœæ¥æ”¶å™¨æ˜¯â€œå¤§â€ç»“æ„æˆ–æ•°ç»„ï¼ŒæŒ‡é’ˆæ¥æ”¶å™¨å¯èƒ½æ›´æœ‰æ•ˆã€‚ä¼ é€’ç»“æ„ç­‰åŒäºå°†å…¶æ‰€æœ‰å­—æ®µæˆ–å…ƒç´ ä½œä¸ºå‚æ•°ä¼ é€’ç»™æ–¹æ³•ã€‚å¦‚æœè¿™çœ‹èµ·æ¥å¤ªå¤§è€Œä¸èƒ½ æŒ‰å€¼ä¼ é€’ï¼Œé‚£ä¹ˆæŒ‡é’ˆæ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚\nå¯¹äºå°†è°ƒç”¨æˆ–ä¸å…¶ä»–ä¿®æ”¹æ¥æ”¶å™¨çš„å‡½æ•°åŒæ—¶è¿è¡Œçš„æ–¹æ³•ï¼Œå¦‚æœè¿™äº›ä¿®æ”¹å¯¹æ‚¨çš„æ–¹æ³•ä¸å¯è§ï¼Œè¯·ä½¿ç”¨ä¸€ä¸ªå€¼ï¼›å¦åˆ™ä½¿ç”¨æŒ‡é’ˆã€‚\nå¦‚æœæ¥æ”¶å™¨æ˜¯ä¸€ä¸ªç»“æ„æˆ–æ•°ç»„ï¼Œå…¶ä¸­ä»»ä½•ä¸€ä¸ªå…ƒç´ éƒ½æ˜¯æŒ‡å‘å¯èƒ½å‘ç”Ÿå˜åŒ–çš„ä¸œè¥¿çš„æŒ‡é’ˆï¼Œåˆ™æ›´å–œæ¬¢æŒ‡é’ˆæ¥æ”¶å™¨ä»¥ä½¿è¯»è€…æ¸…æ¥šåœ°äº†è§£å¯å˜æ€§çš„æ„å›¾ã€‚\n1 2 3 4 5 6 7 8 // Good: type Counter struct { m *Metric } func (c *Counter) Inc() { c.m.Add(1) } å¦‚æœæ¥æ”¶è€…æ˜¯å†…ç½®ç±»å‹ï¼Œä¾‹å¦‚æ•´æ•°æˆ–å­—ç¬¦ä¸²ï¼Œä¸éœ€è¦ä¿®æ”¹ï¼Œåˆ™ä½¿ç”¨å€¼ã€‚\n1 2 3 4 // Good: type User string func (u User) String() { return string(u) } å¦‚æœæ¥æ”¶è€…æ˜¯æ˜ å°„ã€å‡½æ•°æˆ–é€šé“ï¼Œè¯·ä½¿ç”¨å€¼è€Œä¸æ˜¯æŒ‡é’ˆã€‚\n1 2 3 4 5 // Good: // See https://pkg.go.dev/net/http#Header. type Header map[string][]string func (h Header) Add(key, value string) { /* omitted */ } å¦‚æœæ¥æ”¶è€…æ˜¯ä¸€ä¸ªâ€œå°â€æ•°ç»„æˆ–ç»“æ„ï¼Œå®ƒè‡ªç„¶æ˜¯ä¸€ä¸ªæ²¡æœ‰å¯å˜å­—æ®µå’ŒæŒ‡é’ˆçš„å€¼ç±»å‹ï¼Œé‚£ä¹ˆå€¼æ¥æ”¶è€…é€šå¸¸æ˜¯æ­£ç¡®çš„é€‰æ‹©ã€‚\n1 2 3 4 5 // Good: // See https://pkg.go.dev/time#Time. type Time struct { /* omitted */ } func (t Time) Add(d Duration) Time { /* omitted */ } å¦‚æœ‰ç–‘é—®ï¼Œè¯·ä½¿ç”¨æŒ‡é’ˆæ¥æ”¶å™¨ã€‚\nä½œä¸ºä¸€èˆ¬å‡†åˆ™ï¼Œæ›´å–œæ¬¢ä½¿ç±»å‹çš„æ–¹æ³•å…¨éƒ¨ä¸ºæŒ‡é’ˆæ–¹æ³•æˆ–å…¨éƒ¨ä¸ºå€¼æ–¹æ³•ã€‚\n**æ³¨æ„ï¼š**å…³äºå°†å€¼æˆ–æŒ‡é’ˆä¼ é€’ç»™å‡½æ•°æ˜¯å¦ä¼šå½±å“æ€§èƒ½ï¼Œå­˜åœ¨å¾ˆå¤šé”™è¯¯ä¿¡æ¯ã€‚ç¼–è¯‘å™¨å¯ä»¥é€‰æ‹©å°†æŒ‡é’ˆä¼ é€’ç»™å †æ ˆä¸Šçš„å€¼ä»¥åŠå¤åˆ¶å †æ ˆä¸Šçš„å€¼ï¼Œä½†åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™äº›è€ƒè™‘ä¸åº”è¶…è¿‡ä»£ç çš„å¯è¯»æ€§å’Œæ­£ç¡®æ€§ã€‚å½“æ€§èƒ½ç¡®å®å¾ˆé‡è¦æ—¶ï¼Œé‡è¦çš„æ˜¯åœ¨å†³å®šä¸€ç§æ–¹æ³•ä¼˜äºå¦ä¸€ç§æ–¹æ³•ä¹‹å‰ï¼Œç”¨ä¸€ä¸ªç°å®çš„åŸºå‡†æ¥åˆ†æè¿™ä¸¤ç§æ–¹æ³•ã€‚\nswitchå’Œbreak â€‹\tä¸è¦åœ¨å­å¥breakæœ«å°¾ä½¿ç”¨æ²¡æœ‰ç›®æ ‡æ ‡ç­¾çš„switch è¯­å¥ï¼›ä»–ä»¬æ˜¯å¤šä½™çš„ã€‚ä¸ C å’Œ Java ä¸åŒï¼ŒswitchGo ä¸­çš„å­å¥ä¼šè‡ªåŠ¨ä¸­æ–­ï¼Œå¹¶ä¸”éœ€è¦ä¸€æ¡fallthroughè¯­å¥æ¥å®ç° C é£æ ¼çš„è¡Œä¸ºã€‚breakå¦‚æœæ‚¨æƒ³é˜æ˜ç©ºå­å¥çš„ç›®çš„ï¼Œè¯·ä½¿ç”¨æ³¨é‡Šè€Œä¸æ˜¯ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 // Good: switch x { case \"A\", \"B\": buf.WriteString(x) case \"C\": // handled outside of the switch statement default: return fmt.Errorf(\"unknown value: %q\", x) } // Bad: switch x { case \"A\", \"B\": buf.WriteString(x) break // this break is redundant case \"C\": break // this break is redundant default: return fmt.Errorf(\"unknown value: %q\", x) } **æ³¨æ„ï¼š**å¦‚æœswitchå­å¥åœ¨forå¾ªç¯å†…ï¼Œåˆ™ä½¿ç”¨breakwithin switchä¸ä¼šé€€å‡ºå°é—­forå¾ªç¯ã€‚\n1 2 3 4 5 6 for { switch x { case \"A\": break // exits the switch, not the loop } } forè¦é€€å‡ºå°é—­å¾ªç¯ï¼Œè¯·åœ¨è¯­å¥ä¸Šä½¿ç”¨æ ‡ç­¾ï¼š\n1 2 3 4 5 6 7 loop: for { switch x { case \"A\": break loop // exits the loop } } ","wordCount":"11159","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","author":{"@type":"Person","name":"Luenci"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://luenci.com/en/posts/golang%E4%BB%A3%E7%A0%81%E9%A3%8E%E6%A0%BC%E6%8C%87%E5%8D%97/"},"publisher":{"@type":"Organization","name":"Luenci","logo":{"@type":"ImageObject","url":"https://luenci.com/images/L.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://luenci.com/en/ accesskey=h title="Luenci (Alt + H)"><img src=https://luenci.com/images/avatar.jpg alt aria-label=logo height=35>Luenci</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://luenci.com/en/ title=ğŸ ä¸»é¡µ><span>ğŸ ä¸»é¡µ</span></a></li><li><a href=https://luenci.com/en/posts title=ğŸ“šæ–‡ç« ><span>ğŸ“šæ–‡ç« </span></a></li><li><a href=https://luenci.com/en/search title="ğŸ”æœç´¢ (Alt + /)" accesskey=/><span>ğŸ”æœç´¢</span></a></li><li><a href=https://luenci.com/en/archives title=â±æ—¶é—´è½´><span>â±æ—¶é—´è½´</span></a></li><li><a href=https://luenci.com/en/tags title=ğŸ”–æ ‡ç­¾><span>ğŸ”–æ ‡ç­¾</span></a></li><li><a href=https://luenci.com/en/about title=ğŸ™‹ğŸ»â€â™‚ï¸å…³äº><span>ğŸ™‹ğŸ»â€â™‚ï¸å…³äº</span></a></li><li><a href=https://luenci.com/en/links title=ğŸ¤å‹é“¾><span>ğŸ¤å‹é“¾</span></a></li><li><a href=https://luenci.com/en/index.xml title=ğŸ“¬RSS><span>ğŸ“¬RSS</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://luenci.com/en/>Home</a>&nbsp;Â»&nbsp;<a href=https://luenci.com/en/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">GO ä»£ç é£æ ¼æŒ‡å—</h1><div class=post-meta>ğŸ“…æœ€åæ›´æ–°:&nbsp;0001-01-01&nbsp|&nbspâ²ï¸æ—¶é•¿: 23 min&nbsp|&nbspğŸ“–å­—æ•°: 11159 words&nbsp;|&nbsp;Luenci</div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>ç›®å½•</span></summary><div class=inner><ul><li><a href=#go-%e4%bb%a3%e7%a0%81%e9%a3%8e%e6%a0%bc%e6%8c%87%e5%8d%97 aria-label="GO ä»£ç é£æ ¼æŒ‡å—">GO ä»£ç é£æ ¼æŒ‡å—</a><ul><li><a href=#%e9%a3%8e%e6%a0%bc%e5%8e%9f%e5%88%99 aria-label=é£æ ¼åŸåˆ™>é£æ ¼åŸåˆ™</a></li><li><a href=#%e5%91%bd%e5%90%8d aria-label=å‘½å>å‘½å</a><ul><li><a href=#%e4%b8%8b%e5%88%92%e7%ba%bf aria-label=ä¸‹åˆ’çº¿>ä¸‹åˆ’çº¿</a></li><li><a href=#%e5%8c%85%e5%90%8d aria-label=åŒ…å>åŒ…å</a></li><li><a href=#%e5%8f%82%e6%95%b0%e5%88%ab%e5%90%8d aria-label=å‚æ•°åˆ«å>å‚æ•°åˆ«å</a></li><li><a href=#%e5%b8%b8%e9%87%8f%e5%90%8d%e7%a7%b0 aria-label=å¸¸é‡åç§°>å¸¸é‡åç§°</a></li><li><a href=#%e7%bc%a9%e5%86%99%e8%af%8d aria-label=ç¼©å†™è¯>ç¼©å†™è¯</a></li><li><a href=#%e5%87%bd%e6%95%b0%e5%90%8d%e7%a7%b0 aria-label=å‡½æ•°åç§°>å‡½æ•°åç§°</a></li><li><a href=#%e5%8f%98%e9%87%8f%e5%90%8d aria-label=å˜é‡å>å˜é‡å</a><ul><li><a href=#%e5%8d%95%e5%ad%97%e6%af%8d%e5%8f%98%e9%87%8f%e5%90%8d aria-label=å•å­—æ¯å˜é‡å>å•å­—æ¯å˜é‡å</a></li></ul></li><li><a href=#%e9%87%8d%e5%a4%8d aria-label=é‡å¤>é‡å¤</a><ul><li><a href=#%e5%8c%85%e4%b8%8e%e5%af%bc%e5%87%ba%e7%9a%84%e7%ac%a6%e5%8f%b7%e5%90%8d%e7%a7%b0 aria-label=åŒ…ä¸å¯¼å‡ºçš„ç¬¦å·åç§°>åŒ…ä¸å¯¼å‡ºçš„ç¬¦å·åç§°</a></li><li><a href=#%e5%8f%98%e9%87%8f%e5%90%8d%e4%b8%8e%e7%b1%bb%e5%9e%8b aria-label=å˜é‡åä¸ç±»å‹>å˜é‡åä¸ç±»å‹</a></li><li><a href=#%e5%a4%96%e9%83%a8%e4%b8%8a%e4%b8%8b%e6%96%87%e4%b8%8e%e6%9c%ac%e5%9c%b0%e5%90%8d%e7%a7%b0 aria-label=å¤–éƒ¨ä¸Šä¸‹æ–‡ä¸æœ¬åœ°åç§°>å¤–éƒ¨ä¸Šä¸‹æ–‡ä¸æœ¬åœ°åç§°</a></li></ul></li></ul></li><li><a href=#imports aria-label=imports>imports</a><ul><li><a href=#%e5%af%bc%e5%85%a5%e9%87%8d%e5%91%bd%e5%90%8d aria-label=å¯¼å…¥é‡å‘½å>å¯¼å…¥é‡å‘½å</a></li><li><a href=#%e5%af%bc%e5%85%a5%e5%88%86%e7%bb%84 aria-label=å¯¼å…¥åˆ†ç»„>å¯¼å…¥åˆ†ç»„</a></li><li><a href=#%e5%af%bc%e5%85%a5%e7%a9%ba%e7%99%bd--import-_ aria-label="å¯¼å…¥â€œç©ºç™½â€ ( import _)">å¯¼å…¥â€œç©ºç™½â€ ( <code>import _</code>)</a></li><li><a href=#%e5%af%bc%e5%85%a5%e7%82%b9-import- aria-label="å¯¼å…¥â€œç‚¹â€( import .)">å¯¼å…¥â€œç‚¹â€( <code>import .</code>)</a></li></ul></li><li><a href=#%e9%94%99%e8%af%af aria-label=é”™è¯¯>é”™è¯¯</a><ul><li><a href=#%e8%bf%94%e5%9b%9e%e9%94%99%e8%af%af aria-label=è¿”å›é”™è¯¯>è¿”å›é”™è¯¯</a></li><li><a href=#%e9%94%99%e8%af%af%e5%ad%97%e7%ac%a6%e4%b8%b2 aria-label=é”™è¯¯å­—ç¬¦ä¸²>é”™è¯¯å­—ç¬¦ä¸²</a></li><li><a href=#%e5%a4%84%e7%90%86%e9%94%99%e8%af%af aria-label=å¤„ç†é”™è¯¯>å¤„ç†é”™è¯¯</a></li><li><a href=#%e5%b8%a6%e5%86%85%e9%94%99%e8%af%af aria-label=å¸¦å†…é”™è¯¯>å¸¦å†…é”™è¯¯</a></li><li><a href=#%e7%bc%a9%e8%bf%9b%e9%94%99%e8%af%af%e6%b5%81%e7%a8%8b aria-label=ç¼©è¿›é”™è¯¯æµç¨‹>ç¼©è¿›é”™è¯¯æµç¨‹</a></li></ul></li><li><a href=#%e6%96%87%e5%ad%97%e6%a0%bc%e5%bc%8f%e8%af%ad%e6%b3%95 aria-label=æ–‡å­—æ ¼å¼è¯­æ³•>æ–‡å­—æ ¼å¼è¯­æ³•</a><ul><li><a href=#%e6%97%a0%e5%88%87%e7%89%87 aria-label=æ— åˆ‡ç‰‡>æ— åˆ‡ç‰‡</a></li><li><a href=#%e5%87%bd%e6%95%b0%e6%a0%bc%e5%bc%8f%e5%8c%96 aria-label=å‡½æ•°æ ¼å¼åŒ–>å‡½æ•°æ ¼å¼åŒ–</a></li><li><a href=#%e6%9d%a1%e4%bb%b6%e5%92%8c%e5%be%aa%e7%8e%af aria-label=æ¡ä»¶å’Œå¾ªç¯>æ¡ä»¶å’Œå¾ªç¯</a></li></ul></li><li><a href=#%e5%a4%8d%e5%88%b6 aria-label=å¤åˆ¶>å¤åˆ¶</a><ul><li><a href=#%e6%8e%a5%e5%8f%a3 aria-label=æ¥å£>æ¥å£</a></li></ul></li><li><a href=#%e4%bc%a0%e5%80%bc aria-label=ä¼ å€¼>ä¼ å€¼</a><ul><li><a href=#%e6%8e%a5%e6%94%b6%e5%99%a8%e7%b1%bb%e5%9e%8b aria-label=æ¥æ”¶å™¨ç±»å‹>æ¥æ”¶å™¨ç±»å‹</a></li><li><a href=#switch%e5%92%8cbreak aria-label=switchå’Œbreak><code>switch</code>å’Œ<code>break</code></a></li></ul></li></ul></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h1 id=go-ä»£ç é£æ ¼æŒ‡å—>GO ä»£ç é£æ ¼æŒ‡å—<a hidden class=anchor aria-hidden=true href=#go-ä»£ç é£æ ¼æŒ‡å—>#</a></h1><h2 id=é£æ ¼åŸåˆ™>é£æ ¼åŸåˆ™<a hidden class=anchor aria-hidden=true href=#é£æ ¼åŸåˆ™>#</a></h2><p>â€‹ æœ‰ä¸€äº›æ€»ä½“åŸåˆ™æ€»ç»“äº†å¦‚ä½•è€ƒè™‘ç¼–å†™å¯è¯»çš„ Go ä»£ç ã€‚ä»¥ä¸‹æ˜¯å¯è¯»ä»£ç çš„å±æ€§ï¼ŒæŒ‰é‡è¦æ€§æ’åºï¼š</p><ol><li><strong><a href=https://google.github.io/styleguide/go/guide#clarity>æ¸…æ™°</a></strong>ï¼šä»£ç çš„ç›®çš„å’ŒåŸºæœ¬åŸç†å¯¹è¯»è€…æ¥è¯´æ˜¯æ¸…æ¥šçš„ã€‚</li><li><strong><a href=https://google.github.io/styleguide/go/guide#simplicity>ç®€å•æ€§</a></strong>ï¼šä»£ç ä»¥å°½å¯èƒ½ç®€å•çš„æ–¹å¼å®ç°å…¶ç›®æ ‡ã€‚</li><li><strong><a href=https://google.github.io/styleguide/go/guide#concision>ç®€æ´</a></strong>ï¼šä»£ç å…·æœ‰é«˜ä¿¡å™ªæ¯”ã€‚</li><li><strong><a href=https://google.github.io/styleguide/go/guide#maintainability>å¯ç»´æŠ¤æ€§</a></strong>ï¼šä»£ç çš„ç¼–å†™ä½¿å…¶æ˜“äºç»´æŠ¤ã€‚</li><li><strong><a href=https://google.github.io/styleguide/go/guide#consistency>ä¸€è‡´æ€§</a></strong>ï¼šä»£ç ä¸æ›´å¹¿æ³›çš„ Google ä»£ç åº“ä¸€è‡´ã€‚</li></ol><h2 id=å‘½å>å‘½å<a hidden class=anchor aria-hidden=true href=#å‘½å>#</a></h2><h3 id=ä¸‹åˆ’çº¿>ä¸‹åˆ’çº¿<a hidden class=anchor aria-hidden=true href=#ä¸‹åˆ’çº¿>#</a></h3><p>Go ä¸­çš„åç§°é€šå¸¸ä¸åº”åŒ…å«ä¸‹åˆ’çº¿ã€‚è¿™ä¸ªåŸåˆ™æœ‰ä¸‰ä¸ªä¾‹å¤–ï¼š</p><ol><li>ä»…ç”±ç”Ÿæˆçš„ä»£ç å¯¼å…¥çš„åŒ…åç§°å¯èƒ½åŒ…å«ä¸‹åˆ’çº¿ã€‚æœ‰å…³å¦‚ä½•é€‰æ‹©å¤šè¯åŒ…åç§°çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…åŒ…<a href=https://google.github.io/styleguide/go/decisions#package-names>åç§°</a></li><li>æ–‡ä»¶ä¸­çš„æµ‹è¯•ã€åŸºå‡†å’Œç¤ºä¾‹å‡½æ•°åç§°<code>*_test.go</code>å¯èƒ½åŒ…å«ä¸‹åˆ’çº¿ã€‚</li><li>ä¸æ“ä½œç³»ç»Ÿæˆ– cgo äº’æ“ä½œçš„ä½çº§åº“å¯èƒ½ä¼šé‡ç”¨æ ‡è¯†ç¬¦ï¼Œå¦‚<a href=https://pkg.go.dev/syscall#pkg-constants><code>syscall</code></a>. åœ¨å¤§å¤šæ•°ä»£ç åº“ä¸­ï¼Œè¿™é¢„è®¡æ˜¯éå¸¸ç½•è§çš„ã€‚</li></ol><h3 id=åŒ…å>åŒ…å<a hidden class=anchor aria-hidden=true href=#åŒ…å>#</a></h3><p>â€‹ Go åŒ…åç§°åº”è¯¥ç®€çŸ­å¹¶ä¸”åªåŒ…å«å°å†™å­—æ¯ã€‚ç”±å¤šä¸ªå•è¯ç»„æˆçš„åŒ…åç§°åº”å…¨éƒ¨å°å†™ã€‚ä¾‹å¦‚ï¼ŒåŒ…<a href=https://pkg.go.dev/text/tabwriter><code>tabwriter</code></a>æœªå‘½åä¸º<code>tabWriter</code>ã€<code>TabWriter</code>æˆ– <code>tab_writer</code>ã€‚</p><p>â€‹ é¿å…é€‰æ‹©å¯èƒ½è¢«å¸¸ç”¨å±€éƒ¨å˜é‡å<a href=https://google.github.io/styleguide/go/best-practices#shadowing>é®è”½çš„åŒ…åã€‚</a>ä¾‹å¦‚ï¼Œ<code>usercount</code>æ˜¯ä¸€ä¸ªæ¯” æ›´å¥½çš„åŒ…å <code>count</code>ï¼Œå› ä¸º<code>count</code>æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„å˜é‡åã€‚</p><p>â€‹ Go åŒ…åç§°ä¸åº”è¯¥æœ‰ä¸‹åˆ’çº¿ã€‚å¦‚æœæ‚¨éœ€è¦å¯¼å…¥åç§°ä¸­ç¡®å®æœ‰ä¸€ä¸ªåŒ…ï¼ˆé€šå¸¸æ¥è‡ªç”Ÿæˆçš„æˆ–ç¬¬ä¸‰æ–¹ä»£ç ï¼‰ï¼Œåˆ™å¿…é¡»åœ¨å¯¼å…¥æ—¶å°†å…¶é‡å‘½åä¸ºé€‚åˆåœ¨ Go ä»£ç ä¸­ä½¿ç”¨çš„åç§°ã€‚</p><p>ä¸€ä¸ªä¾‹å¤–æ˜¯ä»…ç”±ç”Ÿæˆçš„ä»£ç å¯¼å…¥çš„åŒ…åç§°å¯èƒ½åŒ…å«ä¸‹åˆ’çº¿ã€‚å…·ä½“ä¾‹å­åŒ…æ‹¬ï¼š</p><ul><li>ä½¿ç”¨<code>_test</code>å¤–éƒ¨æµ‹è¯•åŒ…çš„åç¼€ï¼Œä¾‹å¦‚é›†æˆæµ‹è¯•</li><li>ä½¿ç”¨<a href=https://go.dev/blog/examples>åŒ…çº§æ–‡æ¡£ç¤ºä¾‹</a><code>_test</code>çš„åç¼€</li></ul><p>â€‹ é¿å…ä½¿ç”¨æ— æ„ä¹‰çš„åŒ…åç§°ï¼Œä¾‹å¦‚<code>util</code>, <code>utility</code>, <code>common</code>,<code>helper</code>ç­‰ã€‚æŸ¥çœ‹æ›´å¤šå…³äº <a href=https://google.github.io/styleguide/go/best-practices#util-packages>æ‰€è°“çš„â€œå®ç”¨ç¨‹åºåŒ…â€</a>çš„ä¿¡æ¯ã€‚</p><p>â€‹ å½“å¯¼å…¥çš„åŒ…è¢«é‡å‘½åï¼ˆä¾‹å¦‚<code>import foopb "path/to/foo_go_proto"</code>ï¼‰æ—¶ï¼ŒåŒ…çš„æœ¬åœ°åç§°å¿…é¡»ç¬¦åˆä¸Šè¿°è§„åˆ™ï¼Œå› ä¸ºæœ¬åœ°åç§°å†³å®šäº†åŒ…ä¸­çš„ç¬¦å·åœ¨æ–‡ä»¶ä¸­çš„å¼•ç”¨æ–¹å¼ã€‚å¦‚æœç»™å®šçš„å¯¼å…¥åœ¨å¤šä¸ªæ–‡ä»¶ä¸­é‡å‘½åï¼Œç‰¹åˆ«æ˜¯åœ¨ç›¸åŒæˆ–é™„è¿‘çš„åŒ…ä¸­ï¼Œåˆ™åº”å°½å¯èƒ½ä½¿ç”¨ç›¸åŒçš„æœ¬åœ°åç§°ä»¥ä¿æŒä¸€è‡´æ€§ã€‚</p><blockquote><p>å¦è¯·å‚é˜…ï¼šhttps://go.dev/blog/package-names</p></blockquote><h3 id=å‚æ•°åˆ«å>å‚æ•°åˆ«å<a hidden class=anchor aria-hidden=true href=#å‚æ•°åˆ«å>#</a></h3><p><a href=https://golang.org/ref/spec#Method_declarations>æ¥æ”¶å™¨</a>å˜é‡åç§°å¿…é¡»æ˜¯ï¼š</p><ul><li>çŸ­ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸¤ä¸ªå­—æ¯çš„é•¿åº¦ï¼‰</li><li>ç±»å‹æœ¬èº«çš„ç¼©å†™</li><li>ä¸€è‡´åœ°åº”ç”¨äºè¯¥ç±»å‹çš„æ¯ä¸ªæ¥æ”¶å™¨</li></ul><table><thead><tr><th>é•¿å</th><th>æ›´å¥½çš„åå­—</th></tr></thead><tbody><tr><td><code>func (tray Tray)</code></td><td><code>func (t Tray)</code></td></tr><tr><td><code>func (info *ResearchInfo)</code></td><td><code>func (ri *ResearchInfo)</code></td></tr><tr><td><code>func (this *ReportWriter)</code></td><td><code>func (w *ReportWriter)</code></td></tr><tr><td><code>func (self *Scanner)</code></td><td><code>func (s *Scanner)</code></td></tr></tbody></table><h3 id=å¸¸é‡åç§°>å¸¸é‡åç§°<a hidden class=anchor aria-hidden=true href=#å¸¸é‡åç§°>#</a></h3><p>â€‹ å¸¸é‡åç§°å¿…é¡»åƒ Go ä¸­çš„æ‰€æœ‰å…¶ä»–åç§°ä¸€æ ·ä½¿ç”¨<a href=https://google.github.io/styleguide/go/guide#mixed-caps>MixedCaps</a>ï¼ˆ<a href=https://tour.golang.org/basics/3>å¯¼å‡º</a> çš„å¸¸é‡ä»¥å¤§å†™å­—æ¯å¼€å¤´ï¼Œè€Œæœªå¯¼å‡ºçš„å¸¸é‡ä»¥å°å†™å­—æ¯å¼€å¤´ã€‚ï¼‰å³ä½¿å®ƒæ‰“ç ´äº†å…¶ä»–è¯­è¨€çš„çº¦å®šï¼Œè¿™ä¹Ÿé€‚ç”¨ã€‚</p><p>â€‹ <strong>å¸¸é‡åç§°ä¸åº”æ˜¯å…¶å€¼çš„æ´¾ç”Ÿè¯ï¼Œè€Œåº”è§£é‡Šå€¼çš„å«ä¹‰ã€‚</strong></p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>const</span> MaxPacketSize = <span style=color:#a5d6ff>512</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>const</span> (
</span></span><span style=display:flex><span>    ExecuteBit = <span style=color:#a5d6ff>1</span> <span style=color:#ff7b72;font-weight:700>&lt;&lt;</span> <span style=color:#79c0ff>iota</span>
</span></span><span style=display:flex><span>    WriteBit
</span></span><span style=display:flex><span>    ReadBit
</span></span><span style=display:flex><span>)
</span></span></code></pre></td></tr></table></div></div><p>ä¸è¦ä½¿ç”¨é MixedCaps å¸¸é‡åç§°æˆ–å¸¦æœ‰<code>K</code>å‰ç¼€çš„å¸¸é‡ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Bad:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>const</span> MAX_PACKET_SIZE = <span style=color:#a5d6ff>512</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>const</span> kMaxBufferSize = <span style=color:#a5d6ff>1024</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>const</span> KMaxUsersPergroup = <span style=color:#a5d6ff>500</span>
</span></span></code></pre></td></tr></table></div></div><p>æ ¹æ®å®ƒä»¬çš„è§’è‰²è€Œä¸æ˜¯å®ƒä»¬çš„å€¼æ¥å‘½åå¸¸é‡ã€‚å¦‚æœä¸€ä¸ªå¸¸é‡é™¤äº†å®ƒçš„å€¼ä¹‹å¤–æ²¡æœ‰å…¶ä»–ä½œç”¨ï¼Œé‚£ä¹ˆå°±æ²¡æœ‰å¿…è¦å°†å®ƒå®šä¹‰ä¸ºä¸€ä¸ªå¸¸é‡ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Bad:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>const</span> Twelve = <span style=color:#a5d6ff>12</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>const</span> (
</span></span><span style=display:flex><span>    UserNameColumn = <span style=color:#a5d6ff>&#34;username&#34;</span>
</span></span><span style=display:flex><span>    GroupColumn    = <span style=color:#a5d6ff>&#34;group&#34;</span>
</span></span><span style=display:flex><span>)
</span></span></code></pre></td></tr></table></div></div><h3 id=ç¼©å†™è¯>ç¼©å†™è¯<a hidden class=anchor aria-hidden=true href=#ç¼©å†™è¯>#</a></h3><p>â€‹ åç§°ä¸­çš„é¦–å­—æ¯ç¼©ç•¥è¯æˆ–é¦–å­—æ¯ç¼©ç•¥è¯ï¼ˆä¾‹å¦‚ï¼Œ<code>URL</code>å’Œ<code>NATO</code>ï¼‰åº”è¯¥å…·æœ‰ç›¸åŒçš„å¤§å°å†™ã€‚<code>URL</code>åº”æ˜¾ç¤ºä¸º<code>URL</code>æˆ–<code>url</code>ï¼ˆå¦‚<code>urlPony</code>, æˆ– <code>URLPony</code>ï¼‰ï¼Œç»ä¸èƒ½æ˜¾ç¤ºä¸º<code>Url</code>. è¿™ä¹Ÿé€‚ç”¨äº<code>ID</code>â€œæ ‡è¯†ç¬¦â€çš„ç¼©å†™ï¼›å†™<code>appID</code>è€Œä¸æ˜¯<code>appId</code>ã€‚</p><ul><li>åœ¨å…·æœ‰å¤šä¸ªé¦–å­—æ¯ç¼©å†™è¯çš„åç§°ä¸­ï¼ˆä¾‹å¦‚<code>XMLAPI</code>ï¼Œå› ä¸ºå®ƒåŒ…å«<code>XML</code> and <code>API</code>ï¼‰ï¼Œç»™å®šé¦–å­—æ¯ç¼©å†™è¯ä¸­çš„æ¯ä¸ªå­—æ¯éƒ½åº”è¯¥å…·æœ‰ç›¸åŒçš„å¤§å°å†™ï¼Œä½†åç§°ä¸­çš„æ¯ä¸ªé¦–å­—æ¯ç¼©å†™è¯ä¸éœ€è¦å…·æœ‰ç›¸åŒçš„å¤§å°å†™ã€‚</li><li>åœ¨é¦–å­—æ¯ç¼©å†™åŒ…å«å°å†™å­—æ¯ï¼ˆä¾‹å¦‚<code>DDoS</code>, <code>iOS</code>, <code>gRPC</code>ï¼‰çš„åç§°ä¸­ï¼Œé¦–å­—æ¯ç¼©å†™åº”è¯¥åƒåœ¨æ ‡å‡†æ•£æ–‡ä¸­ä¸€æ ·å‡ºç°ï¼Œé™¤éæ‚¨éœ€è¦ä¸ºäº†<a href=https://golang.org/ref/spec#Exported_identifiers>å¯¼å‡º</a>æ€§è€Œæ›´æ”¹ç¬¬ä¸€ä¸ªå­—æ¯ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œæ•´ä¸ªé¦–å­—æ¯å¤§å†™åº”è¯¥æ˜¯ç›¸åŒçš„æƒ…å†µï¼ˆä¾‹å¦‚<code>ddos</code>, <code>IOS</code>, <code>GRPC</code>ï¼‰ã€‚</li></ul><table><thead><tr><th>åˆå§‹ä¸»ä¹‰</th><th>èŒƒå›´</th><th>æ­£ç¡®çš„</th><th>ä¸æ­£ç¡®</th></tr></thead><tbody><tr><td>XML API</td><td>å·²å‡ºå£</td><td><code>XMLAPI</code></td><td><code>XmlApi</code>, <code>XMLApi</code>, <code>XmlAPI</code>,<code>XMLapi</code></td></tr><tr><td>XML API</td><td>æœªå‡ºå£</td><td><code>xmlAPI</code></td><td><code>xmlapi</code>,<code>xmlApi</code></td></tr><tr><td>iOS</td><td>å·²å‡ºå£</td><td><code>IOS</code></td><td><code>Ios</code>,<code>IoS</code></td></tr><tr><td>iOS</td><td>æœªå‡ºå£</td><td><code>iOS</code></td><td><code>ios</code></td></tr><tr><td>gRPC</td><td>å·²å‡ºå£</td><td><code>GRPC</code></td><td><code>Grpc</code></td></tr><tr><td>gRPC</td><td>æœªå‡ºå£</td><td><code>gRPC</code></td><td><code>grpc</code></td></tr><tr><td>åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡</td><td>å·²å‡ºå£</td><td><code>DDoS</code></td><td><code>DDOS</code>,<code>Ddos</code></td></tr><tr><td>åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡</td><td>æœªå‡ºå£</td><td><code>ddos</code></td><td><code>dDoS</code>,<code>dDOS</code></td></tr></tbody></table><h3 id=å‡½æ•°åç§°>å‡½æ•°åç§°<a hidden class=anchor aria-hidden=true href=#å‡½æ•°åç§°>#</a></h3><p>â€‹ å‡½æ•°å’Œæ–¹æ³•åç§°ä¸åº”ä½¿ç”¨<code>Get</code>æˆ–<code>get</code>å‰ç¼€ï¼Œé™¤éåº•å±‚æ¦‚å¿µä½¿ç”¨å•è¯â€œgetâ€ï¼ˆä¾‹å¦‚ HTTP GETï¼‰ã€‚æ›´å–œæ¬¢ç›´æ¥ä»¥åè¯å¼€å¤´çš„åç§°ï¼Œä¾‹å¦‚ä½¿ç”¨<code>Counts</code>over <code>GetCounts</code>ã€‚</p><p>å¦‚æœè¯¥å‡½æ•°æ¶‰åŠæ‰§è¡Œå¤æ‚çš„è®¡ç®—æˆ–æ‰§è¡Œè¿œç¨‹è°ƒç”¨ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ä¸åŒçš„è¯ï¼ˆå¦‚<code>Compute</code>æˆ–ï¼‰ä»£æ›¿ï¼Œä»¥å‘è¯»è€…æ¸…æ¥šåœ°è¡¨æ˜å‡½æ•°è°ƒç”¨å¯èƒ½éœ€è¦æ—¶é—´å¹¶ä¸”å¯èƒ½ä¼šé˜»å¡æˆ–å¤±è´¥ã€‚<code>Fetch Get</code></p><h3 id=å˜é‡å>å˜é‡å<a hidden class=anchor aria-hidden=true href=#å˜é‡å>#</a></h3><p>ä¸€èˆ¬çš„ç»éªŒæ³•åˆ™æ˜¯ï¼Œåç§°çš„é•¿åº¦åº”ä¸å…¶èŒƒå›´çš„å¤§å°æˆæ­£æ¯”ï¼Œå¹¶ä¸å…¶åœ¨è¯¥èŒƒå›´å†…ä½¿ç”¨çš„æ¬¡æ•°æˆåæ¯”ã€‚åœ¨æ–‡ä»¶èŒƒå›´å†…åˆ›å»ºçš„å˜é‡å¯èƒ½éœ€è¦å¤šä¸ªå•è¯ï¼Œè€Œä½œç”¨åŸŸä¸ºå•ä¸ªå†…éƒ¨å—çš„å˜é‡å¯èƒ½æ˜¯å•ä¸ªå•è¯ç”šè‡³åªæ˜¯ä¸€ä¸¤ä¸ªå­—ç¬¦ï¼Œä»¥ä¿æŒä»£ç æ¸…æ™°å¹¶é¿å…æ— å…³ä¿¡æ¯ã€‚</p><p>è¿™æ˜¯ä¸€ä¸ªç²—ç•¥çš„åŸºçº¿ã€‚è¿™äº›æ•°å­—å‡†åˆ™ä¸æ˜¯ä¸¥æ ¼çš„è§„åˆ™ã€‚æ ¹æ®ä¸Šä¸‹æ–‡ã€<a href=https://google.github.io/styleguide/go/guide#clarity>æ¸…æ™°åº¦</a>å’Œ<a href=https://google.github.io/styleguide/go/guide#concision>ç®€æ´</a>æ€§åº”ç”¨åˆ¤æ–­ã€‚</p><ul><li>å°èŒƒå›´æ˜¯æ‰§è¡Œä¸€ä¸¤ä¸ªå°æ“ä½œçš„èŒƒå›´ï¼Œæ¯”å¦‚ 1-7 è¡Œã€‚</li><li>ä¸­ç­‰èŒƒå›´æ˜¯ä¸€äº›å°çš„æˆ–ä¸€ä¸ªå¤§çš„æ“ä½œï¼Œæ¯”å¦‚ 8-15 è¡Œã€‚</li><li>å¤§èŒƒå›´æ˜¯ä¸€ä¸ªæˆ–å‡ ä¸ªå¤§æ“ä½œï¼Œæ¯”å¦‚ 15-25 è¡Œã€‚</li><li>éå¸¸å¤§çš„èŒƒå›´æ˜¯æŒ‡è¶…è¿‡ä¸€é¡µï¼ˆä¾‹å¦‚ï¼Œè¶…è¿‡ 25 è¡Œï¼‰çš„ä»»ä½•å†…å®¹ã€‚</li></ul><p>åœ¨å°èŒƒå›´å†…å¯èƒ½éå¸¸æ¸…æ¥šçš„åç§°ï¼ˆä¾‹å¦‚ï¼Œ<code>c</code>å¯¹äºè®¡æ•°å™¨ï¼‰åœ¨è¾ƒå¤§èŒƒå›´å†…å¯èƒ½æ˜¯ä¸å¤Ÿçš„ï¼Œå¹¶ä¸”éœ€è¦æ¾„æ¸…ä»¥æé†’è¯»è€…å…¶åœ¨ä»£ç ä¸­çš„ç›®çš„ã€‚ä¸€ä¸ªä½œç”¨åŸŸä¸­æœ‰å¾ˆå¤šå˜é‡ï¼Œæˆ–è€…è¡¨ç¤ºç›¸ä¼¼å€¼æˆ–æ¦‚å¿µçš„å˜é‡ï¼Œå¯èƒ½éœ€è¦æ¯”ä½œç”¨åŸŸå»ºè®®çš„æ›´é•¿çš„å˜é‡åç§°ã€‚</p><p>æ¦‚å¿µçš„ç‰¹æ®Šæ€§ä¹Ÿæœ‰åŠ©äºä¿æŒå˜é‡åç§°çš„ç®€æ´ã€‚ä¾‹å¦‚ï¼Œå‡è®¾åªæœ‰ä¸€ä¸ªæ•°æ®åº“åœ¨ä½¿ç”¨ï¼Œåƒ<code>db</code>è¿™æ ·çš„çŸ­å˜é‡åé€šå¸¸å¯èƒ½ä¸ºéå¸¸å°çš„èŒƒå›´ä¿ç•™ï¼Œå³ä½¿èŒƒå›´éå¸¸å¤§ä¹Ÿå¯èƒ½ä¿æŒå®Œå…¨æ¸…æ™°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ ¹æ®èŒƒå›´çš„å¤§å°ï¼Œå•ä¸ªè¯ <code>database</code>å¯èƒ½æ˜¯å¯ä»¥æ¥å—çš„ï¼Œä½†ä¸æ˜¯å¿…éœ€çš„ï¼Œå› ä¸ºè¿™<code>db</code>æ˜¯ä¸€ä¸ªéå¸¸å¸¸è§çš„è¯ç¼©å†™ï¼Œå‡ ä¹æ²¡æœ‰å…¶ä»–è§£é‡Šã€‚</p><p>å±€éƒ¨å˜é‡çš„åç§°åº”è¯¥åæ˜ å®ƒåŒ…å«çš„å†…å®¹ä»¥åŠå®ƒåœ¨å½“å‰ä¸Šä¸‹æ–‡ä¸­çš„ä½¿ç”¨æ–¹å¼ï¼Œè€Œä¸æ˜¯å€¼çš„æ¥æºã€‚ä¾‹å¦‚ï¼Œé€šå¸¸æƒ…å†µä¸‹æœ€ä½³å±€éƒ¨å˜é‡åç§°ä¸ç»“æ„æˆ–åè®®ç¼“å†²åŒºå­—æ®µåç§°ä¸åŒã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼š</p><ul><li><p>åƒ<code>count</code>æˆ–è¿™æ ·çš„å•è¯åç§°<code>options</code>æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ã€‚</p></li><li><p>å¯ä»¥æ·»åŠ å…¶ä»–è¯æ¥æ¶ˆé™¤ç›¸ä¼¼åç§°çš„æ­§ä¹‰ï¼Œä¾‹å¦‚ <code>userCount</code>and <code>projectCount</code>ã€‚</p></li><li><p>ä¸è¦ä¸ºäº†èŠ‚çœæ‰“å­—è€Œç®€å•åœ°æ”¾ä¸‹å­—æ¯ã€‚ä¾‹å¦‚<code>Sandbox</code>æ¯” æ›´å—æ¬¢è¿<code>Sbx</code>ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå¯¼å‡ºçš„åç§°ã€‚</p></li><li><p>ä»å¤§å¤šæ•°å˜é‡åä¸­ çœç•¥</p><p>ç±»å‹å’Œç±»ä¼¼ç±»å‹çš„è¯ã€‚</p><ul><li>å¯¹äºæ•°å­—ï¼Œ<code>userCount</code>æ˜¯æ¯”<code>numUsers</code>or æ›´å¥½çš„åç§°<code>usersInt</code>ã€‚</li><li>å¯¹äºåˆ‡ç‰‡ï¼Œ<code>users</code>æ˜¯ä¸€ä¸ªæ¯”<code>userSlice</code>.</li><li>å¦‚æœèŒƒå›´å†…æœ‰ä¸¤ä¸ªç‰ˆæœ¬çš„å€¼ï¼Œåˆ™åŒ…å«ç±»ä¼¼ç±»å‹çš„é™å®šç¬¦æ˜¯å¯ä»¥æ¥å—çš„ï¼Œä¾‹å¦‚ï¼Œæ‚¨å¯èƒ½å°†è¾“å…¥å­˜å‚¨åœ¨è§£æå€¼ä¸­<code>ageString</code>å¹¶<code>age</code>ç”¨äºè§£æå€¼ã€‚</li></ul></li><li><p><a href=https://google.github.io/styleguide/go/decisions#repetitive-in-context>çœç•¥å‘¨å›´ä¸Šä¸‹æ–‡</a>æ¸…æ¥šçš„è¯ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ª<code>UserCount</code>æ–¹æ³•çš„å®ç°ä¸­ï¼Œè°ƒç”¨çš„ä¸€ä¸ªå±€éƒ¨å˜é‡ <code>userCount</code>å¾ˆå¯èƒ½æ˜¯å¤šä½™çš„ï¼›<code>count</code>, <code>users</code>, ç”šè‡³<code>c</code>éƒ½ä¸€æ ·å¯è¯»ã€‚</p></li></ul><h4 id=å•å­—æ¯å˜é‡å>å•å­—æ¯å˜é‡å<a hidden class=anchor aria-hidden=true href=#å•å­—æ¯å˜é‡å>#</a></h4><p>å•å­—æ¯å˜é‡åå¯èƒ½æ˜¯å‡å°‘ <a href=https://google.github.io/styleguide/go/decisions#repetition>é‡å¤</a>çš„æœ‰ç”¨å·¥å…·ï¼Œä½†ä¹Ÿå¯èƒ½ä½¿ä»£ç ä¸å¿…è¦åœ°å˜å¾—ä¸é€æ˜ã€‚å°†å®ƒä»¬çš„ä½¿ç”¨é™åˆ¶åœ¨å®Œæ•´å•è¯å¾ˆæ˜æ˜¾ä»¥åŠå®ƒä¼šé‡å¤å‡ºç°ä»¥ä»£æ›¿å•å­—æ¯å˜é‡çš„æƒ…å†µã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼š</p><ul><li>å¯¹äº<a href=https://google.github.io/styleguide/go/decisions#receiver-names>æ–¹æ³•æ¥æ”¶è€…å˜é‡</a>ï¼Œé¦–é€‰ä¸€ä¸ªå­—æ¯æˆ–ä¸¤ä¸ªå­—æ¯çš„åç§°ã€‚</li><li>å¯¹å¸¸è§ç±»å‹ä½¿ç”¨ç†Ÿæ‚‰çš„å˜é‡åé€šå¸¸å¾ˆæœ‰å¸®åŠ©ï¼š<ul><li><code>r</code>å¯¹äºä¸€ä¸ª<code>io.Reader</code>æˆ–<code>*http.Request</code></li><li><code>w</code>å¯¹äºä¸€ä¸ª<code>io.Writer</code>æˆ–<code>http.ResponseWriter</code></li></ul></li><li>å•å­—æ¯æ ‡è¯†ç¬¦ä½œä¸ºæ•´æ•°å¾ªç¯å˜é‡æ˜¯å¯æ¥å—çš„ï¼Œç‰¹åˆ«æ˜¯å¯¹äºç´¢å¼•ï¼ˆä¾‹å¦‚ï¼Œ<code>i</code>ï¼‰å’Œåæ ‡ï¼ˆä¾‹å¦‚ï¼Œ<code>x</code>å’Œ<code>y</code>ï¼‰ã€‚</li><li>å½“èŒƒå›´å¾ˆçŸ­æ—¶ï¼Œç¼©å†™å¯ä»¥æ˜¯å¯æ¥å—çš„å¾ªç¯æ ‡è¯†ç¬¦ï¼Œä¾‹å¦‚<code>for _, n := range nodes { ... }</code>.</li></ul><h3 id=é‡å¤>é‡å¤<a hidden class=anchor aria-hidden=true href=#é‡å¤>#</a></h3><p>â€‹ ä¸€æ®µ Go æºä»£ç åº”è¯¥é¿å…ä¸å¿…è¦çš„é‡å¤ã€‚ä¸€ä¸ªå¸¸è§çš„æ¥æºæ˜¯é‡å¤åç§°ï¼Œå…¶ä¸­é€šå¸¸åŒ…å«ä¸å¿…è¦çš„å•è¯æˆ–é‡å¤å…¶ä¸Šä¸‹æ–‡æˆ–ç±»å‹ã€‚å¦‚æœç›¸åŒæˆ–ç›¸ä¼¼çš„ä»£ç æ®µåœ¨å¾ˆè¿‘çš„åœ°æ–¹å¤šæ¬¡å‡ºç°ï¼Œä»£ç æœ¬èº«ä¹Ÿå¯èƒ½æ˜¯ä¸å¿…è¦çš„é‡å¤ã€‚</p><p>é‡å¤å‘½åå¯ä»¥æœ‰å¤šç§å½¢å¼ï¼ŒåŒ…æ‹¬ï¼š</p><h4 id=åŒ…ä¸å¯¼å‡ºçš„ç¬¦å·åç§°>åŒ…ä¸å¯¼å‡ºçš„ç¬¦å·åç§°<a hidden class=anchor aria-hidden=true href=#åŒ…ä¸å¯¼å‡ºçš„ç¬¦å·åç§°>#</a></h4><p>â€‹ å‘½åå¯¼å‡ºçš„ç¬¦å·æ—¶ï¼ŒåŒ…çš„åç§°å§‹ç»ˆåœ¨åŒ…å¤–å¯è§ï¼Œå› æ­¤åº”å‡å°‘æˆ–æ¶ˆé™¤ä¸¤è€…ä¹‹é—´çš„å†—ä½™ä¿¡æ¯ã€‚å¦‚æœä¸€ä¸ªåŒ…ä»…å¯¼å‡ºä¸€ç§ç±»å‹å¹¶ä¸”å®ƒä»¥åŒ…æœ¬èº«å‘½åï¼Œåˆ™æ„é€ å‡½æ•°çš„è§„èŒƒåç§°æ˜¯<code>New</code>if one is requiredã€‚</p><blockquote><p>**ç¤ºä¾‹ï¼š**é‡å¤åç§° -> æ›´å¥½çš„åç§°</p><ul><li><code>widget.NewWidget</code>-><code>widget.New</code></li><li><code>widget.NewWidgetWithName</code>-><code>widget.NewWithName</code></li><li><code>db.LoadFromDatabase</code>-><code>db.Load</code></li><li><code>goatteleportutil.CountGoatsTeleported</code>-><code>gtutil.CountGoatsTeleported</code> æˆ–<code>goatteleport.Count</code></li><li><code>myteampb.MyTeamMethodRequest</code>-><code>mtpb.MyTeamMethodRequest</code>æˆ– <code>myteampb.MethodRequest</code></li></ul></blockquote><h4 id=å˜é‡åä¸ç±»å‹>å˜é‡åä¸ç±»å‹<a hidden class=anchor aria-hidden=true href=#å˜é‡åä¸ç±»å‹>#</a></h4><p>â€‹ ç¼–è¯‘å™¨æ€»æ˜¯çŸ¥é“å˜é‡çš„ç±»å‹ï¼Œå¹¶ä¸”åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¯»è€…ä¹Ÿå¯ä»¥é€šè¿‡å˜é‡çš„ä½¿ç”¨æ–¹å¼æ¸…æ¥šåœ°çŸ¥é“å˜é‡æ˜¯ä»€ä¹ˆç±»å‹ã€‚å¦‚æœä¸€ä¸ªå˜é‡çš„å€¼åœ¨åŒä¸€èŒƒå›´å†…å‡ºç°ä¸¤æ¬¡ï¼Œåˆ™åªéœ€æ˜ç¡®å˜é‡çš„ç±»å‹ã€‚</p><table><thead><tr><th>é‡å¤åç§°</th><th>æ›´å¥½çš„åå­—</th></tr></thead><tbody><tr><td><code>var numUsers int</code></td><td><code>var users int</code></td></tr><tr><td><code>var nameString string</code></td><td><code>var name string</code></td></tr><tr><td><code>var primaryProject *Project</code></td><td><code>var primary *Project</code></td></tr></tbody></table><p>å¦‚æœè¯¥å€¼ä»¥å¤šç§å½¢å¼å‡ºç°ï¼Œåˆ™å¯ä»¥ä½¿ç”¨åƒ<code>raw</code>and<code>parsed</code>æˆ–åº•å±‚è¡¨ç¤ºè¿™æ ·çš„é¢å¤–è¯æ¥æ¾„æ¸…ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span>limitStr <span style=color:#ff7b72;font-weight:700>:=</span> r.<span style=color:#d2a8ff;font-weight:700>FormValue</span>(<span style=color:#a5d6ff>&#34;limit&#34;</span>)
</span></span><span style=display:flex><span>limit, err <span style=color:#ff7b72;font-weight:700>:=</span> strconv.<span style=color:#d2a8ff;font-weight:700>Atoi</span>(limitStr)
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span>limitRaw <span style=color:#ff7b72;font-weight:700>:=</span> r.<span style=color:#d2a8ff;font-weight:700>FormValue</span>(<span style=color:#a5d6ff>&#34;limit&#34;</span>)
</span></span><span style=display:flex><span>limit, err <span style=color:#ff7b72;font-weight:700>:=</span> strconv.<span style=color:#d2a8ff;font-weight:700>Atoi</span>(limitRaw)
</span></span></code></pre></td></tr></table></div></div><h4 id=å¤–éƒ¨ä¸Šä¸‹æ–‡ä¸æœ¬åœ°åç§°>å¤–éƒ¨ä¸Šä¸‹æ–‡ä¸æœ¬åœ°åç§°<a hidden class=anchor aria-hidden=true href=#å¤–éƒ¨ä¸Šä¸‹æ–‡ä¸æœ¬åœ°åç§°>#</a></h4><p>â€‹ åŒ…å«æ¥è‡ªå‘¨å›´ä¸Šä¸‹æ–‡ä¿¡æ¯çš„åç§°é€šå¸¸ä¼šäº§ç”Ÿé¢å¤–çš„å™ªéŸ³è€Œæ²¡æœ‰ä»»ä½•å¥½å¤„ã€‚åŒ…åã€æ–¹æ³•åã€ç±»å‹åã€å‡½æ•°åã€å¯¼å…¥è·¯å¾„ï¼Œç”šè‡³æ–‡ä»¶åéƒ½å¯ä»¥æä¾›è‡ªåŠ¨é™å®šå…¶ä¸­æ‰€æœ‰åç§°çš„ä¸Šä¸‹æ–‡ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Bad:</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// In package &#34;ads/targeting/revenue/reporting&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>type</span> AdsTargetingRevenueReport <span style=color:#ff7b72>struct</span>{}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> (p <span style=color:#ff7b72;font-weight:700>*</span>Project) <span style=color:#d2a8ff;font-weight:700>ProjectName</span>() <span style=color:#ff7b72>string</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// In package &#34;ads/targeting/revenue/reporting&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>type</span> Report <span style=color:#ff7b72>struct</span>{}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> (p <span style=color:#ff7b72;font-weight:700>*</span>Project) <span style=color:#d2a8ff;font-weight:700>Name</span>() <span style=color:#ff7b72>string</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Bad:</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// In package &#34;sqldb&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>type</span> DBConnection <span style=color:#ff7b72>struct</span>{}
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// In package &#34;sqldb&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>type</span> Connection <span style=color:#ff7b72>struct</span>{}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Bad:</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// In package &#34;ads/targeting&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> <span style=color:#d2a8ff;font-weight:700>Process</span>(in <span style=color:#ff7b72;font-weight:700>*</span>pb.FooProto) <span style=color:#ff7b72;font-weight:700>*</span>Report {
</span></span><span style=display:flex><span>    adsTargetingID <span style=color:#ff7b72;font-weight:700>:=</span> in.<span style=color:#d2a8ff;font-weight:700>GetAdsTargetingID</span>()
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// In package &#34;ads/targeting&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> <span style=color:#d2a8ff;font-weight:700>Process</span>(in <span style=color:#ff7b72;font-weight:700>*</span>pb.FooProto) <span style=color:#ff7b72;font-weight:700>*</span>Report {
</span></span><span style=display:flex><span>    id <span style=color:#ff7b72;font-weight:700>:=</span> in.<span style=color:#d2a8ff;font-weight:700>GetAdsTargetingID</span>()
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>â€‹ é‡å¤é€šå¸¸åº”è¯¥åœ¨ç¬¦å·ç”¨æˆ·çš„ä¸Šä¸‹æ–‡ä¸­è¿›è¡Œè¯„ä¼°ï¼Œè€Œä¸æ˜¯å­¤ç«‹åœ°è¿›è¡Œè¯„ä¼°ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢çš„ä»£ç æœ‰å¾ˆå¤šåç§°ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½æ²¡é—®é¢˜ï¼Œä½†åœ¨ä¸Šä¸‹æ–‡ä¸­æ˜¯å¤šä½™çš„ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">9
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Bad:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> (db <span style=color:#ff7b72;font-weight:700>*</span>DB) <span style=color:#d2a8ff;font-weight:700>UserCount</span>() (userCount <span style=color:#ff7b72>int</span>, err <span style=color:#ff7b72>error</span>) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>var</span> userCountInt64 <span style=color:#ff7b72>int64</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> dbLoadError <span style=color:#ff7b72;font-weight:700>:=</span> db.<span style=color:#d2a8ff;font-weight:700>LoadFromDatabase</span>(<span style=color:#a5d6ff>&#34;count(distinct users)&#34;</span>, <span style=color:#ff7b72;font-weight:700>&amp;</span>userCountInt64); dbLoadError <span style=color:#ff7b72;font-weight:700>!=</span> <span style=color:#79c0ff>nil</span> {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>0</span>, fmt.<span style=color:#d2a8ff;font-weight:700>Errorf</span>(<span style=color:#a5d6ff>&#34;failed to load user count: %s&#34;</span>, dbLoadError)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    userCount = int(userCountInt64)
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> userCount, <span style=color:#79c0ff>nil</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>ç›¸åï¼Œé€šå¸¸å¯ä»¥çœç•¥æœ‰å…³ä»ä¸Šä¸‹æ–‡æˆ–ç”¨æ³•ä¸­æ¸…æ¥šçš„åç§°çš„ä¿¡æ¯ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> (db <span style=color:#ff7b72;font-weight:700>*</span>DB) <span style=color:#d2a8ff;font-weight:700>UserCount</span>() (<span style=color:#ff7b72>int</span>, <span style=color:#ff7b72>error</span>) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>var</span> count <span style=color:#ff7b72>int64</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> err <span style=color:#ff7b72;font-weight:700>:=</span> db.<span style=color:#d2a8ff;font-weight:700>Load</span>(<span style=color:#a5d6ff>&#34;count(distinct users)&#34;</span>, <span style=color:#ff7b72;font-weight:700>&amp;</span>count); err <span style=color:#ff7b72;font-weight:700>!=</span> <span style=color:#79c0ff>nil</span> {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>0</span>, fmt.<span style=color:#d2a8ff;font-weight:700>Errorf</span>(<span style=color:#a5d6ff>&#34;failed to load user count: %s&#34;</span>, err)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> int(count), <span style=color:#79c0ff>nil</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h2 id=imports>imports<a hidden class=anchor aria-hidden=true href=#imports>#</a></h2><h3 id=å¯¼å…¥é‡å‘½å>å¯¼å…¥é‡å‘½å<a hidden class=anchor aria-hidden=true href=#å¯¼å…¥é‡å‘½å>#</a></h3><p>â€‹ <em>åªåº”é‡å‘½åå¯¼å…¥ä»¥é¿å…ä¸å…¶ä»–å¯¼å…¥çš„åç§°å†²çª</em>ã€‚ï¼ˆç”±æ­¤æ¨è®ºï¼Œ<a href=https://google.github.io/styleguide/go/decisions#package-names>å¥½çš„åŒ…å</a>ä¸åº”è¯¥éœ€è¦é‡å‘½åã€‚ï¼‰åœ¨åç§°å†²çªçš„æƒ…å†µä¸‹ï¼Œæ›´æ„¿æ„é‡å‘½åæœ€æœ¬åœ°æˆ–ç‰¹å®šäºé¡¹ç›®çš„å¯¼å…¥ã€‚åŒ…çš„æœ¬åœ°åç§°ï¼ˆåˆ«åï¼‰å¿…é¡»éµå¾ª <a href=https://google.github.io/styleguide/go/decisions#package-names>åŒ…å‘½åæŒ‡å—</a>ï¼ŒåŒ…æ‹¬ç¦æ­¢ä½¿ç”¨ä¸‹åˆ’çº¿å’Œå¤§å†™å­—æ¯ã€‚</p><p>â€‹ ç”Ÿæˆçš„ protocol buffer åŒ…å¿…é¡»é‡å‘½åä»¥ä»åç§°ä¸­åˆ é™¤ä¸‹åˆ’çº¿ï¼Œå¹¶ä¸”å®ƒä»¬çš„åˆ«åå¿…é¡»æœ‰<code>pb</code>åç¼€ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… <a href=https://google.github.io/styleguide/go/best-practices#import-protos>åŸå‹å’Œå­˜æ ¹æœ€ä½³å®è·µ</a>ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>// Good:
</span></span><span style=display:flex><span>import (
</span></span><span style=display:flex><span>    fspb &#34;path/to/package/foo_service_go_proto&#34;
</span></span><span style=display:flex><span>)
</span></span></code></pre></td></tr></table></div></div><p>å¯¼å…¥çš„åŒ…åç§°æ²¡æœ‰æœ‰ç”¨çš„è¯†åˆ«ä¿¡æ¯ï¼ˆä¾‹å¦‚ <code>package v1</code>ï¼‰åº”è¯¥é‡å‘½åä»¥åŒ…æ‹¬ä»¥å‰çš„è·¯å¾„ç»„ä»¶ã€‚é‡å‘½åå¿…é¡»ä¸å¯¼å…¥ç›¸åŒåŒ…çš„å…¶ä»–æœ¬åœ°æ–‡ä»¶ä¸€è‡´ï¼Œå¹¶ä¸”å¯ä»¥åŒ…æ‹¬ç‰ˆæœ¬å·ã€‚</p><p>**æ³¨æ„ï¼š**æœ€å¥½é‡å‘½ååŒ…ä»¥ç¬¦åˆ <a href=https://google.github.io/styleguide/go/decisions#package-names>è‰¯å¥½çš„åŒ…åç§°</a>ï¼Œä½†è¿™å¯¹äº vendored ç›®å½•ä¸­çš„åŒ…é€šå¸¸ä¸å¯è¡Œã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>// Good:
</span></span><span style=display:flex><span>import (
</span></span><span style=display:flex><span>    core &#34;github.com/kubernetes/api/core/v1&#34;
</span></span><span style=display:flex><span>    meta &#34;github.com/kubernetes/apimachinery/pkg/apis/meta/v1beta1&#34;
</span></span><span style=display:flex><span>)
</span></span></code></pre></td></tr></table></div></div><p>â€‹ å¦‚æœæ‚¨éœ€è¦å¯¼å…¥ä¸€ä¸ªåç§°ä¸æ‚¨è¦ä½¿ç”¨çš„å…¬å…±å±€éƒ¨å˜é‡åç§°ï¼ˆä¾‹å¦‚<code>url</code>, <code>ssh</code>ï¼‰å†²çªçš„åŒ…ï¼Œå¹¶ä¸”æ‚¨å¸Œæœ›é‡å‘½åè¯¥åŒ…ï¼Œé¦–é€‰æ–¹æ³•æ˜¯ä½¿ç”¨<code>pkg</code>åç¼€ï¼ˆä¾‹å¦‚<code>urlpkg</code>ï¼‰ã€‚è¯·æ³¨æ„ï¼Œå¯ä»¥ä½¿ç”¨å±€éƒ¨å˜é‡éšè—åŒ…ï¼›ä»…å½“æ­¤ç±»å˜é‡åœ¨èŒƒå›´å†…æ—¶ä»éœ€è¦ä½¿ç”¨åŒ…æ—¶ï¼Œæ‰éœ€è¦é‡å‘½åã€‚</p><h3 id=å¯¼å…¥åˆ†ç»„>å¯¼å…¥åˆ†ç»„<a hidden class=anchor aria-hidden=true href=#å¯¼å…¥åˆ†ç»„>#</a></h3><p>å¯¼å…¥åº”åˆ†ä¸ºä¸¤ç»„ï¼š</p><ul><li>æ ‡å‡†åº“åŒ…</li><li>å…¶ä»–ï¼ˆé¡¹ç›®å’Œé”€å”®ï¼‰åŒ…</li></ul><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>package</span> main
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>import</span> (
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;hash/adler32&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;os&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;github.com/dsnet/compress/flate&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;golang.org/x/text/encoding&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;google.golang.org/protobuf/proto&#34;</span>
</span></span><span style=display:flex><span>    foopb <span style=color:#a5d6ff>&#34;myproj/foo/proto/proto&#34;</span>
</span></span><span style=display:flex><span>    _ <span style=color:#a5d6ff>&#34;myproj/rpc/protocols/dial&#34;</span>
</span></span><span style=display:flex><span>    _ <span style=color:#a5d6ff>&#34;myproj/security/auth/authhooks&#34;</span>
</span></span><span style=display:flex><span>)
</span></span></code></pre></td></tr></table></div></div><p>â€‹ å°†é¡¹ç›®åŒ…åˆ†æˆå¤šä¸ªç»„æ˜¯å¯ä»¥æ¥å—çš„ï¼Œä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æƒ³è¦ä¸€ä¸ªå•ç‹¬çš„ç»„æ¥é‡å‘½åã€import-only-for-side-effects æˆ–å¦ä¸€ä¸ªç‰¹æ®Šçš„å¯¼å…¥ç»„ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>package</span> main
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>import</span> (
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;hash/adler32&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;os&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;github.com/dsnet/compress/flate&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;golang.org/x/text/encoding&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;google.golang.org/protobuf/proto&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    foopb <span style=color:#a5d6ff>&#34;myproj/foo/proto/proto&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    _ <span style=color:#a5d6ff>&#34;myproj/rpc/protocols/dial&#34;</span>
</span></span><span style=display:flex><span>    _ <span style=color:#a5d6ff>&#34;myproj/security/auth/authhooks&#34;</span>
</span></span><span style=display:flex><span>)
</span></span></code></pre></td></tr></table></div></div><p>â€‹ <strong>æ³¨æ„ï¼š</strong><a href=https://google.github.io/styleguide/go/golang.org/x/tools/cmd/goimports>goimports</a>å·¥å…·ä¸æ”¯æŒç»´æŠ¤å¯é€‰ç»„ - è¶…å‡ºæ ‡å‡†åº“å’Œ Google å¯¼å…¥ä¹‹é—´å¼ºåˆ¶åˆ†ç¦»æ‰€éœ€çš„æ‹†åˆ†ã€‚é¢å¤–çš„å¯¼å…¥å­ç»„éœ€è¦ä½œè€…å’Œå®¡ç¨¿äººçš„æ³¨æ„ï¼Œä»¥ä¿æŒç¬¦åˆçŠ¶æ€ã€‚</p><p>â€‹ ä¹Ÿæ˜¯ AppEngine åº”ç”¨ç¨‹åºçš„ Google ç¨‹åºåº”è¯¥æœ‰ä¸€ä¸ªå•ç‹¬çš„ç»„ç”¨äº AppEngine å¯¼å…¥ã€‚</p><h3 id=å¯¼å…¥ç©ºç™½--import-_>å¯¼å…¥â€œç©ºç™½â€ ( <code>import _</code>)<a hidden class=anchor aria-hidden=true href=#å¯¼å…¥ç©ºç™½--import-_>#</a></h3><p>ä»…ä¸ºäº†å‰¯ä½œç”¨<code>import _ "package"</code>è€Œå¯¼å…¥çš„åŒ…ï¼ˆä½¿ç”¨è¯­æ³• ï¼‰åªèƒ½åœ¨ä¸»åŒ…æˆ–éœ€è¦å®ƒä»¬çš„æµ‹è¯•ä¸­å¯¼å…¥ã€‚</p><p>æ­¤ç±»è½¯ä»¶åŒ…çš„ä¸€äº›ç¤ºä¾‹åŒ…æ‹¬ï¼š</p><ul><li><a href=https://pkg.go.dev/time/tzdata>æ—¶é—´/tzdata</a></li><li>å›¾åƒå¤„ç†ä»£ç ä¸­çš„<a href=https://pkg.go.dev/image/jpeg>image/jpeg</a></li></ul><p>é¿å…åœ¨åº“åŒ…ä¸­å¯¼å…¥ç©ºç™½ï¼Œå³ä½¿åº“é—´æ¥ä¾èµ–äºå®ƒä»¬ã€‚å°†å‰¯ä½œç”¨å¯¼å…¥é™åˆ¶åˆ°ä¸»åŒ…æœ‰åŠ©äºæ§åˆ¶ä¾èµ–æ€§ï¼Œå¹¶ä½¿å¾—ç¼–å†™ä¾èµ–äºä¸åŒå¯¼å…¥çš„æµ‹è¯•æˆä¸ºå¯èƒ½ï¼Œè€Œä¸ä¼šå‘ç”Ÿå†²çªæˆ–æµªè´¹æ„å»ºæˆæœ¬ã€‚</p><p>ä»¥ä¸‹æ˜¯æ­¤è§„åˆ™çš„å”¯ä¸€ä¾‹å¤–æƒ…å†µï¼š</p><ul><li>æ‚¨å¯ä»¥ä½¿ç”¨ç©ºç™½å¯¼å…¥ç»•è¿‡ <a href=https://github.com/bazelbuild/rules_go/blob/master/go/nogo.rst>nogo é™æ€æ£€æŸ¥å™¨ä¸­å¯¹ä¸å…è®¸å¯¼å…¥çš„æ£€æŸ¥</a>ã€‚</li><li>æ‚¨å¯ä»¥åœ¨ä½¿ç”¨ç¼–è¯‘å™¨æŒ‡ä»¤çš„æºæ–‡ä»¶ä¸­ä½¿ç”¨<a href=https://pkg.go.dev/embed>åµŒå…¥</a>åŒ…çš„ç©ºç™½å¯¼å…¥ã€‚<code>//go:embed</code></li></ul><p>**æç¤ºï¼š**å¦‚æœæ‚¨åˆ›å»ºçš„åº“åŒ…é—´æ¥ä¾èµ–äºç”Ÿäº§ä¸­çš„å‰¯ä½œç”¨å¯¼å…¥ï¼Œè¯·è®°å½•é¢„æœŸç”¨é€”ã€‚</p><h3 id=å¯¼å…¥ç‚¹-import->å¯¼å…¥â€œç‚¹â€( <code>import .</code>)<a hidden class=anchor aria-hidden=true href=#å¯¼å…¥ç‚¹-import->#</a></h3><p>â€‹ <code>import .</code>è¡¨å•æ˜¯ä¸€ç§è¯­è¨€åŠŸèƒ½ï¼Œå…è®¸å°†ä»å¦ä¸€ä¸ªåŒ…å¯¼å‡ºçš„æ ‡è¯†ç¬¦æ— æ¡ä»¶åœ°å¸¦åˆ°å½“å‰åŒ…ä¸­ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…<a href=https://go.dev/ref/spec#Import_declarations>è¯­è¨€è§„èŒƒ</a>ã€‚</p><p>ä¸è¦åœ¨ Google ä»£ç åº“<strong>ä¸­</strong>ä½¿ç”¨æ­¤åŠŸèƒ½ï¼›è¿™ä½¿å¾—æ›´éš¾åˆ¤æ–­åŠŸèƒ½æ¥è‡ªä½•å¤„ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Bad:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>package</span> foo_test
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>import</span> (
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;bar/testutil&#34;</span> <span style=color:#8b949e;font-style:italic>// also imports &#34;foo&#34;</span>
</span></span><span style=display:flex><span>    . <span style=color:#a5d6ff>&#34;foo&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>var</span> myThing = <span style=color:#d2a8ff;font-weight:700>Bar</span>() <span style=color:#8b949e;font-style:italic>// Bar defined in package foo; no qualification needed.</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>package</span> foo_test
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>import</span> (
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;bar/testutil&#34;</span> <span style=color:#8b949e;font-style:italic>// also imports &#34;foo&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;foo&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>var</span> myThing = foo.<span style=color:#d2a8ff;font-weight:700>Bar</span>()
</span></span></code></pre></td></tr></table></div></div><h2 id=é”™è¯¯>é”™è¯¯<a hidden class=anchor aria-hidden=true href=#é”™è¯¯>#</a></h2><h3 id=è¿”å›é”™è¯¯>è¿”å›é”™è¯¯<a hidden class=anchor aria-hidden=true href=#è¿”å›é”™è¯¯>#</a></h3><p>â€‹ ç”¨äº<code>error</code>è¡¨ç¤ºå‡½æ•°å¯èƒ½ä¼šå¤±è´¥ã€‚æŒ‰ç…§æƒ¯ä¾‹ï¼Œ<code>error</code>æ˜¯æœ€åä¸€ä¸ªç»“æœå‚æ•°ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> <span style=color:#d2a8ff;font-weight:700>Good</span>() <span style=color:#ff7b72>error</span> { <span style=color:#8b949e;font-style:italic>/* ... */</span> }
</span></span></code></pre></td></tr></table></div></div><p>â€‹ è¿”å›<code>nil</code>é”™è¯¯æ˜¯è¡¨ç¤ºæ“ä½œæˆåŠŸçš„æƒ¯ç”¨æ–¹å¼ï¼Œå¦åˆ™å¯èƒ½ä¼šå¤±è´¥ã€‚å¦‚æœå‡½æ•°è¿”å›é”™è¯¯ï¼Œé™¤éå¦æœ‰æ˜ç¡®è¯´æ˜ï¼Œå¦åˆ™è°ƒç”¨è€…å¿…é¡»å°†æ‰€æœ‰éé”™è¯¯è¿”å›å€¼è§†ä¸ºæœªæŒ‡å®šã€‚é€šå¸¸ï¼Œéé”™è¯¯è¿”å›å€¼æ˜¯å®ƒä»¬çš„é›¶å€¼ï¼Œä½†è¿™ä¸èƒ½å‡è®¾ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> <span style=color:#d2a8ff;font-weight:700>GoodLookup</span>() (<span style=color:#ff7b72;font-weight:700>*</span>Result, <span style=color:#ff7b72>error</span>) {
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// ...</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> err <span style=color:#ff7b72;font-weight:700>!=</span> <span style=color:#79c0ff>nil</span> {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> <span style=color:#79c0ff>nil</span>, err
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> res, <span style=color:#79c0ff>nil</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>â€‹ è¿”å›é”™è¯¯çš„å¯¼å‡ºå‡½æ•°åº”è¯¥ä½¿ç”¨<code>error</code>ç±»å‹è¿”å›å®ƒä»¬ã€‚å…·ä½“çš„é”™è¯¯ç±»å‹å®¹æ˜“å—åˆ°ç»†å¾®é”™è¯¯çš„å½±å“ï¼šå…·ä½“çš„<code>nil</code>æŒ‡é’ˆå¯ä»¥åŒ…è£…åˆ°æ¥å£ä¸­ï¼Œä»è€Œå˜æˆéé›¶å€¼ï¼ˆè¯·å‚é˜… <a href=https://golang.org/doc/faq#nil_error>ä¸»é¢˜ä¸Šçš„ Go FAQ æ¡ç›®</a>ï¼‰ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Bad:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> <span style=color:#d2a8ff;font-weight:700>Bad</span>() <span style=color:#ff7b72;font-weight:700>*</span>os.PathError { <span style=color:#8b949e;font-style:italic>/*...*/</span> }
</span></span></code></pre></td></tr></table></div></div><p>â€‹ <strong>æç¤º</strong>ï¼šå¸¦æœ‰<code>context.Context</code>å‚æ•°çš„å‡½æ•°é€šå¸¸åº”è¿”å›ä¸€ä¸ª<code>error</code>ï¼Œä»¥ä¾¿è°ƒç”¨è€…å¯ä»¥ç¡®å®šåœ¨å‡½æ•°è¿è¡Œæ—¶ä¸Šä¸‹æ–‡æ˜¯å¦è¢«å–æ¶ˆã€‚</p><h3 id=é”™è¯¯å­—ç¬¦ä¸²>é”™è¯¯å­—ç¬¦ä¸²<a hidden class=anchor aria-hidden=true href=#é”™è¯¯å­—ç¬¦ä¸²>#</a></h3><p>â€‹ é”™è¯¯å­—ç¬¦ä¸²ä¸åº”å¤§å†™ï¼ˆé™¤éä»¥å¯¼å‡ºåç§°ã€ä¸“æœ‰åè¯æˆ–é¦–å­—æ¯ç¼©å†™è¯å¼€å¤´ï¼‰å¹¶ä¸”ä¸åº”ä»¥æ ‡ç‚¹ç¬¦å·ç»“å°¾ã€‚è¿™æ˜¯å› ä¸ºé”™è¯¯å­—ç¬¦ä¸²é€šå¸¸åœ¨æ‰“å°ç»™ç”¨æˆ·ä¹‹å‰å‡ºç°åœ¨å…¶ä»–ä¸Šä¸‹æ–‡ä¸­ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Bad:</span>
</span></span><span style=display:flex><span>err <span style=color:#ff7b72;font-weight:700>:=</span> fmt.<span style=color:#d2a8ff;font-weight:700>Errorf</span>(<span style=color:#a5d6ff>&#34;Something bad happened.&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span>err <span style=color:#ff7b72;font-weight:700>:=</span> fmt.<span style=color:#d2a8ff;font-weight:700>Errorf</span>(<span style=color:#a5d6ff>&#34;something bad happened&#34;</span>)
</span></span></code></pre></td></tr></table></div></div><p>â€‹ å¦ä¸€æ–¹é¢ï¼Œå®Œæ•´æ˜¾ç¤ºæ¶ˆæ¯ï¼ˆæ—¥å¿—è®°å½•ã€æµ‹è¯•å¤±è´¥ã€API å“åº”æˆ–å…¶ä»– UIï¼‰çš„æ ·å¼å–å†³äºï¼Œä½†é€šå¸¸åº”å¤§å†™ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span>log.<span style=color:#d2a8ff;font-weight:700>Infof</span>(<span style=color:#a5d6ff>&#34;Operation aborted: %v&#34;</span>, err)
</span></span><span style=display:flex><span>log.<span style=color:#d2a8ff;font-weight:700>Errorf</span>(<span style=color:#a5d6ff>&#34;Operation aborted: %v&#34;</span>, err)
</span></span><span style=display:flex><span>t.<span style=color:#d2a8ff;font-weight:700>Errorf</span>(<span style=color:#a5d6ff>&#34;Op(%q) failed unexpectedly; err=%v&#34;</span>, args, err)
</span></span></code></pre></td></tr></table></div></div><h3 id=å¤„ç†é”™è¯¯>å¤„ç†é”™è¯¯<a hidden class=anchor aria-hidden=true href=#å¤„ç†é”™è¯¯>#</a></h3><p>â€‹ é‡åˆ°é”™è¯¯çš„ä»£ç åº”è¯¥æ…é‡é€‰æ‹©å¦‚ä½•å¤„ç†å®ƒã€‚<code>_</code>ä½¿ç”¨å˜é‡ä¸¢å¼ƒé”™è¯¯é€šå¸¸æ˜¯ä¸åˆé€‚çš„ã€‚å¦‚æœå‡½æ•°è¿”å›é”™è¯¯ï¼Œè¯·æ‰§è¡Œä»¥ä¸‹æ“ä½œä¹‹ä¸€ï¼š</p><ul><li>ç«‹å³å¤„ç†å¹¶è§£å†³é”™è¯¯ã€‚</li><li>å°†é”™è¯¯è¿”å›ç»™è°ƒç”¨è€…ã€‚</li><li>åœ¨ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œè¯·è‡´ç”µ<a href=https://pkg.go.dev/github.com/golang/glog#Fatal><code>log.Fatal</code></a>æˆ–ï¼ˆå¦‚æœç»å¯¹å¿…è¦ï¼‰ <code>panic</code>ã€‚</li></ul><p><strong>æ³¨æ„ï¼š</strong> <code>log.Fatalf</code>ä¸æ˜¯æ ‡å‡†åº“æ—¥å¿—ã€‚å‚è§ [#logging]ã€‚</p><p>â€‹ åœ¨æå°‘æ•°æƒ…å†µä¸‹ï¼Œå¿½ç•¥æˆ–ä¸¢å¼ƒé”™è¯¯æ˜¯åˆé€‚çš„ï¼ˆä¾‹å¦‚<a href=https://pkg.go.dev/bytes#Buffer.Write><code>(*bytes.Buffer).Write</code></a>ï¼Œè®°å½•çš„è°ƒç”¨æ°¸è¿œä¸ä¼šå¤±è´¥ï¼‰ï¼Œéšé™„çš„æ³¨é‡Šåº”è¯¥è§£é‡Šä¸ºä»€ä¹ˆè¿™æ˜¯å®‰å…¨çš„ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>var</span> b <span style=color:#ff7b72;font-weight:700>*</span>bytes.Buffer
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>n, _ <span style=color:#ff7b72;font-weight:700>:=</span> b.<span style=color:#d2a8ff;font-weight:700>Write</span>(p) <span style=color:#8b949e;font-style:italic>// never returns a non-nil error</span>
</span></span></code></pre></td></tr></table></div></div><p>æœ‰å…³é”™è¯¯å¤„ç†çš„æ›´å¤šè®¨è®ºå’Œç¤ºä¾‹ï¼Œè¯·å‚é˜… <a href=http://golang.org/doc/effective_go.html#errors>Effective Go</a> and <a href=https://google.github.io/styleguide/go/best-practices.html#error-handling>best practices</a>ã€‚</p><h3 id=å¸¦å†…é”™è¯¯>å¸¦å†…é”™è¯¯<a hidden class=anchor aria-hidden=true href=#å¸¦å†…é”™è¯¯>#</a></h3><p>â€‹ åœ¨ C å’Œç±»ä¼¼è¯­è¨€ä¸­ï¼Œå‡½æ•°è¿”å›å€¼ï¼ˆå¦‚ -1ã€null æˆ–ç©ºå­—ç¬¦ä¸²ï¼‰ä»¥è¡¨ç¤ºé”™è¯¯æˆ–ç¼ºå°‘ç»“æœæ˜¯å¾ˆå¸¸è§çš„ã€‚è¿™ç§°ä¸ºå¸¦å†…é”™è¯¯å¤„ç†ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Bad:</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Lookup returns the value for key or -1 if there is no mapping for key.</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> <span style=color:#d2a8ff;font-weight:700>Lookup</span>(key <span style=color:#ff7b72>string</span>) <span style=color:#ff7b72>int</span>
</span></span></code></pre></td></tr></table></div></div><p>â€‹ æœªèƒ½æ£€æŸ¥å¸¦å†…é”™è¯¯å€¼å¯èƒ½ä¼šå¯¼è‡´é”™è¯¯ï¼Œå¹¶å°†é”™è¯¯å½’å› äºé”™è¯¯çš„å‡½æ•°ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Bad:</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// The following line returns an error that Parse failed for the input value,</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// whereas the failure was that there is no mapping for missingKey.</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>return</span> <span style=color:#d2a8ff;font-weight:700>Parse</span>(<span style=color:#d2a8ff;font-weight:700>Lookup</span>(missingKey))
</span></span></code></pre></td></tr></table></div></div><p>â€‹ Go å¯¹å¤šä¸ªè¿”å›å€¼çš„æ”¯æŒæä¾›äº†æ›´å¥½çš„è§£å†³æ–¹æ¡ˆï¼ˆè¯·å‚é˜… <a href=http://golang.org/doc/effective_go.html#multiple-returns>Effective Go éƒ¨åˆ†çš„å¤šä¸ªè¿”å›å€¼</a>ï¼‰ã€‚å‡½æ•°ä¸åº”è¦æ±‚å®¢æˆ·ç«¯æ£€æŸ¥å¸¦å†…é”™è¯¯å€¼ï¼Œè€Œåº”è¿”å›ä¸€ä¸ªé™„åŠ å€¼ä»¥æŒ‡ç¤ºå…¶å…¶ä»–è¿”å›å€¼æ˜¯å¦æœ‰æ•ˆã€‚è¿™ä¸ªè¿”å›å€¼å¯èƒ½æ˜¯ä¸€ä¸ªé”™è¯¯ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œæ— éœ€è§£é‡Šï¼Œåº”è¯¥æ˜¯æœ€ç»ˆçš„è¿”å›å€¼ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Lookup returns the value for key or ok=false if there is no mapping for key.</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> <span style=color:#d2a8ff;font-weight:700>Lookup</span>(key <span style=color:#ff7b72>string</span>) (value <span style=color:#ff7b72>string</span>, ok <span style=color:#ff7b72>bool</span>)
</span></span></code></pre></td></tr></table></div></div><p>â€‹ æ­¤ API å¯é˜²æ­¢è°ƒç”¨è€…é”™è¯¯å†™å…¥<code>Parse(Lookup(key))</code>è€Œå¯¼è‡´ç¼–è¯‘æ—¶é”™è¯¯ï¼Œå› ä¸º<code>Lookup(key)</code>å®ƒæœ‰ 2 ä¸ªè¾“å‡ºã€‚</p><p>ä»¥è¿™ç§æ–¹å¼è¿”å›é”™è¯¯é¼“åŠ±æ›´å¥å£®å’Œæ˜ç¡®çš„é”™è¯¯å¤„ç†ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span>value, ok <span style=color:#ff7b72;font-weight:700>:=</span> <span style=color:#d2a8ff;font-weight:700>Lookup</span>(key)
</span></span><span style=display:flex><span><span style=color:#ff7b72>if</span> !ok {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> fmt.<span style=color:#d2a8ff;font-weight:700>Errorf</span>(<span style=color:#a5d6ff>&#34;no value for %q&#34;</span>, key)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#ff7b72>return</span> <span style=color:#d2a8ff;font-weight:700>Parse</span>(value)
</span></span></code></pre></td></tr></table></div></div><p>â€‹ ä¸€äº›æ ‡å‡†åº“å‡½æ•°ï¼Œå¦‚ packageä¸­çš„å‡½æ•°<code>strings</code>ï¼Œè¿”å›å¸¦å†…é”™è¯¯å€¼ã€‚è¿™æå¤§åœ°ç®€åŒ–äº†å­—ç¬¦ä¸²æ“ä½œä»£ç ï¼Œä½†ä»£ä»·æ˜¯éœ€è¦ç¨‹åºå‘˜æ›´åŠ å‹¤å¥‹ã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒGoogle ä»£ç åº“ä¸­çš„ Go ä»£ç åº”è¯¥ä¸ºé”™è¯¯è¿”å›é¢å¤–çš„å€¼ã€‚</p><h3 id=ç¼©è¿›é”™è¯¯æµç¨‹>ç¼©è¿›é”™è¯¯æµç¨‹<a hidden class=anchor aria-hidden=true href=#ç¼©è¿›é”™è¯¯æµç¨‹>#</a></h3><p>â€‹ åœ¨ç»§ç»­æ‚¨çš„ä»£ç çš„å…¶ä½™éƒ¨åˆ†ä¹‹å‰å¤„ç†é”™è¯¯ã€‚è¿™é€šè¿‡ä½¿è¯»è€…èƒ½å¤Ÿå¿«é€Ÿæ‰¾åˆ°æ­£å¸¸è·¯å¾„æ¥æé«˜ä»£ç çš„å¯è¯»æ€§ã€‚åŒæ ·çš„é€»è¾‘é€‚ç”¨äºä»»ä½•æµ‹è¯•æ¡ä»¶ç„¶åä»¥ç»ˆæ­¢æ¡ä»¶ç»“æŸçš„å—ï¼ˆä¾‹å¦‚<code>return</code>ï¼Œï¼Œï¼Œ<code>panic</code>ï¼‰<code>log.Fatal</code>ã€‚</p><p>â€‹ å¦‚æœä¸æ»¡è¶³ç»ˆæ­¢æ¡ä»¶ï¼Œåˆ™è¿è¡Œçš„ä»£ç åº”å‡ºç°åœ¨<code>if</code> å—ä¹‹åï¼Œå¹¶ä¸”ä¸åº”åœ¨<code>else</code>å­å¥ä¸­ç¼©è¿›ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>if</span> err <span style=color:#ff7b72;font-weight:700>!=</span> <span style=color:#79c0ff>nil</span> {
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// error handling</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> <span style=color:#8b949e;font-style:italic>// or continue, etc.</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// normal code</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Bad:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>if</span> err <span style=color:#ff7b72;font-weight:700>!=</span> <span style=color:#79c0ff>nil</span> {
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// error handling</span>
</span></span><span style=display:flex><span>} <span style=color:#ff7b72>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// normal code that looks abnormal due to indentation</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><blockquote><p>**æç¤ºï¼š**å¦‚æœæ‚¨åœ¨å¤šè¡Œä»£ç ä¸­ä½¿ç”¨ä¸€ä¸ªå˜é‡ï¼Œé€šå¸¸ä¸å€¼å¾—ä½¿ç”¨<code>if</code>-with-initializer æ ·å¼ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œé€šå¸¸æœ€å¥½å°†å£°æ˜ç§»å‡ºå¹¶ä½¿ç”¨æ ‡å‡†<code>if</code> è¯­å¥ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span>x, err <span style=color:#ff7b72;font-weight:700>:=</span> <span style=color:#d2a8ff;font-weight:700>f</span>()
</span></span><span style=display:flex><span><span style=color:#ff7b72>if</span> err <span style=color:#ff7b72;font-weight:700>!=</span> <span style=color:#79c0ff>nil</span> {
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// error handling</span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// lots of code that uses x</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// across multiple lines</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Bad:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>if</span> x, err <span style=color:#ff7b72;font-weight:700>:=</span> <span style=color:#d2a8ff;font-weight:700>f</span>(); err <span style=color:#ff7b72;font-weight:700>!=</span> <span style=color:#79c0ff>nil</span> {
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// error handling</span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span>
</span></span><span style=display:flex><span>} <span style=color:#ff7b72>else</span> {
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// lots of code that uses x</span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// across multiple lines</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div></blockquote><p>æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…<a href=https://google.github.io/styleguide/go/index.html#gotip>Go æŠ€å·§ #1ï¼šè§†çº¿</a>å’Œ <a href=https://testing.googleblog.com/2017/06/code-health-reduce-nesting-reduce.html>TotTï¼šé€šè¿‡å‡å°‘åµŒå¥—</a> æ¥é™ä½ä»£ç å¤æ‚æ€§ã€‚</p><h2 id=æ–‡å­—æ ¼å¼è¯­æ³•>æ–‡å­—æ ¼å¼è¯­æ³•<a hidden class=anchor aria-hidden=true href=#æ–‡å­—æ ¼å¼è¯­æ³•>#</a></h2><h3 id=æ— åˆ‡ç‰‡>æ— åˆ‡ç‰‡<a hidden class=anchor aria-hidden=true href=#æ— åˆ‡ç‰‡>#</a></h3><p>â€‹ <code>nil</code>å¯¹äºå¤§å¤šæ•°ç”¨é€”ï¼Œç©ºåˆ‡ç‰‡å’Œç©ºåˆ‡ç‰‡ä¹‹é—´æ²¡æœ‰åŠŸèƒ½å·®å¼‚ã€‚å†…ç½®å‡½æ•°åœ¨åˆ‡ç‰‡ä¸Šçš„è¡¨ç°<code>len</code>å’Œ<code>cap</code>é¢„æœŸä¸€æ ·ã€‚<code>nil</code></p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>import</span> <span style=color:#a5d6ff>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>var</span> s []<span style=color:#ff7b72>int</span>         <span style=color:#8b949e;font-style:italic>// nil</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fmt.<span style=color:#d2a8ff;font-weight:700>Println</span>(s)      <span style=color:#8b949e;font-style:italic>// []</span>
</span></span><span style=display:flex><span>fmt.<span style=color:#d2a8ff;font-weight:700>Println</span>(len(s)) <span style=color:#8b949e;font-style:italic>// 0</span>
</span></span><span style=display:flex><span>fmt.<span style=color:#d2a8ff;font-weight:700>Println</span>(cap(s)) <span style=color:#8b949e;font-style:italic>// 0</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>for</span> <span style=color:#ff7b72>range</span> s {<span style=color:#ff7b72;font-weight:700>...</span>}   <span style=color:#8b949e;font-style:italic>// no-op</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>s = append(s, <span style=color:#a5d6ff>42</span>)
</span></span><span style=display:flex><span>fmt.<span style=color:#d2a8ff;font-weight:700>Println</span>(s)      <span style=color:#8b949e;font-style:italic>// [42]</span>
</span></span></code></pre></td></tr></table></div></div><p>â€‹ å¦‚æœæ‚¨å°†ç©ºåˆ‡ç‰‡å£°æ˜ä¸ºå±€éƒ¨å˜é‡ï¼ˆå°¤å…¶æ˜¯å¦‚æœå®ƒå¯ä»¥ä½œä¸ºè¿”å›å€¼çš„æ¥æºï¼‰ï¼Œåˆ™é¦–é€‰ nil åˆå§‹åŒ–ä»¥é™ä½è°ƒç”¨è€…å‡ºç°é”™è¯¯çš„é£é™©ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>var</span> t []<span style=color:#ff7b72>string</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Bad:</span>
</span></span><span style=display:flex><span>t <span style=color:#ff7b72;font-weight:700>:=</span> []<span style=color:#ff7b72>string</span>{}
</span></span></code></pre></td></tr></table></div></div><p>â€‹ ä¸è¦åˆ›å»ºå¼ºåˆ¶å…¶å®¢æˆ·åŒºåˆ† nil å’Œç©ºåˆ‡ç‰‡çš„ APIã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Ping pings its targets.</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Returns hosts that successfully responded.</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> <span style=color:#d2a8ff;font-weight:700>Ping</span>(hosts []<span style=color:#ff7b72>string</span>) ([]<span style=color:#ff7b72>string</span>, <span style=color:#ff7b72>error</span>) { <span style=color:#ff7b72;font-weight:700>...</span> }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Bad:</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Ping pings its targets and returns a list of hosts</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// that successfully responded. Can be empty if the input was empty.</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// nil signifies that a system error occurred.</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> <span style=color:#d2a8ff;font-weight:700>Ping</span>(hosts []<span style=color:#ff7b72>string</span>) []<span style=color:#ff7b72>string</span> { <span style=color:#ff7b72;font-weight:700>...</span> }
</span></span></code></pre></td></tr></table></div></div><p>â€‹ åœ¨è®¾è®¡æ¥å£æ—¶ï¼Œé¿å…åŒºåˆ†<code>nil</code>åˆ‡ç‰‡å’Œ<code>nil</code>éé›¶é•¿åº¦åˆ‡ç‰‡ï¼Œå› ä¸ºè¿™ä¼šå¯¼è‡´ç»†å¾®çš„ç¼–ç¨‹é”™è¯¯ã€‚è¿™é€šå¸¸æ˜¯é€šè¿‡ä½¿ç”¨<code>len</code>to æ£€æŸ¥æ˜¯å¦ä¸ºç©ºæ¥å®Œæˆçš„ï¼Œè€Œä¸æ˜¯<code>== nil</code>.</p><p>â€‹ æ­¤å®ç°æ¥å—ä¸¤ä¸ª<code>nil</code>å’Œé›¶é•¿åº¦åˆ‡ç‰‡ä¸ºâ€œç©ºâ€ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// describeInts describes s with the given prefix, unless s is empty.</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> <span style=color:#d2a8ff;font-weight:700>describeInts</span>(prefix <span style=color:#ff7b72>string</span>, s []<span style=color:#ff7b72>int</span>) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> len(s) <span style=color:#ff7b72;font-weight:700>==</span> <span style=color:#a5d6ff>0</span> {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    fmt.<span style=color:#d2a8ff;font-weight:700>Println</span>(prefix, s)
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>â€‹ è€Œä¸æ˜¯ä¾èµ–äºåŒºåˆ«ä½œä¸º API çš„ä¸€éƒ¨åˆ†ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Bad:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> <span style=color:#d2a8ff;font-weight:700>maybeInts</span>() []<span style=color:#ff7b72>int</span> { <span style=color:#8b949e;font-style:italic>/* ... */</span> }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// describeInts describes s with the given prefix; pass nil to skip completely.</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> <span style=color:#d2a8ff;font-weight:700>describeInts</span>(prefix <span style=color:#ff7b72>string</span>, s []<span style=color:#ff7b72>int</span>) {
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// The behavior of this function unintentionally changes depending on what</span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// maybeInts() returns in &#39;empty&#39; cases (nil or []int{}).</span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>if</span> s <span style=color:#ff7b72;font-weight:700>==</span> <span style=color:#79c0ff>nil</span> {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  fmt.<span style=color:#d2a8ff;font-weight:700>Println</span>(prefix, s)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#d2a8ff;font-weight:700>describeInts</span>(<span style=color:#a5d6ff>&#34;Here are some ints:&#34;</span>, <span style=color:#d2a8ff;font-weight:700>maybeInts</span>())
</span></span></code></pre></td></tr></table></div></div><p>æœ‰å…³è¿›ä¸€æ­¥è®¨è®ºï¼Œè¯·å‚é˜…<a href=https://google.github.io/styleguide/go/decisions#in-band-errors>å¸¦å†…é”™è¯¯</a>ã€‚</p><h3 id=å‡½æ•°æ ¼å¼åŒ–>å‡½æ•°æ ¼å¼åŒ–<a hidden class=anchor aria-hidden=true href=#å‡½æ•°æ ¼å¼åŒ–>#</a></h3><p>å‡½æ•°æˆ–æ–¹æ³•å£°æ˜çš„ç­¾ååº”ä¿ç•™åœ¨ä¸€è¡Œä¸­ä»¥é¿å…<a href=https://google.github.io/styleguide/go/decisions#indentation-confusion>ç¼©è¿›æ··æ·†</a>ã€‚</p><p>å‡½æ•°å‚æ•°åˆ—è¡¨å¯ä»¥æ„æˆ Go æºæ–‡ä»¶ä¸­æœ€é•¿çš„å‡ è¡Œã€‚ä½†æ˜¯ï¼Œå®ƒä»¬å…ˆäºç¼©è¿›çš„å˜åŒ–ï¼Œå› æ­¤å¾ˆéš¾ä»¥ä¸ä½¿åç»­è¡Œçœ‹èµ·æ¥åƒå‡½æ•°ä½“çš„ä¸€éƒ¨åˆ†çš„æ–¹å¼ä»¥ä»¤äººå›°æƒ‘çš„æ–¹å¼æ–­è¡Œï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Bad:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> (r <span style=color:#ff7b72;font-weight:700>*</span>SomeType) <span style=color:#d2a8ff;font-weight:700>SomeLongFunctionName</span>(foo1, foo2, foo3 <span style=color:#ff7b72>string</span>,
</span></span><span style=display:flex><span>    foo4, foo5, foo6 <span style=color:#ff7b72>int</span>) {
</span></span><span style=display:flex><span>    foo7 <span style=color:#ff7b72;font-weight:700>:=</span> <span style=color:#d2a8ff;font-weight:700>bar</span>(foo1)
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// ...</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>è¯·å‚é˜…<a href=https://google.github.io/styleguide/go/best-practices#funcargs>æœ€ä½³å®è·µ</a>ï¼Œäº†è§£ä¸€äº›é€‰é¡¹ï¼Œä»¥ç¼©çŸ­å‡½æ•°çš„è°ƒç”¨ç«™ç‚¹ï¼Œå¦åˆ™ä¼šæœ‰å¾ˆå¤šå‚æ•°ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span>good <span style=color:#ff7b72;font-weight:700>:=</span> foo.<span style=color:#d2a8ff;font-weight:700>Call</span>(long, CallOptions{
</span></span><span style=display:flex><span>    Names:   list,
</span></span><span style=display:flex><span>    Of:      of,
</span></span><span style=display:flex><span>    The:     parameters,
</span></span><span style=display:flex><span>    Func:    all,
</span></span><span style=display:flex><span>    Args:    on,
</span></span><span style=display:flex><span>    Now:     separate,
</span></span><span style=display:flex><span>    Visible: lines,
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Bad:</span>
</span></span><span style=display:flex><span>bad <span style=color:#ff7b72;font-weight:700>:=</span> foo.<span style=color:#d2a8ff;font-weight:700>Call</span>(
</span></span><span style=display:flex><span>    long,
</span></span><span style=display:flex><span>    list,
</span></span><span style=display:flex><span>    of,
</span></span><span style=display:flex><span>    parameters,
</span></span><span style=display:flex><span>    all,
</span></span><span style=display:flex><span>    on,
</span></span><span style=display:flex><span>    separate,
</span></span><span style=display:flex><span>    lines,
</span></span><span style=display:flex><span>)
</span></span></code></pre></td></tr></table></div></div><p>é€šå¸¸å¯ä»¥é€šè¿‡åˆ†è§£å‡ºå±€éƒ¨å˜é‡æ¥ç¼©çŸ­è¡Œã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span>local <span style=color:#ff7b72;font-weight:700>:=</span> <span style=color:#d2a8ff;font-weight:700>helper</span>(some, parameters, here)
</span></span><span style=display:flex><span>good <span style=color:#ff7b72;font-weight:700>:=</span> foo.<span style=color:#d2a8ff;font-weight:700>Call</span>(list, of, parameters, local)
</span></span></code></pre></td></tr></table></div></div><p>â€‹ åŒæ ·ï¼Œå‡½æ•°å’Œæ–¹æ³•è°ƒç”¨ä¸åº”ä»…æ ¹æ®è¡Œé•¿åº¦æ¥åˆ†å¼€ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span>good <span style=color:#ff7b72;font-weight:700>:=</span> foo.<span style=color:#d2a8ff;font-weight:700>Call</span>(long, list, of, parameters, all, on, one, line)
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Bad:</span>
</span></span><span style=display:flex><span>bad <span style=color:#ff7b72;font-weight:700>:=</span> foo.<span style=color:#d2a8ff;font-weight:700>Call</span>(long, list, of, parameters,
</span></span><span style=display:flex><span>    with, arbitrary, line, breaks)
</span></span></code></pre></td></tr></table></div></div><p>â€‹ ä¸è¦ä¸ºç‰¹å®šçš„å‡½æ•°å‚æ•°æ·»åŠ æ³¨é‡Šã€‚ç›¸åï¼Œä½¿ç”¨ <a href=https://google.github.io/styleguide/go/best-practices#option-structure>é€‰é¡¹ç»“æ„</a>æˆ–å‘å‡½æ•°æ–‡æ¡£æ·»åŠ æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span>good <span style=color:#ff7b72;font-weight:700>:=</span> server.<span style=color:#d2a8ff;font-weight:700>New</span>(ctx, server.Options{Port: <span style=color:#a5d6ff>42</span>})
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Bad:</span>
</span></span><span style=display:flex><span>bad <span style=color:#ff7b72;font-weight:700>:=</span> server.<span style=color:#d2a8ff;font-weight:700>New</span>(
</span></span><span style=display:flex><span>    ctx,
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>42</span>, <span style=color:#8b949e;font-style:italic>// Port</span>
</span></span><span style=display:flex><span>)
</span></span></code></pre></td></tr></table></div></div><p>â€‹ å¦‚æœè°ƒç”¨ç«™ç‚¹é•¿å¾—è®©äººä¸èˆ’æœï¼Œè¯·è€ƒè™‘é‡æ„ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Sometimes variadic arguments can be factored out</span>
</span></span><span style=display:flex><span>replacements <span style=color:#ff7b72;font-weight:700>:=</span> []<span style=color:#ff7b72>string</span>{
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;from&#34;</span>, <span style=color:#a5d6ff>&#34;to&#34;</span>, <span style=color:#8b949e;font-style:italic>// related values can be formatted adjacent to one another</span>
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;source&#34;</span>, <span style=color:#a5d6ff>&#34;dest&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;original&#34;</span>, <span style=color:#a5d6ff>&#34;new&#34;</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Use the replacement struct as inputs to NewReplacer.</span>
</span></span><span style=display:flex><span>replacer <span style=color:#ff7b72;font-weight:700>:=</span> strings.<span style=color:#d2a8ff;font-weight:700>NewReplacer</span>(replacements<span style=color:#ff7b72;font-weight:700>...</span>)
</span></span></code></pre></td></tr></table></div></div><p>â€‹ å¦‚æœ API æ— æ³•æ›´æ”¹æˆ–æœ¬åœ°è°ƒç”¨å¼‚å¸¸ï¼ˆæ— è®ºè°ƒç”¨æ˜¯å¦å¤ªé•¿ï¼‰ï¼Œå¦‚æœæœ‰åŠ©äºç†è§£è°ƒç”¨ï¼Œåˆ™å§‹ç»ˆå…è®¸æ·»åŠ æ¢è¡Œç¬¦ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span>canvas.<span style=color:#d2a8ff;font-weight:700>RenderCube</span>(cube,
</span></span><span style=display:flex><span>    x0, y0, z0,
</span></span><span style=display:flex><span>    x0, y0, z1,
</span></span><span style=display:flex><span>    x0, y1, z0,
</span></span><span style=display:flex><span>    x0, y1, z1,
</span></span><span style=display:flex><span>    x1, y0, z0,
</span></span><span style=display:flex><span>    x1, y0, z1,
</span></span><span style=display:flex><span>    x1, y1, z0,
</span></span><span style=display:flex><span>    x1, y1, z1,
</span></span><span style=display:flex><span>)
</span></span></code></pre></td></tr></table></div></div><p>è¯·æ³¨æ„ï¼Œä¸Šä¾‹ä¸­çš„çº¿æ¡å¹¶æœªç¯ç»•åœ¨ç‰¹å®šçš„åˆ—è¾¹ç•Œå¤„ï¼Œè€Œæ˜¯æ ¹æ®åæ ‡ä¸‰å…ƒç»„è¿›è¡Œåˆ†ç»„ã€‚</p><p>â€‹ å‡½æ•°å†…çš„é•¿å­—ç¬¦ä¸²å­—é¢å€¼ä¸åº”å› è¡Œé•¿è€Œè¢«æ‰“æ–­ã€‚å¯¹äºåŒ…å«æ­¤ç±»å­—ç¬¦ä¸²çš„å‡½æ•°ï¼Œå¯ä»¥åœ¨å­—ç¬¦ä¸²æ ¼å¼åæ·»åŠ æ¢è¡Œç¬¦ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ä¸‹ä¸€è¡Œæˆ–åç»­è¡Œæä¾›å‚æ•°ã€‚å…³äºæ¢è¡Œç¬¦åº”è¯¥å»å“ªé‡Œçš„å†³å®šæœ€å¥½åŸºäºè¾“å…¥çš„è¯­ä¹‰åˆ†ç»„ï¼Œè€Œä¸æ˜¯çº¯ç²¹åŸºäºè¡Œçš„é•¿åº¦ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span>log.<span style=color:#d2a8ff;font-weight:700>Warningf</span>(<span style=color:#a5d6ff>&#34;Database key (%q, %d, %q) incompatible in transaction started by (%q, %d, %q)&#34;</span>,
</span></span><span style=display:flex><span>    currentCustomer, currentOffset, currentKey,
</span></span><span style=display:flex><span>    txCustomer, txOffset, txKey)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Bad:</span>
</span></span><span style=display:flex><span>log.<span style=color:#d2a8ff;font-weight:700>Warningf</span>(<span style=color:#a5d6ff>&#34;Database key (%q, %d, %q) incompatible in&#34;</span><span style=color:#ff7b72;font-weight:700>+</span>
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34; transaction started by (%q, %d, %q)&#34;</span>,
</span></span><span style=display:flex><span>    currentCustomer, currentOffset, currentKey, txCustomer,
</span></span><span style=display:flex><span>    txOffset, txKey)
</span></span></code></pre></td></tr></table></div></div><h3 id=æ¡ä»¶å’Œå¾ªç¯>æ¡ä»¶å’Œå¾ªç¯<a hidden class=anchor aria-hidden=true href=#æ¡ä»¶å’Œå¾ªç¯>#</a></h3><p>â€‹ å£°æ˜<code>if</code>ä¸åº”æ–­è¡Œï¼›å¤šè¡Œ<code>if</code>å­å¥ä¼šå¯¼è‡´ <a href=https://google.github.io/styleguide/go/decisions#indentation-confusion>ç¼©è¿›æ··ä¹±</a>ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Bad:</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// The second if statement is aligned with the code within the if block, causing</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// indentation confusion.</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>if</span> db.<span style=color:#d2a8ff;font-weight:700>CurrentStatusIs</span>(db.InTransaction) <span style=color:#ff7b72;font-weight:700>&amp;&amp;</span>
</span></span><span style=display:flex><span>    db.<span style=color:#d2a8ff;font-weight:700>ValuesEqual</span>(db.<span style=color:#d2a8ff;font-weight:700>TransactionKey</span>(), row.<span style=color:#d2a8ff;font-weight:700>Key</span>()) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> db.<span style=color:#d2a8ff;font-weight:700>Errorf</span>(db.TransactionError, <span style=color:#a5d6ff>&#34;query failed: row (%v): key does not match transaction key&#34;</span>, row)
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>å¦‚æœä¸éœ€è¦çŸ­è·¯è¡Œä¸ºï¼Œå¯ä»¥ç›´æ¥æå–å¸ƒå°”æ“ä½œæ•°ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span>inTransaction <span style=color:#ff7b72;font-weight:700>:=</span> db.<span style=color:#d2a8ff;font-weight:700>CurrentStatusIs</span>(db.InTransaction)
</span></span><span style=display:flex><span>keysMatch <span style=color:#ff7b72;font-weight:700>:=</span> db.<span style=color:#d2a8ff;font-weight:700>ValuesEqual</span>(db.<span style=color:#d2a8ff;font-weight:700>TransactionKey</span>(), row.<span style=color:#d2a8ff;font-weight:700>Key</span>())
</span></span><span style=display:flex><span><span style=color:#ff7b72>if</span> inTransaction <span style=color:#ff7b72;font-weight:700>&amp;&amp;</span> keysMatch {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> db.<span style=color:#d2a8ff;font-weight:700>Error</span>(db.TransactionError, <span style=color:#a5d6ff>&#34;query failed: row (%v): key does not match transaction key&#34;</span>, row)
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>å¯èƒ½è¿˜å¯ä»¥æå–å…¶ä»–å±€éƒ¨å˜é‡ï¼Œå°¤å…¶æ˜¯åœ¨æ¡ä»¶å·²ç»é‡å¤çš„æƒ…å†µä¸‹ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span>uid <span style=color:#ff7b72;font-weight:700>:=</span> user.<span style=color:#d2a8ff;font-weight:700>GetUniqueUserID</span>()
</span></span><span style=display:flex><span><span style=color:#ff7b72>if</span> db.<span style=color:#d2a8ff;font-weight:700>UserIsAdmin</span>(uid) <span style=color:#ff7b72;font-weight:700>||</span> db.<span style=color:#d2a8ff;font-weight:700>UserHasPermission</span>(uid, perms.ViewServerConfig) <span style=color:#ff7b72;font-weight:700>||</span> db.<span style=color:#d2a8ff;font-weight:700>UserHasPermission</span>(uid, perms.CreateGroup) {
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// ...</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Bad:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>if</span> db.<span style=color:#d2a8ff;font-weight:700>UserIsAdmin</span>(user.<span style=color:#d2a8ff;font-weight:700>GetUniqueUserID</span>()) <span style=color:#ff7b72;font-weight:700>||</span> db.<span style=color:#d2a8ff;font-weight:700>UserHasPermission</span>(user.<span style=color:#d2a8ff;font-weight:700>GetUniqueUserID</span>(), perms.ViewServerConfig) <span style=color:#ff7b72;font-weight:700>||</span> db.<span style=color:#d2a8ff;font-weight:700>UserHasPermission</span>(user.<span style=color:#d2a8ff;font-weight:700>GetUniqueUserID</span>(), perms.CreateGroup) {
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// ...</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p><code>if</code>åŒ…å«é—­åŒ…æˆ–å¤šè¡Œç»“æ„æ–‡å­—çš„è¯­å¥åº”ç¡®ä¿<a href=https://google.github.io/styleguide/go/decisions#literal-matching-braces>å¤§æ‹¬å·åŒ¹é…</a>ä»¥é¿å… <a href=https://google.github.io/styleguide/go/decisions#indentation-confusion>ç¼©è¿›æ··æ·†</a>ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>if</span> err <span style=color:#ff7b72;font-weight:700>:=</span> db.<span style=color:#d2a8ff;font-weight:700>RunInTransaction</span>(<span style=color:#ff7b72>func</span>(tx <span style=color:#ff7b72;font-weight:700>*</span>db.TX) <span style=color:#ff7b72>error</span> {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> tx.<span style=color:#d2a8ff;font-weight:700>Execute</span>(userUpdate, x, y, z)
</span></span><span style=display:flex><span>}); err <span style=color:#ff7b72;font-weight:700>!=</span> <span style=color:#79c0ff>nil</span> {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> fmt.<span style=color:#d2a8ff;font-weight:700>Errorf</span>(<span style=color:#a5d6ff>&#34;user update failed: %s&#34;</span>, err)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>if</span> _, err <span style=color:#ff7b72;font-weight:700>:=</span> client.<span style=color:#d2a8ff;font-weight:700>Update</span>(ctx, <span style=color:#ff7b72;font-weight:700>&amp;</span>upb.UserUpdateRequest{
</span></span><span style=display:flex><span>    ID:   userID,
</span></span><span style=display:flex><span>    User: user,
</span></span><span style=display:flex><span>}); err <span style=color:#ff7b72;font-weight:700>!=</span> <span style=color:#79c0ff>nil</span> {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> fmt.<span style=color:#d2a8ff;font-weight:700>Errorf</span>(<span style=color:#a5d6ff>&#34;user update failed: %s&#34;</span>, err)
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>åŒæ ·ï¼Œä¸è¦å°è¯•åœ¨<code>for</code>è¯­å¥ä¸­æ’å…¥äººä¸ºçš„æ¢è¡Œç¬¦ã€‚å¦‚æœæ²¡æœ‰ä¼˜é›…çš„é‡æ„æ–¹å¼ï¼Œä½ æ€»æ˜¯å¯ä»¥è®©è¿™æ¡çº¿å¾ˆé•¿ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>for</span> i, max <span style=color:#ff7b72;font-weight:700>:=</span> <span style=color:#a5d6ff>0</span>, collection.<span style=color:#d2a8ff;font-weight:700>Size</span>(); i &lt; max <span style=color:#ff7b72;font-weight:700>&amp;&amp;</span> !collection.<span style=color:#d2a8ff;font-weight:700>HasPendingWriters</span>(); i<span style=color:#ff7b72;font-weight:700>++</span> {
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// ...</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>ä½†æ˜¯ï¼Œé€šå¸¸æœ‰ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>for</span> i, max <span style=color:#ff7b72;font-weight:700>:=</span> <span style=color:#a5d6ff>0</span>, collection.<span style=color:#d2a8ff;font-weight:700>Size</span>(); i &lt; max; i<span style=color:#ff7b72;font-weight:700>++</span> {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> collection.<span style=color:#d2a8ff;font-weight:700>HasPendingWriters</span>() {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>break</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// ...</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p><code>switch</code>å’Œ<code>case</code>è¯­å¥ä¹Ÿåº”è¯¥ä¿æŒåœ¨ä¸€è¡Œä¸­ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>switch</span> good <span style=color:#ff7b72;font-weight:700>:=</span> db.<span style=color:#d2a8ff;font-weight:700>TransactionStatus</span>(); good {
</span></span><span style=display:flex><span><span style=color:#ff7b72>case</span> db.TransactionStarting, db.TransactionActive, db.TransactionWaiting:
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// ...</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>case</span> db.TransactionCommitted, db.NoTransaction:
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// ...</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>default</span>:
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// ...</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Bad:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>switch</span> bad <span style=color:#ff7b72;font-weight:700>:=</span> db.<span style=color:#d2a8ff;font-weight:700>TransactionStatus</span>(); bad {
</span></span><span style=display:flex><span><span style=color:#ff7b72>case</span> db.TransactionStarting,
</span></span><span style=display:flex><span>    db.TransactionActive,
</span></span><span style=display:flex><span>    db.TransactionWaiting:
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// ...</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>case</span> db.TransactionCommitted,
</span></span><span style=display:flex><span>    db.NoTransaction:
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// ...</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>default</span>:
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// ...</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>å¦‚æœè¡Œå¤ªé•¿ï¼Œç¼©è¿›æ‰€æœ‰çš„æ¡ˆä¾‹å¹¶ç”¨ç©ºè¡Œåˆ†éš”å®ƒä»¬ä»¥é¿å…<a href=https://google.github.io/styleguide/go/decisions#indentation-confusion>ç¼©è¿›æ··æ·†</a>ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>switch</span> db.<span style=color:#d2a8ff;font-weight:700>TransactionStatus</span>() {
</span></span><span style=display:flex><span><span style=color:#ff7b72>case</span>
</span></span><span style=display:flex><span>    db.TransactionStarting,
</span></span><span style=display:flex><span>    db.TransactionActive,
</span></span><span style=display:flex><span>    db.TransactionWaiting,
</span></span><span style=display:flex><span>    db.TransactionCommitted:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// ...</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>case</span> db.NoTransaction:
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// ...</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>default</span>:
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// ...</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>åœ¨æ¯”è¾ƒå˜é‡å’Œå¸¸é‡çš„æ¡ä»¶è¯­å¥ä¸­ï¼Œå°†å˜é‡å€¼æ”¾åœ¨ç›¸ç­‰è¿ç®—ç¬¦çš„å·¦ä¾§ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>if</span> result <span style=color:#ff7b72;font-weight:700>==</span> <span style=color:#a5d6ff>&#34;foo&#34;</span> {
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// ...</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>å–è€Œä»£ä¹‹çš„æ˜¯å¸¸æ•°é¦–å…ˆå‡ºç°çš„ä¸å¤ªæ¸…æ™°çš„æªè¾ï¼ˆ<a href=https://en.wikipedia.org/wiki/Yoda_conditions>â€œYoda style conditionalsâ€</a>ï¼‰ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Bad:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>if</span> <span style=color:#a5d6ff>&#34;foo&#34;</span> <span style=color:#ff7b72;font-weight:700>==</span> result {
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// ...</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h2 id=å¤åˆ¶>å¤åˆ¶<a hidden class=anchor aria-hidden=true href=#å¤åˆ¶>#</a></h2><p>ä¸ºé¿å…æ„å¤–çš„åˆ«åå’Œç±»ä¼¼é”™è¯¯ï¼Œä»å¦ä¸€ä¸ªåŒ…å¤åˆ¶ç»“æ„æ—¶è¦å°å¿ƒã€‚ä¾‹å¦‚ï¼Œ<code>sync.Mutex</code> ä¸å¾—å¤åˆ¶è¯¸å¦‚æ­¤ç±»çš„åŒæ­¥å¯¹è±¡ã€‚</p><p>è¯¥<code>bytes.Buffer</code>ç±»å‹åŒ…å«ä¸€ä¸ª<code>[]byte</code>åˆ‡ç‰‡ï¼Œå¹¶ä¸”ä½œä¸ºå¯¹å°å­—ç¬¦ä¸²çš„ä¼˜åŒ–ï¼Œè¿˜åŒ…å«ä¸€ä¸ªåˆ‡ç‰‡å¯èƒ½å¼•ç”¨çš„å°å­—èŠ‚æ•°ç»„ã€‚å¦‚æœæ‚¨å¤åˆ¶ a <code>Buffer</code>ï¼Œåˆ™å‰¯æœ¬ä¸­çš„åˆ‡ç‰‡å¯èƒ½ä¼šä¸ºåŸå§‹æ•°ç»„è®¾ç½®åˆ«åï¼Œä»è€Œå¯¼è‡´åç»­æ–¹æ³•è°ƒç”¨äº§ç”Ÿä»¤äººæƒŠè®¶çš„æ•ˆæœã€‚</p><p><code>T</code>é€šå¸¸ï¼Œå¦‚æœç±»å‹çš„æ–¹æ³•ä¸æŒ‡é’ˆç±»å‹å…³è”ï¼Œåˆ™ä¸è¦å¤åˆ¶è¯¥ç±»å‹çš„å€¼<code>*T</code>ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Bad:</span>
</span></span><span style=display:flex><span>b1 <span style=color:#ff7b72;font-weight:700>:=</span> bytes.Buffer{}
</span></span><span style=display:flex><span>b2 <span style=color:#ff7b72;font-weight:700>:=</span> b1
</span></span></code></pre></td></tr></table></div></div><p>è°ƒç”¨é‡‡ç”¨å€¼æ¥æ”¶å™¨çš„æ–¹æ³•å¯ä»¥éšè—å‰¯æœ¬ã€‚å½“æ‚¨ç¼–å†™ API æ—¶ï¼Œå¦‚æœæ‚¨çš„ç»“æ„åŒ…å«ä¸åº”å¤åˆ¶çš„å­—æ®µï¼Œæ‚¨é€šå¸¸åº”è¯¥è·å–å’Œè¿”å›æŒ‡é’ˆç±»å‹ã€‚</p><p>è¿™äº›æ˜¯å¯ä»¥æ¥å—çš„ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>type</span> Record <span style=color:#ff7b72>struct</span> {
</span></span><span style=display:flex><span>  buf bytes.Buffer
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// other fields omitted</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> <span style=color:#d2a8ff;font-weight:700>New</span>() <span style=color:#ff7b72;font-weight:700>*</span>Record {<span style=color:#ff7b72;font-weight:700>...</span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> (r <span style=color:#ff7b72;font-weight:700>*</span>Record) <span style=color:#d2a8ff;font-weight:700>Process</span>(<span style=color:#ff7b72;font-weight:700>...</span>) {<span style=color:#ff7b72;font-weight:700>...</span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> <span style=color:#d2a8ff;font-weight:700>Consumer</span>(r <span style=color:#ff7b72;font-weight:700>*</span>Record) {<span style=color:#ff7b72;font-weight:700>...</span>}
</span></span></code></pre></td></tr></table></div></div><p>ä½†è¿™äº›é€šå¸¸æ˜¯é”™è¯¯çš„ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Bad:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>type</span> Record <span style=color:#ff7b72>struct</span> {
</span></span><span style=display:flex><span>  buf bytes.Buffer
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// other fields omitted</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> (r Record) <span style=color:#d2a8ff;font-weight:700>Process</span>(<span style=color:#ff7b72;font-weight:700>...</span>) {<span style=color:#ff7b72;font-weight:700>...</span>} <span style=color:#8b949e;font-style:italic>// Makes a copy of r.buf</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> <span style=color:#d2a8ff;font-weight:700>Consumer</span>(r Record) {<span style=color:#ff7b72;font-weight:700>...</span>} <span style=color:#8b949e;font-style:italic>// Makes a copy of r.buf</span>
</span></span></code></pre></td></tr></table></div></div><p>æœ¬æŒ‡å—ä¹Ÿé€‚ç”¨äºå¤å°<code>sync.Mutex</code>ã€‚</p><h3 id=æ¥å£>æ¥å£<a hidden class=anchor aria-hidden=true href=#æ¥å£>#</a></h3><p>â€‹ Goæ¥å£é€šå¸¸å±äºä½¿ç”¨æ¥å£ç±»å‹å€¼çš„åŒ…ï¼Œè€Œä¸æ˜¯<em>å®ç°</em>æ¥å£ç±»å‹çš„åŒ…ã€‚å®æ–½åŒ…åº”è¯¥è¿”å›å…·ä½“çš„ï¼ˆé€šå¸¸æ˜¯æŒ‡é’ˆæˆ–ç»“æ„ï¼‰ç±»å‹ã€‚è¿™æ ·ï¼Œæ— éœ€å¤§é‡é‡æ„å³å¯å°†æ–°æ–¹æ³•æ·»åŠ åˆ°å®ç°ä¸­ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…<a href=https://google.github.io/styleguide/go/index.html#gotip>GoTip #49ï¼šæ¥å—æ¥å£ï¼Œè¿”å›å…·ä½“ç±»å‹</a> ã€‚</p><p>â€‹ ä¸è¦ä»ä½¿ç”¨æ¥å£çš„ API å¯¼å‡ºæ¥å£çš„<a href=https://abseil.io/resources/swe-book/html/ch13.html#techniques_for_using_test_doubles>æµ‹è¯•æ›¿èº«</a>å®ç°ã€‚ç›¸åï¼Œè®¾è®¡ API ä»¥ä¾¿å¯ä»¥ä½¿ç”¨<a href=https://google.github.io/styleguide/go/best-practices#use-real-transports>å®é™…å®ç°</a>çš„<a href=https://abseil.io/resources/swe-book/html/ch12.html#test_via_public_apis>å…¬å…± API</a>å¯¹å…¶è¿›è¡Œæµ‹è¯•ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… <a href=https://google.github.io/styleguide/go/index.html#gotip>GoTip #42ï¼šç¼–å†™ç”¨äºæµ‹è¯•çš„å­˜æ ¹</a>ã€‚å³ä½¿åœ¨ä½¿ç”¨çœŸå®å®ç°ä¸å¯è¡Œçš„æƒ…å†µä¸‹ï¼Œä¹Ÿå¯èƒ½æ²¡æœ‰å¿…è¦å¼•å…¥ä¸€ä¸ªå®Œå…¨è¦†ç›–çœŸå®ç±»å‹ä¸­æ‰€æœ‰æ–¹æ³•çš„æ¥å£ï¼›æ¶ˆè´¹è€…å¯ä»¥åˆ›å»ºä¸€ä¸ªä»…åŒ…å«å…¶æ‰€éœ€æ–¹æ³•çš„æ¥å£ï¼Œå¦‚ <a href=https://google.github.io/styleguide/go/index.html#gotip>GoTip #78ï¼šæœ€å°å¯è¡Œæ¥å£</a>ä¸­æ‰€ç¤ºã€‚</p><p>â€‹ è¦æµ‹è¯•ä½¿ç”¨ Stubby RPC å®¢æˆ·ç«¯çš„åŒ…ï¼Œè¯·ä½¿ç”¨çœŸå®çš„å®¢æˆ·ç«¯è¿æ¥ã€‚å¦‚æœæ— æ³•åœ¨æµ‹è¯•ä¸­è¿è¡ŒçœŸå®æœåŠ¡å™¨ï¼ŒGoogle çš„å†…éƒ¨åšæ³•æ˜¯ä½¿ç”¨å†…éƒ¨ rpctest åŒ…ï¼ˆå³å°†æ¨å‡ºï¼ï¼‰è·å–åˆ°æœ¬åœ° [test double] çš„çœŸå®å®¢æˆ·ç«¯è¿æ¥ã€‚</p><p>â€‹ ä¸è¦åœ¨ä½¿ç”¨ä¹‹å‰å®šä¹‰æ¥å£ï¼ˆè¯·å‚é˜… <a href=https://testing.googleblog.com/2017/08/code-health-eliminate-yagni-smells.html>TotTï¼šä»£ç å¥åº·ï¼šæ¶ˆé™¤ YAGNI æ°”å‘³</a>ï¼‰(YAGNI: <em><strong>ä½ ä¸éœ€è¦å®ƒï¼ˆ You Arenâ€™t Gonna Need It</strong></em>)ã€‚å¦‚æœæ²¡æœ‰å®é™…çš„ä½¿ç”¨ç¤ºä¾‹ï¼Œå°±å¾ˆéš¾åˆ¤æ–­ä¸€ä¸ªæ¥å£æ˜¯å¦å¿…è¦ï¼Œæ›´ä¸ç”¨è¯´å®ƒåº”è¯¥åŒ…å«å“ªäº›æ–¹æ³•äº†ã€‚</p><blockquote><p>è½¯ä»¶å¼€å‘çš„å¤§éƒ¨åˆ†æˆæœ¬æ˜¯ç»´æŠ¤æˆæœ¬ã€‚<strong>å‡å°‘ç»´æŠ¤æˆæœ¬çš„ä¸€ä¸ªæ–¹æ³•æ˜¯ï¼šâ€œåªåœ¨å½“ä½ çœŸæ­£éœ€è¦å®ƒæ—¶ï¼Œæ‰å»ç¼–å†™å®ƒâ€</strong>ã€‚</p></blockquote><p>å¦‚æœåŒ…çš„ç”¨æˆ·ä¸éœ€è¦ä¸ºä»–ä»¬ä¼ é€’ä¸åŒçš„ç±»å‹ï¼Œè¯·ä¸è¦ä½¿ç”¨æ¥å£ç±»å‹å‚æ•°ã€‚</p><p><code>ä¸è¦å¯¼å‡ºåŒ…çš„ç”¨æˆ·ä¸éœ€è¦çš„æ¥å£</code>ã€‚</p><p>**TODOï¼š**åœ¨æ¥å£ä¸Šå†™ä¸€ä¸ªæ›´æ·±å…¥çš„æ–‡æ¡£å¹¶åœ¨æ­¤å¤„é“¾æ¥åˆ°å®ƒã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>package</span> consumer <span style=color:#8b949e;font-style:italic>// consumer.go</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>type</span> Thinger <span style=color:#ff7b72>interface</span> { <span style=color:#d2a8ff;font-weight:700>Thing</span>() <span style=color:#ff7b72>bool</span> }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> <span style=color:#d2a8ff;font-weight:700>Foo</span>(t Thinger) <span style=color:#ff7b72>string</span> { <span style=color:#ff7b72;font-weight:700>...</span> }
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>package</span> consumer <span style=color:#8b949e;font-style:italic>// consumer_test.go</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>type</span> fakeThinger <span style=color:#ff7b72>struct</span>{ <span style=color:#ff7b72;font-weight:700>...</span> }
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> (t fakeThinger) <span style=color:#d2a8ff;font-weight:700>Thing</span>() <span style=color:#ff7b72>bool</span> { <span style=color:#ff7b72;font-weight:700>...</span> }
</span></span><span style=display:flex><span><span style=color:#ff7b72;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>if</span> <span style=color:#d2a8ff;font-weight:700>Foo</span>(fakeThinger{<span style=color:#ff7b72;font-weight:700>...</span>}) <span style=color:#ff7b72;font-weight:700>==</span> <span style=color:#a5d6ff>&#34;x&#34;</span> { <span style=color:#ff7b72;font-weight:700>...</span> }
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">9
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Bad:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>package</span> producer
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>type</span> Thinger <span style=color:#ff7b72>interface</span> { <span style=color:#d2a8ff;font-weight:700>Thing</span>() <span style=color:#ff7b72>bool</span> }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>type</span> defaultThinger <span style=color:#ff7b72>struct</span>{ <span style=color:#ff7b72;font-weight:700>...</span> }
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> (t defaultThinger) <span style=color:#d2a8ff;font-weight:700>Thing</span>() <span style=color:#ff7b72>bool</span> { <span style=color:#ff7b72;font-weight:700>...</span> }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> <span style=color:#d2a8ff;font-weight:700>NewThinger</span>() Thinger { <span style=color:#ff7b72>return</span> defaultThinger{ <span style=color:#ff7b72;font-weight:700>...</span> } }
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>package</span> producer
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>type</span> Thinger <span style=color:#ff7b72>struct</span>{ <span style=color:#ff7b72;font-weight:700>...</span> }
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> (t Thinger) <span style=color:#d2a8ff;font-weight:700>Thing</span>() <span style=color:#ff7b72>bool</span> { <span style=color:#ff7b72;font-weight:700>...</span> }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> <span style=color:#d2a8ff;font-weight:700>NewThinger</span>() Thinger { <span style=color:#ff7b72>return</span> Thinger{ <span style=color:#ff7b72;font-weight:700>...</span> } }
</span></span></code></pre></td></tr></table></div></div><h2 id=ä¼ å€¼>ä¼ å€¼<a hidden class=anchor aria-hidden=true href=#ä¼ å€¼>#</a></h2><blockquote><p>ä¸è¦ä¸ºäº†èŠ‚çœå‡ ä¸ªå­—èŠ‚è€Œå°†æŒ‡é’ˆä½œä¸ºå‡½æ•°å‚æ•°ä¼ é€’ã€‚</p></blockquote><p>â€‹ å¦‚æœä¸€ä¸ªå‡½æ•°<code>x</code>åªè¯»å–å®ƒçš„å‚æ•°<code>*x</code>ï¼Œé‚£ä¹ˆè¿™ä¸ªå‚æ•°ä¸åº”è¯¥æ˜¯ä¸€ä¸ªæŒ‡é’ˆã€‚è¿™æ–¹é¢çš„å¸¸è§å®ä¾‹åŒ…æ‹¬ä¼ é€’ä¸€ä¸ªæŒ‡å‘å­—ç¬¦ä¸² ( <code>*string</code>) çš„æŒ‡é’ˆæˆ–ä¸€ä¸ªæŒ‡å‘æ¥å£å€¼ ( <code>*io.Reader</code>) çš„æŒ‡é’ˆã€‚åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œå€¼æœ¬èº«éƒ½æ˜¯å›ºå®šå¤§å°çš„ï¼Œå¯ä»¥ç›´æ¥ä¼ é€’ã€‚</p><p>â€‹ æ­¤å»ºè®®ä¸é€‚ç”¨äºå¤§å‹ç»“æ„ï¼Œç”šè‡³å¯èƒ½ä¼šå¢åŠ å¤§å°çš„å°å‹ç»“æ„ã€‚ç‰¹åˆ«æ˜¯ï¼Œprotocol buffer æ¶ˆæ¯é€šå¸¸åº”è¯¥ç”±æŒ‡é’ˆè€Œä¸æ˜¯å€¼æ¥å¤„ç†ã€‚æŒ‡é’ˆç±»å‹æ»¡è¶³ <code>proto.Message</code>æ¥å£ï¼ˆè¢« , ç­‰æ¥å—<code>proto.Marshal</code>ï¼‰<code>protocmp.Transform</code>ï¼Œå¹¶ä¸”åè®®ç¼“å†²åŒºæ¶ˆæ¯å¯èƒ½éå¸¸å¤§ï¼Œå¹¶ä¸”é€šå¸¸ä¼šéšç€æ—¶é—´çš„æ¨ç§»è€Œå˜å¤§ã€‚</p><h3 id=æ¥æ”¶å™¨ç±»å‹>æ¥æ”¶å™¨ç±»å‹<a hidden class=anchor aria-hidden=true href=#æ¥æ”¶å™¨ç±»å‹>#</a></h3><p>â€‹ æ–¹æ³•<a href=https://golang.org/ref/spec#Method_declarations>æ¥æ”¶è€…</a>å¯ä»¥ä½œä¸ºå€¼æˆ–æŒ‡é’ˆä¼ é€’ï¼Œå°±å¥½åƒå®ƒæ˜¯å¸¸è§„å‡½æ•°å‚æ•°ä¸€æ ·ã€‚é€‰æ‹©å“ªä¸ªåº”è¯¥åŸºäºè¯¥æ–¹æ³•åº”è¯¥å±äºå“ªä¸ª<a href=https://golang.org/ref/spec#Method_sets>æ–¹æ³•é›†</a>ã€‚</p><p>â€‹ **æ­£ç¡®æ€§èƒœè¿‡é€Ÿåº¦æˆ–ç®€å•æ€§ã€‚**åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ‚¨å¿…é¡»ä½¿ç”¨æŒ‡é’ˆå€¼ã€‚åœ¨å…¶ä»–æƒ…å†µä¸‹ï¼Œå¦‚æœæ‚¨å¯¹ä»£ç å°†å¦‚ä½•å¢é•¿æ²¡æœ‰å¾ˆå¥½çš„äº†è§£ï¼Œåˆ™ä¸ºå¤§å‹ç±»å‹é€‰æ‹©æŒ‡é’ˆæˆ–ä½œä¸ºé¢å‘æœªæ¥çš„æŒ‡é’ˆï¼Œå¹¶ä¸ºç®€å•çš„<a href=https://en.wikipedia.org/wiki/Passive_data_structure>æ™®é€šæ—§æ•°æ®</a>ä½¿ç”¨å€¼ã€‚</p><p>ä¸‹é¢çš„åˆ—è¡¨æ›´è¯¦ç»†åœ°è¯´æ˜äº†æ¯ä¸ªæ¡ˆä¾‹ï¼š</p><ul><li><p>å¦‚æœæ¥æ”¶è€…æ˜¯ä¸€ä¸ªåˆ‡ç‰‡å¹¶ä¸”è¯¥æ–¹æ³•ä¸é‡æ–°åˆ‡ç‰‡æˆ–é‡æ–°åˆ†é…åˆ‡ç‰‡ï¼Œè¯·ä½¿ç”¨å€¼è€Œä¸æ˜¯æŒ‡é’ˆã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>type</span> Buffer []<span style=color:#ff7b72>byte</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> (b Buffer) <span style=color:#d2a8ff;font-weight:700>Len</span>() <span style=color:#ff7b72>int</span> { <span style=color:#ff7b72>return</span> len(b) }
</span></span></code></pre></td></tr></table></div></div></li><li><p>å¦‚æœè¯¥æ–¹æ³•éœ€è¦æ”¹å˜æ¥æ”¶è€…ï¼Œåˆ™æ¥æ”¶è€…å¿…é¡»æ˜¯ä¸€ä¸ªæŒ‡é’ˆã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">9
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>type</span> Counter <span style=color:#ff7b72>int</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> (c <span style=color:#ff7b72;font-weight:700>*</span>Counter) <span style=color:#d2a8ff;font-weight:700>Inc</span>() { <span style=color:#ff7b72;font-weight:700>*</span>c<span style=color:#ff7b72;font-weight:700>++</span> }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// See https://pkg.go.dev/container/heap.</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>type</span> Queue []Item
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> (q <span style=color:#ff7b72;font-weight:700>*</span>Queue) <span style=color:#d2a8ff;font-weight:700>Push</span>(x Item) { <span style=color:#ff7b72;font-weight:700>*</span>q = append([]Item{x}, <span style=color:#ff7b72;font-weight:700>*</span>q<span style=color:#ff7b72;font-weight:700>...</span>) }
</span></span></code></pre></td></tr></table></div></div></li><li><p>å¦‚æœæ¥æ”¶è€…æ˜¯ä¸€ä¸ªåŒ…å« <a href=https://google.github.io/styleguide/go/decisions#copying>æ— æ³•å®‰å…¨å¤åˆ¶</a>çš„å­—æ®µçš„ç»“æ„ï¼Œè¯·ä½¿ç”¨æŒ‡é’ˆæ¥æ”¶è€…ã€‚å¸¸è§çš„ä¾‹å­æ˜¯<a href=https://pkg.go.dev/sync#Mutex><code>sync.Mutex</code></a>å’Œå…¶ä»–åŒæ­¥ç±»å‹ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>type</span> Counter <span style=color:#ff7b72>struct</span> {
</span></span><span style=display:flex><span>    mu    sync.Mutex
</span></span><span style=display:flex><span>    total <span style=color:#ff7b72>int</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> (c <span style=color:#ff7b72;font-weight:700>*</span>Counter) <span style=color:#d2a8ff;font-weight:700>Inc</span>() {
</span></span><span style=display:flex><span>    c.mu.<span style=color:#d2a8ff;font-weight:700>Lock</span>()
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>defer</span> c.mu.<span style=color:#d2a8ff;font-weight:700>Unlock</span>()
</span></span><span style=display:flex><span>    c.total<span style=color:#ff7b72;font-weight:700>++</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>**æç¤ºï¼š**æ£€æŸ¥ç±»å‹çš„<a href=https://pkg.go.dev/time#example-Duration>Godoc</a>ä»¥è·å–æœ‰å…³å¤åˆ¶æ˜¯å¦å®‰å…¨çš„ä¿¡æ¯ã€‚</p></li><li><p>å¦‚æœæ¥æ”¶å™¨æ˜¯â€œå¤§â€ç»“æ„æˆ–æ•°ç»„ï¼ŒæŒ‡é’ˆæ¥æ”¶å™¨å¯èƒ½æ›´æœ‰æ•ˆã€‚ä¼ é€’ç»“æ„ç­‰åŒäºå°†å…¶æ‰€æœ‰å­—æ®µæˆ–å…ƒç´ ä½œä¸ºå‚æ•°ä¼ é€’ç»™æ–¹æ³•ã€‚å¦‚æœè¿™çœ‹èµ·æ¥å¤ªå¤§è€Œä¸èƒ½ <a href=https://google.github.io/styleguide/go/decisions#pass-values>æŒ‰å€¼ä¼ é€’</a>ï¼Œé‚£ä¹ˆæŒ‡é’ˆæ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚</p></li><li><p>å¯¹äºå°†è°ƒç”¨æˆ–ä¸å…¶ä»–ä¿®æ”¹æ¥æ”¶å™¨çš„å‡½æ•°åŒæ—¶è¿è¡Œçš„æ–¹æ³•ï¼Œå¦‚æœè¿™äº›ä¿®æ”¹å¯¹æ‚¨çš„æ–¹æ³•ä¸å¯è§ï¼Œè¯·ä½¿ç”¨ä¸€ä¸ªå€¼ï¼›å¦åˆ™ä½¿ç”¨æŒ‡é’ˆã€‚</p></li><li><p>å¦‚æœæ¥æ”¶å™¨æ˜¯ä¸€ä¸ªç»“æ„æˆ–æ•°ç»„ï¼Œå…¶ä¸­ä»»ä½•ä¸€ä¸ªå…ƒç´ éƒ½æ˜¯æŒ‡å‘å¯èƒ½å‘ç”Ÿå˜åŒ–çš„ä¸œè¥¿çš„æŒ‡é’ˆï¼Œåˆ™æ›´å–œæ¬¢æŒ‡é’ˆæ¥æ”¶å™¨ä»¥ä½¿è¯»è€…æ¸…æ¥šåœ°äº†è§£å¯å˜æ€§çš„æ„å›¾ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>type</span> Counter <span style=color:#ff7b72>struct</span> {
</span></span><span style=display:flex><span>    m <span style=color:#ff7b72;font-weight:700>*</span>Metric
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> (c <span style=color:#ff7b72;font-weight:700>*</span>Counter) <span style=color:#d2a8ff;font-weight:700>Inc</span>() {
</span></span><span style=display:flex><span>    c.m.<span style=color:#d2a8ff;font-weight:700>Add</span>(<span style=color:#a5d6ff>1</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div></li><li><p>å¦‚æœæ¥æ”¶è€…æ˜¯<a href=https://pkg.go.dev/builtin>å†…ç½®ç±»å‹</a>ï¼Œä¾‹å¦‚æ•´æ•°æˆ–å­—ç¬¦ä¸²ï¼Œä¸éœ€è¦ä¿®æ”¹ï¼Œåˆ™ä½¿ç”¨å€¼ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>type</span> User <span style=color:#ff7b72>string</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> (u User) <span style=color:#d2a8ff;font-weight:700>String</span>() { <span style=color:#ff7b72>return</span> string(u) }
</span></span></code></pre></td></tr></table></div></div></li><li><p>å¦‚æœæ¥æ”¶è€…æ˜¯æ˜ å°„ã€å‡½æ•°æˆ–é€šé“ï¼Œè¯·ä½¿ç”¨å€¼è€Œä¸æ˜¯æŒ‡é’ˆã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// See https://pkg.go.dev/net/http#Header.</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>type</span> Header <span style=color:#ff7b72>map</span>[<span style=color:#ff7b72>string</span>][]<span style=color:#ff7b72>string</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> (h Header) <span style=color:#d2a8ff;font-weight:700>Add</span>(key, value <span style=color:#ff7b72>string</span>) { <span style=color:#8b949e;font-style:italic>/* omitted */</span> }
</span></span></code></pre></td></tr></table></div></div></li><li><p>å¦‚æœæ¥æ”¶è€…æ˜¯ä¸€ä¸ªâ€œå°â€æ•°ç»„æˆ–ç»“æ„ï¼Œå®ƒè‡ªç„¶æ˜¯ä¸€ä¸ªæ²¡æœ‰å¯å˜å­—æ®µå’ŒæŒ‡é’ˆçš„å€¼ç±»å‹ï¼Œé‚£ä¹ˆå€¼æ¥æ”¶è€…é€šå¸¸æ˜¯æ­£ç¡®çš„é€‰æ‹©ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-gdscript3 data-lang=gdscript3><span style=display:flex><span><span style=color:#ff7b72;font-weight:700>//</span> Good:
</span></span><span style=display:flex><span><span style=color:#ff7b72;font-weight:700>//</span> See https:<span style=color:#ff7b72;font-weight:700>//</span>pkg<span style=color:#ff7b72;font-weight:700>.</span>go<span style=color:#ff7b72;font-weight:700>.</span>dev<span style=color:#ff7b72;font-weight:700>/</span>time<span style=color:#8b949e;font-style:italic>#Time.</span>
</span></span><span style=display:flex><span>type Time struct { <span style=color:#ff7b72;font-weight:700>/*</span> omitted <span style=color:#ff7b72;font-weight:700>*/</span> }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> (t Time) Add(d Duration) Time { <span style=color:#ff7b72;font-weight:700>/*</span> omitted <span style=color:#ff7b72;font-weight:700>*/</span> }
</span></span></code></pre></td></tr></table></div></div></li><li><p>å¦‚æœ‰ç–‘é—®ï¼Œè¯·ä½¿ç”¨æŒ‡é’ˆæ¥æ”¶å™¨ã€‚</p></li></ul><p>ä½œä¸ºä¸€èˆ¬å‡†åˆ™ï¼Œæ›´å–œæ¬¢ä½¿ç±»å‹çš„æ–¹æ³•å…¨éƒ¨ä¸ºæŒ‡é’ˆæ–¹æ³•æˆ–å…¨éƒ¨ä¸ºå€¼æ–¹æ³•ã€‚</p><p>**æ³¨æ„ï¼š**å…³äºå°†å€¼æˆ–æŒ‡é’ˆä¼ é€’ç»™å‡½æ•°æ˜¯å¦ä¼šå½±å“æ€§èƒ½ï¼Œå­˜åœ¨å¾ˆå¤šé”™è¯¯ä¿¡æ¯ã€‚ç¼–è¯‘å™¨å¯ä»¥é€‰æ‹©å°†æŒ‡é’ˆä¼ é€’ç»™å †æ ˆä¸Šçš„å€¼ä»¥åŠå¤åˆ¶å †æ ˆä¸Šçš„å€¼ï¼Œä½†åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™äº›è€ƒè™‘ä¸åº”è¶…è¿‡ä»£ç çš„å¯è¯»æ€§å’Œæ­£ç¡®æ€§ã€‚å½“æ€§èƒ½ç¡®å®å¾ˆé‡è¦æ—¶ï¼Œé‡è¦çš„æ˜¯åœ¨å†³å®šä¸€ç§æ–¹æ³•ä¼˜äºå¦ä¸€ç§æ–¹æ³•ä¹‹å‰ï¼Œç”¨ä¸€ä¸ªç°å®çš„åŸºå‡†æ¥åˆ†æè¿™ä¸¤ç§æ–¹æ³•ã€‚</p><h3 id=switchå’Œbreak><code>switch</code>å’Œ<code>break</code><a hidden class=anchor aria-hidden=true href=#switchå’Œbreak>#</a></h3><p>â€‹ ä¸è¦åœ¨å­å¥<code>break</code>æœ«å°¾ä½¿ç”¨æ²¡æœ‰ç›®æ ‡æ ‡ç­¾çš„<code>switch</code> è¯­å¥ï¼›ä»–ä»¬æ˜¯å¤šä½™çš„ã€‚ä¸ C å’Œ Java ä¸åŒï¼Œ<code>switch</code>Go ä¸­çš„å­å¥ä¼šè‡ªåŠ¨ä¸­æ–­ï¼Œå¹¶ä¸”éœ€è¦ä¸€æ¡<code>fallthrough</code>è¯­å¥æ¥å®ç° C é£æ ¼çš„è¡Œä¸ºã€‚<code>break</code>å¦‚æœæ‚¨æƒ³é˜æ˜ç©ºå­å¥çš„ç›®çš„ï¼Œè¯·ä½¿ç”¨æ³¨é‡Šè€Œä¸æ˜¯ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Good:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>switch</span> x {
</span></span><span style=display:flex><span><span style=color:#ff7b72>case</span> <span style=color:#a5d6ff>&#34;A&#34;</span>, <span style=color:#a5d6ff>&#34;B&#34;</span>:
</span></span><span style=display:flex><span>    buf.<span style=color:#d2a8ff;font-weight:700>WriteString</span>(x)
</span></span><span style=display:flex><span><span style=color:#ff7b72>case</span> <span style=color:#a5d6ff>&#34;C&#34;</span>:
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// handled outside of the switch statement</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>default</span>:
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> fmt.<span style=color:#d2a8ff;font-weight:700>Errorf</span>(<span style=color:#a5d6ff>&#34;unknown value: %q&#34;</span>, x)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Bad:</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>switch</span> x {
</span></span><span style=display:flex><span><span style=color:#ff7b72>case</span> <span style=color:#a5d6ff>&#34;A&#34;</span>, <span style=color:#a5d6ff>&#34;B&#34;</span>:
</span></span><span style=display:flex><span>    buf.<span style=color:#d2a8ff;font-weight:700>WriteString</span>(x)
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>break</span> <span style=color:#8b949e;font-style:italic>// this break is redundant</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>case</span> <span style=color:#a5d6ff>&#34;C&#34;</span>:
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>break</span> <span style=color:#8b949e;font-style:italic>// this break is redundant</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>default</span>:
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> fmt.<span style=color:#d2a8ff;font-weight:700>Errorf</span>(<span style=color:#a5d6ff>&#34;unknown value: %q&#34;</span>, x)
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><blockquote><p>**æ³¨æ„ï¼š**å¦‚æœ<code>switch</code>å­å¥åœ¨<code>for</code>å¾ªç¯å†…ï¼Œåˆ™ä½¿ç”¨<code>break</code>within <code>switch</code>ä¸ä¼šé€€å‡ºå°é—­<code>for</code>å¾ªç¯ã€‚</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#ff7b72>for</span> {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>switch</span> x {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>case</span> <span style=color:#a5d6ff>&#34;A&#34;</span>:
</span></span><span style=display:flex><span>     <span style=color:#ff7b72>break</span> <span style=color:#8b949e;font-style:italic>// exits the switch, not the loop</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p><code>for</code>è¦é€€å‡ºå°é—­å¾ªç¯ï¼Œè¯·åœ¨è¯­å¥ä¸Šä½¿ç”¨æ ‡ç­¾ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span>loop:
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>for</span> {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>switch</span> x {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>case</span> <span style=color:#a5d6ff>&#34;A&#34;</span>:
</span></span><span style=display:flex><span>       <span style=color:#ff7b72>break</span> loop <span style=color:#8b949e;font-style:italic>// exits the loop</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span></code></pre></td></tr></table></div></div></blockquote></div><footer class=post-footer><ul class=post-tags><li><a href=https://luenci.com/en/tags/%E4%BB%A3%E7%A0%81%E9%A3%8E%E6%A0%BC/>ä»£ç é£æ ¼</a></li></ul><nav class=paginav><a class=prev href=https://luenci.com/en/posts/%E8%81%8A%E8%81%8A%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA-opentracing/><span class=title>Â« Prev</span><br><span>èŠèŠé“¾è·¯è¿½è¸ª OpenTracing</span>
</a><a class=next href=https://luenci.com/en/posts/gitops-%E5%8E%9F%E7%90%86/><span class=title>Next Â»</span><br><span>Giweights ä»‹ç»</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share GO ä»£ç é£æ ¼æŒ‡å— on x" href="https://x.com/intent/tweet/?text=GO%20%e4%bb%a3%e7%a0%81%e9%a3%8e%e6%a0%bc%e6%8c%87%e5%8d%97&amp;url=https%3a%2f%2fluenci.com%2fen%2fposts%2fgolang%25E4%25BB%25A3%25E7%25A0%2581%25E9%25A3%258E%25E6%25A0%25BC%25E6%258C%2587%25E5%258D%2597%2f&amp;hashtags=%e4%bb%a3%e7%a0%81%e9%a3%8e%e6%a0%bc"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share GO ä»£ç é£æ ¼æŒ‡å— on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fluenci.com%2fen%2fposts%2fgolang%25E4%25BB%25A3%25E7%25A0%2581%25E9%25A3%258E%25E6%25A0%25BC%25E6%258C%2587%25E5%258D%2597%2f&amp;title=GO%20%e4%bb%a3%e7%a0%81%e9%a3%8e%e6%a0%bc%e6%8c%87%e5%8d%97&amp;summary=GO%20%e4%bb%a3%e7%a0%81%e9%a3%8e%e6%a0%bc%e6%8c%87%e5%8d%97&amp;source=https%3a%2f%2fluenci.com%2fen%2fposts%2fgolang%25E4%25BB%25A3%25E7%25A0%2581%25E9%25A3%258E%25E6%25A0%25BC%25E6%258C%2587%25E5%258D%2597%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share GO ä»£ç é£æ ¼æŒ‡å— on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fluenci.com%2fen%2fposts%2fgolang%25E4%25BB%25A3%25E7%25A0%2581%25E9%25A3%258E%25E6%25A0%25BC%25E6%258C%2587%25E5%258D%2597%2f&title=GO%20%e4%bb%a3%e7%a0%81%e9%a3%8e%e6%a0%bc%e6%8c%87%e5%8d%97"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share GO ä»£ç é£æ ¼æŒ‡å— on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fluenci.com%2fen%2fposts%2fgolang%25E4%25BB%25A3%25E7%25A0%2581%25E9%25A3%258E%25E6%25A0%25BC%25E6%258C%2587%25E5%258D%2597%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share GO ä»£ç é£æ ¼æŒ‡å— on whatsapp" href="https://api.whatsapp.com/send?text=GO%20%e4%bb%a3%e7%a0%81%e9%a3%8e%e6%a0%bc%e6%8c%87%e5%8d%97%20-%20https%3a%2f%2fluenci.com%2fen%2fposts%2fgolang%25E4%25BB%25A3%25E7%25A0%2581%25E9%25A3%258E%25E6%25A0%25BC%25E6%258C%2587%25E5%258D%2597%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share GO ä»£ç é£æ ¼æŒ‡å— on telegram" href="https://telegram.me/share/url?text=GO%20%e4%bb%a3%e7%a0%81%e9%a3%8e%e6%a0%bc%e6%8c%87%e5%8d%97&amp;url=https%3a%2f%2fluenci.com%2fen%2fposts%2fgolang%25E4%25BB%25A3%25E7%25A0%2581%25E9%25A3%258E%25E6%25A0%25BC%25E6%258C%2587%25E5%258D%2597%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share GO ä»£ç é£æ ¼æŒ‡å— on ycombinator" href="https://news.ycombinator.com/submitlink?t=GO%20%e4%bb%a3%e7%a0%81%e9%a3%8e%e6%a0%bc%e6%8c%87%e5%8d%97&u=https%3a%2f%2fluenci.com%2fen%2fposts%2fgolang%25E4%25BB%25A3%25E7%25A0%2581%25E9%25A3%258E%25E6%25A0%25BC%25E6%258C%2587%25E5%258D%2597%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer><script src=https://giscus.app/client.js data-repo=Lucareful/Lucareful.github.io data-repo-id="MDEwOlJlcG9zaXRvcnkxOTMzMDM3NDA=" data-category=Q&A data-category-id=DIC_kwDOC4WUvM4ChdIQ data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=zh-CN data-loading=lazy crossorigin=anonymous async></script></article></main><footer class=footer><script src=https://sdk.jinrishici.com/v2/browser/jinrishici.js></script><script type=text/javascript>jinrishici.load(function(e){var t=document.querySelector(".poem_sentence"),n=document.querySelector(".poem_info");t.innerHTML=e.data.content,n.innerHTML="â€”â€” "+e.data.origin.author})</script><span><a id=running-time></a><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><span id=busuanzi_container><link rel=stylesheet href=//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css>ğŸ‘ï¸â€ğŸ—¨ï¸è®¿å®¢äººæ•°: <span id=busuanzi_value_site_uv></span>|
ğŸŒè®¿é—®é‡: <span id=busuanzi_value_site_pv></span></span></span><br><span>&copy; 2026 <a href=https://luenci.com/en/>Luenci</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a> ğŸ“–
<text class=poem_sentence></text><text class=poem_info></text></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})});const RunningTimerInterval=1e3,StartTime=new Date("10/11/2018 00:00:00");function prefixZero(e){return e<10&&(e="0"+e),e}function updateTime(){const r=new Date;let e=r.getTime()-StartTime.getTime();const t=24*60*60*1e3,n=Math.floor(e/t);e-=n*t;const s=60*60*1e3,o=Math.floor(e/s);e-=o*s;const i=60*1e3,a=Math.floor(e/i);e-=a*i;const c=Math.floor(e/1e3),l=document.getElementById("running-time");l.innerText="ğŸ•š: "+n+"å¤©"+prefixZero(o)+"å°æ—¶"+prefixZero(a)+"åˆ†"+prefixZero(c)+"ç§’"}document.addEventListener("DOMContentLoaded",()=>{let e=setInterval(updateTime,RunningTimerInterval)})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>